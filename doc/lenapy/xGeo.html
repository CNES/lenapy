<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>lenapy.xGeo API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../lenapy.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;lenapy</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#open_geodata">open_geodata</a>
            </li>
            <li>
                    <a class="function" href="#open_mfgeodata">open_mfgeodata</a>
            </li>
            <li>
                    <a class="function" href="#open_mask">open_mask</a>
            </li>
            <li>
                    <a class="class" href="#GeoSet">GeoSet</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GeoSet.__init__">GeoSet</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.climato">climato</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.sum">sum</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.isosurface">isosurface</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.regridder">regridder</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.regrid">regrid</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.filter">filter</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.interp_time">interp_time</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.to_datetime">to_datetime</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.fill_time">fill_time</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoSet.surface_cell">surface_cell</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#GeoArray">GeoArray</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GeoArray.__init__">GeoArray</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.climato">climato</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.mean">mean</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.sum">sum</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.isosurface">isosurface</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.regridder">regridder</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.regrid">regrid</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.filter">filter</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.interp_time">interp_time</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.plot_timeseries_uncertainty">plot_timeseries_uncertainty</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.to_datetime">to_datetime</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.diff_3pts">diff_3pts</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.to_difgri">to_difgri</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.trend">trend</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.fill_time">fill_time</a>
                        </li>
                        <li>
                                <a class="function" href="#GeoArray.surface_cell">surface_cell</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../lenapy.html">lenapy</a><wbr>.xGeo    </h1>

                
                        <input id="mod-xGeo-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-xGeo-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">xesmf</span> <span class="k">as</span> <span class="nn">xe</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">import</span> <span class="nn">os.path</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">.plotting</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">.sandbox</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">.produits</span> <span class="kn">import</span> <span class="n">rename_data</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="k">def</span> <span class="nf">open_geodata</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">rename</span><span class="o">=</span><span class="p">{},</span><span class="n">nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">    Open a dataset base on xr.open_dataset method, while normalizing coordinates names and choosing NaN values</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    </span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    Parameters</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    ----------</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">    file : path</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">        pathname of the file to open</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">    *args : optional</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">        any arguments passed to open_dataset method</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    rename : dict, optional</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">        dictionnary {old_name:new_name,...}</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    nan : optional</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">        value to be replaced by NaN</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    chunks : dict, optional</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">        dictionnaty to perform chunks on data</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    time_type : str, optional</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">        type used for time coordinate, used to convert to datetime64</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        possible values : &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    **kwargs : optional</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        any keyword arguments passed to open_dataset method</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    Returns</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    -------</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    data : Dataset</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        Dataset loaded from file</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">    </span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">    Example</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    -------</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="n">res</span><span class="o">=</span><span class="n">rename_data</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span><span class="o">**</span><span class="n">rename</span><span class="p">)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">if</span> <span class="n">time_type</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">input_type</span><span class="o">=</span><span class="n">time_type</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="k">def</span> <span class="nf">open_mfgeodata</span><span class="p">(</span><span class="n">fic</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">rename</span><span class="o">=</span><span class="p">{},</span><span class="n">nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    Open a dataset base on xr.open_mfdataset method, while normalizing coordinates names and choosing NaN values</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    </span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    Parameters</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    ----------</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">    file : path</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        pattern fitting the file to open</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">    *args : optional</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">        any arguments passed to open_dataset method</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">    rename : dict, optional</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        dictionnary {old_name:new_name,...}</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    nan : optional</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        value to be replaced by NaN</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">    chunks : dict, optional</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        dictionnaty to perform chunks on data</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">    time_type : str, optional</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        type used for time coordinate, used to convert to datetime64</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        possible values : &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">    **kwargs : optional</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        any keyword arguments passed to open_dataset method</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        </span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">    Returns</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">    -------</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    data : Dataset</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        Dataset loaded from file</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">    </span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    Example</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">    -------</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">    data = xgeo.open_mfgeodata(&#39;/home/user/lenapy/data/gohc_*.nc&#39;)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="n">res</span><span class="o">=</span><span class="n">rename_data</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">fic</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span><span class="o">**</span><span class="n">rename</span><span class="p">)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="k">if</span> <span class="n">time_type</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">input_type</span><span class="o">=</span><span class="n">time_type</span><span class="p">)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="k">def</span> <span class="nf">open_mask</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">    Open a mask in a dataset file, choose a given field, and regrid according to a given geometry. </span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">    The returned mask contains an extra dimension named &#39;zone&#39;, corresponding to the different values</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">    of the mask contained in the opened dataset.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">    Required format for the dataset to be opened :</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">     - contains several dataarrays, each one being a mask (identified as &#39;field&#39;)</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">     - each mask is defined by values, whose signification is given in the attributes of the dataarray : {&#39;value1&#39; : &#39;label1&#39;,...}</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">    </span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    Parameters</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    ----------</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    file : path</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        path and filename of the mask file to be opened</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">    field : string</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        name of the data to be used as a mask in the dataset</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">    grid : dataset, optional</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        dataset to be regridded on. If None, no regridding is performed</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        </span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">    Returns</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">    -------</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">    mask : DataArray</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        DataArray with regridded mask</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">    </span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">    Example</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">    -------</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">    &gt;&gt;&gt; mask = xgeo.open_mask(&#39;/home/user/lenapy/data/mask/GEO_mask_1deg_20210406.nc&#39;,&#39;mask_continents&#39;)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">    &gt;&gt;&gt; mask.zone</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">    &lt;xarray.DataArray (latitude: 360, longitude: 720, zone: 9)&gt;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        array([[[False,  True, False, ..., False, False, False],</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="sd">        ...</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">                [False, False, False, ..., False, False, False]]])</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">          * longitude  (longitude) float64 -179.8 -179.2 -178.8 ... 178.8 179.2 179.8</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">          * latitude   (latitude) float64 -89.75 -89.25 -88.75 ... 88.75 89.25 89.75</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">          * zone       (zone) &lt;U18 &#39;Greenland&#39; &#39;Antarctica&#39; ... &#39;Maritime continent&#39;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">    &quot;&quot;&quot;</span>    
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>    <span class="n">mask</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="n">field</span><span class="p">]</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="n">labels</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span><span class="n">dims</span><span class="o">=</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zone</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="n">reg</span><span class="o">=</span><span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest_s2d&#39;</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">==</span><span class="n">labels</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataset_accessor</span><span class="p">(</span><span class="s2">&quot;xgeo&quot;</span><span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="k">class</span> <span class="nc">GeoSet</span><span class="p">:</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    This class implements an extension of any dataset to add some usefull methods often used in earth science data handling</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        Perform climato analysis on all the variables in a dataset</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">            annual cycle</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">            trend</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">            mean</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            residual signal</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        </span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        Parameters</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        ----------</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">            returns residual signal</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">            returns mean signal</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">            returns trend</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">            </span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        Returns</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        -------</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        climato : dataset</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">            a dataset with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        </span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        Example</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        -------</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="c1"># Pour toutes les donnes dpendant du temps, retourne l&#39;analyse de la climato</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        Returns the averaged value of all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        </span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="sd">        Parameters</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        ----------</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        *args : list</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        </span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">            if dataarray :</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">            mask to be applyed befire averaging</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">            </span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">        Returns</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        -------</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">        averaged : dataset</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="sd">            dataset with all variables averaged according to specified options</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">            </span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        Example</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        -------</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">            </span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        Returns the sum for all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        </span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        Parameters</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        ----------</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">        *args : list</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        </span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">            if dataarray :</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">            </span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        Returns</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        -------</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        averaged : dataset</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">            dataset with all variablessummed according to specified options</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">            </span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        Example</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        -------</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">            </span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>             
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the kwarg field=value.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="sd">        For example, we want to compute the isosurface defined by a temperature of 10C along depth dimension.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        All data variables of the data set are interpolated on this iso surface</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        </span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        Parameters</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        ----------</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        criterion : dict</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            one-entry dictionnary with the key equal to a variable of the dataset, and the value equal to the isosurface criterion</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        dim : string</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">            </span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        Returns</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        -------</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        isosurface : dataset</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">            Dataset with all the variables interpolated at the criterion value along chosen dimension. The variables chosen for</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">                criterion should contain a constant value equal to the criterion. the dimension chosen for the isosurface computation</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">                is filled with the isosurface itself.</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">                </span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        Example</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        -------</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(&#39;depth&#39;,dict(temp=3))</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        &lt;xarray.Dataset&gt;</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        Dimensions:    (latitude: 90, longitude: 180)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">            depth      (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        Data variables:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">            depth_iso  (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">            temp       (latitude, longitude) float64 3.0 3.0 3.0 3.0 ... 3.0 3.0 3.0 3.0</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">            SA         (latitude, longitude) float64 34.48 34.39 34.39 ... 34.53 34.52</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        </span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="c1"># Calcule l&#39;isosurface selon la coordonne &#39;dim&#39; pour le champ dfini par le dictionnaire **kwargs (ex : temp=10)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="c1"># Retourne tous les champs interpols sur cette isosurface (pour ceux ayant &quot;dim&quot; en coordonne), ainsi que l&#39;isosurface elle-mme</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="n">coord</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">dim</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">k</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">list</span><span class="p">(</span><span class="n">data_vars</span><span class="p">)))</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="n">r</span><span class="o">=</span><span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">criterion</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="n">coord</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataset </span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        Parameters</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">        ----------</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        *args : </span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a><span class="sd">        method : str</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="sd">        *kwargs : </span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        Returns</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">        -------</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The latitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The longitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>        <span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mask_in</span><span class="p">)</span><span class="o">==</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mask_in</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>        <span class="n">ds_out</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">longitude</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="p">})</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="k">return</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">ds_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>    
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">        Parameters</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">        ----------</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a><span class="sd">        *args : </span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="sd">        *kwargs : </span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        Returns</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        -------</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">        regrid : dataset</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        Example</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        -------</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>    
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        Apply a specified filter on all the time-dependent data in the dataset</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        </span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        Parameters</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">        ----------</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">        q : int</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        **kwargs :</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">            </span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        Returns</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        -------</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        </span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        Example</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        -------</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">        </span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">        Parameter</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">        ---------</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">        other : dataarray</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">            must have a time dimension</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">            </span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">        Return</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        ------</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">interp_time</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        Convert dataset time format to standard pandas time format</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        </span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        Parameter</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        ---------</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        input_type : string</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">            </span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        Return</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        ------</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        converted : dataset</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">            new dataset with the time dimension in a standard pandas format</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        Returns</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        -------</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        surface : dataarray</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">        Example</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        -------</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>    
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataarray_accessor</span><span class="p">(</span><span class="s2">&quot;xgeo&quot;</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="k">class</span> <span class="nc">GeoArray</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>        
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        Perform climato analysis on a dataarray</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">            annual cycle</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">            trend</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            mean</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">            residual signal</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        </span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        Parameters</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        ----------</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">            returns residual signal</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">            returns mean signal</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            returns trend</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">            </span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">        Returns</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        -------</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="sd">        climato : dataarray</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">            a dataarray with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        </span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">        Example</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a><span class="sd">        -------</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;).ohc</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        Returns the averaged value of dataarray along specified dimension, applying specified weights</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        Parameters</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        ----------</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        *args : list</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">        </span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">            if dataarray :</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">            mask to be applyed before averaging</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">            </span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">        Returns</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">        -------</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">            dataarray averaged according to specified options</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">            </span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">        Example</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">        -------</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">            </span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="n">argmean</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="k">if</span> <span class="n">na_eq_zero</span><span class="p">:</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>            
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argmean</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>            <span class="n">argmean</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>            <span class="c1"># Moyenne simple</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>    
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a><span class="sd">        Returns the sum of dataarray along specified dimension, applying specified weights</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a><span class="sd">        </span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a><span class="sd">        Parameters</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a><span class="sd">        ----------</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        *args : list</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="sd">        </span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">            if dataarray :</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">            </span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">        Returns</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        -------</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">            dataarray summed according to specified options</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">            </span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        Example</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">        -------</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).heat</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="sd">            </span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        &quot;&quot;&quot;</span>       
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>        <span class="n">argsum</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>        
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>            <span class="c1"># Somme simple</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>    
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>   
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the target.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">        </span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">        Parameters</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">        ----------</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">        target : float</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">            criterion value to be satisfied at the iso surface</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">        dim : string</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a><span class="sd">            </span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a><span class="sd">        Returns</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a><span class="sd">        -------</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a><span class="sd">        isosurface : dataarray</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a><span class="sd">            Dataarray containing the isosurface along the dimension dim on which data=target.</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a><span class="sd">                </span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a><span class="sd">        Example</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a><span class="sd">        -------</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(3,&#39;depth&#39;)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a><span class="sd">        &lt;xarray.DataArray (latitude: 90, longitude: 180)&gt;</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a><span class="sd">        dask.array&lt;_nanmax_skip-aggregate, shape=(90, 180), dtype=float64, chunksize=(90, 180), chunktype=numpy.ndarray&gt;</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a><span class="sd">        Coordinates:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>        <span class="k">return</span> <span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataarray </span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a><span class="sd">        Parameters</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a><span class="sd">        ----------</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="sd">        *args : </span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a><span class="sd">        method : str</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a><span class="sd">        *kwargs : </span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a><span class="sd">        Returns</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a><span class="sd">        -------</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="n">ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">})</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>        <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">regridder</span><span class="p">(</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="n">mask_in</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>    
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a><span class="sd">        Parameters</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a><span class="sd">        ----------</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a><span class="sd">        *args : </span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a><span class="sd">        *kwargs : </span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a><span class="sd">        Returns</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a><span class="sd">        -------</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a><span class="sd">        regrid : dataset</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a><span class="sd">        Example</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a><span class="sd">        -------</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a><span class="sd">        Apply a specified filter on all the time-dependent datarray</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a><span class="sd">        </span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a><span class="sd">        Parameters</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a><span class="sd">        ----------</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a><span class="sd">        q : int</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a><span class="sd">        **kwargs :</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a><span class="sd">            </span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a><span class="sd">        Returns</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a><span class="sd">        -------</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a><span class="sd">        </span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a><span class="sd">        Example</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a><span class="sd">        -------</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a><span class="sd">        </span>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>    
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a><span class="sd">        </span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a><span class="sd">        Parameter</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a><span class="sd">        ---------</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a><span class="sd">        other : dataarray</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a><span class="sd">            must have a time dimension</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a><span class="sd">            </span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a><span class="sd">        Return</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a><span class="sd">        ------</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="n">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>    
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>    <span class="k">def</span> <span class="nf">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a>        <span class="n">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>        
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a><span class="sd">        Convert dataarray time format to standard pandas time format</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a><span class="sd">        </span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a><span class="sd">        Parameter</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a><span class="sd">        ---------</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a><span class="sd">        input_type : string</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos">778</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos">779</span></a><span class="sd">            </span>
</span><span id="L-780"><a href="#L-780"><span class="linenos">780</span></a><span class="sd">        Return</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos">781</span></a><span class="sd">        ------</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos">782</span></a><span class="sd">        converted : dataarray</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos">783</span></a><span class="sd">            new dataarray with the time dimension in a standard pandas format</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos">784</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos">785</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span><span id="L-786"><a href="#L-786"><span class="linenos">786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos">787</span></a>    <span class="k">def</span> <span class="nf">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos">788</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos">789</span></a><span class="sd">        Derivative formula along the selected dimension, returning on each point the linear regression on the three points</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos">790</span></a><span class="sd">        defined by the selected point and its two neighbours</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos">791</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos">792</span></a>        <span class="k">return</span> <span class="n">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dim</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos">793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos">794</span></a>    <span class="k">def</span> <span class="nf">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">):</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos">795</span></a>        <span class="n">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">)</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos">796</span></a>
</span><span id="L-797"><a href="#L-797"><span class="linenos">797</span></a>    <span class="k">def</span> <span class="nf">trend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos">798</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos">799</span></a><span class="sd">        Perform a linear regression on the data, and returns the slope coefficient</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos">800</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos">801</span></a>        <span class="k">return</span> <span class="n">trend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos">802</span></a>    
</span><span id="L-803"><a href="#L-803"><span class="linenos">803</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos">804</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos">805</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos">806</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos">807</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos">808</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos">809</span></a>    
</span><span id="L-810"><a href="#L-810"><span class="linenos">810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos">811</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos">812</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos">813</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos">814</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos">815</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos">816</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos">817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos">818</span></a><span class="sd">        Returns</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos">819</span></a><span class="sd">        -------</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos">820</span></a><span class="sd">        surface : dataarray</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos">821</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos">822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos">823</span></a><span class="sd">        Example</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos">824</span></a><span class="sd">        -------</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos">825</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos">826</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos">827</span></a>
</span><span id="L-828"><a href="#L-828"><span class="linenos">828</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos">829</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="open_geodata">
                            <input id="open_geodata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_geodata</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="n">rename</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="n">nan</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">chunks</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">time_type</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="open_geodata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open_geodata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open_geodata-13"><a href="#open_geodata-13"><span class="linenos">13</span></a><span class="k">def</span> <span class="nf">open_geodata</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">rename</span><span class="o">=</span><span class="p">{},</span><span class="n">nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="open_geodata-14"><a href="#open_geodata-14"><span class="linenos">14</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="open_geodata-15"><a href="#open_geodata-15"><span class="linenos">15</span></a><span class="sd">    Open a dataset base on xr.open_dataset method, while normalizing coordinates names and choosing NaN values</span>
</span><span id="open_geodata-16"><a href="#open_geodata-16"><span class="linenos">16</span></a><span class="sd">    </span>
</span><span id="open_geodata-17"><a href="#open_geodata-17"><span class="linenos">17</span></a><span class="sd">    Parameters</span>
</span><span id="open_geodata-18"><a href="#open_geodata-18"><span class="linenos">18</span></a><span class="sd">    ----------</span>
</span><span id="open_geodata-19"><a href="#open_geodata-19"><span class="linenos">19</span></a><span class="sd">    file : path</span>
</span><span id="open_geodata-20"><a href="#open_geodata-20"><span class="linenos">20</span></a><span class="sd">        pathname of the file to open</span>
</span><span id="open_geodata-21"><a href="#open_geodata-21"><span class="linenos">21</span></a><span class="sd">    *args : optional</span>
</span><span id="open_geodata-22"><a href="#open_geodata-22"><span class="linenos">22</span></a><span class="sd">        any arguments passed to open_dataset method</span>
</span><span id="open_geodata-23"><a href="#open_geodata-23"><span class="linenos">23</span></a><span class="sd">    rename : dict, optional</span>
</span><span id="open_geodata-24"><a href="#open_geodata-24"><span class="linenos">24</span></a><span class="sd">        dictionnary {old_name:new_name,...}</span>
</span><span id="open_geodata-25"><a href="#open_geodata-25"><span class="linenos">25</span></a><span class="sd">    nan : optional</span>
</span><span id="open_geodata-26"><a href="#open_geodata-26"><span class="linenos">26</span></a><span class="sd">        value to be replaced by NaN</span>
</span><span id="open_geodata-27"><a href="#open_geodata-27"><span class="linenos">27</span></a><span class="sd">    chunks : dict, optional</span>
</span><span id="open_geodata-28"><a href="#open_geodata-28"><span class="linenos">28</span></a><span class="sd">        dictionnaty to perform chunks on data</span>
</span><span id="open_geodata-29"><a href="#open_geodata-29"><span class="linenos">29</span></a><span class="sd">    time_type : str, optional</span>
</span><span id="open_geodata-30"><a href="#open_geodata-30"><span class="linenos">30</span></a><span class="sd">        type used for time coordinate, used to convert to datetime64</span>
</span><span id="open_geodata-31"><a href="#open_geodata-31"><span class="linenos">31</span></a><span class="sd">        possible values : &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="open_geodata-32"><a href="#open_geodata-32"><span class="linenos">32</span></a><span class="sd">    **kwargs : optional</span>
</span><span id="open_geodata-33"><a href="#open_geodata-33"><span class="linenos">33</span></a><span class="sd">        any keyword arguments passed to open_dataset method</span>
</span><span id="open_geodata-34"><a href="#open_geodata-34"><span class="linenos">34</span></a><span class="sd">        </span>
</span><span id="open_geodata-35"><a href="#open_geodata-35"><span class="linenos">35</span></a><span class="sd">    Returns</span>
</span><span id="open_geodata-36"><a href="#open_geodata-36"><span class="linenos">36</span></a><span class="sd">    -------</span>
</span><span id="open_geodata-37"><a href="#open_geodata-37"><span class="linenos">37</span></a><span class="sd">    data : Dataset</span>
</span><span id="open_geodata-38"><a href="#open_geodata-38"><span class="linenos">38</span></a><span class="sd">        Dataset loaded from file</span>
</span><span id="open_geodata-39"><a href="#open_geodata-39"><span class="linenos">39</span></a><span class="sd">    </span>
</span><span id="open_geodata-40"><a href="#open_geodata-40"><span class="linenos">40</span></a><span class="sd">    Example</span>
</span><span id="open_geodata-41"><a href="#open_geodata-41"><span class="linenos">41</span></a><span class="sd">    -------</span>
</span><span id="open_geodata-42"><a href="#open_geodata-42"><span class="linenos">42</span></a><span class="sd">    data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="open_geodata-43"><a href="#open_geodata-43"><span class="linenos">43</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="open_geodata-44"><a href="#open_geodata-44"><span class="linenos">44</span></a>    <span class="n">res</span><span class="o">=</span><span class="n">rename_data</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span><span class="o">**</span><span class="n">rename</span><span class="p">)</span>
</span><span id="open_geodata-45"><a href="#open_geodata-45"><span class="linenos">45</span></a>    <span class="k">if</span> <span class="n">time_type</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="open_geodata-46"><a href="#open_geodata-46"><span class="linenos">46</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">input_type</span><span class="o">=</span><span class="n">time_type</span><span class="p">)</span>
</span><span id="open_geodata-47"><a href="#open_geodata-47"><span class="linenos">47</span></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Open a dataset base on xr.open_dataset method, while normalizing coordinates names and choosing NaN values</p>

<h2 id="parameters">Parameters</h2>

<p>file : path
    pathname of the file to open
<em>args : optional
    any arguments passed to open_dataset method
rename : dict, optional
    dictionnary {old_name:new_name,...}
nan : optional
    value to be replaced by NaN
chunks : dict, optional
    dictionnaty to perform chunks on data
time_type : str, optional
    type used for time coordinate, used to convert to datetime64
    possible values : 'frac_year' or '360_day'
*</em>kwargs : optional
    any keyword arguments passed to open_dataset method</p>

<h2 id="returns">Returns</h2>

<p>data : Dataset
    Dataset loaded from file</p>

<h2 id="example">Example</h2>

<p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc')</p>
</div>


                </section>
                <section id="open_mfgeodata">
                            <input id="open_mfgeodata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_mfgeodata</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">fic</span>,</span><span class="param">	<span class="o">*</span><span class="n">args</span>,</span><span class="param">	<span class="n">rename</span><span class="o">=</span><span class="p">{}</span>,</span><span class="param">	<span class="n">nan</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">chunks</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">time_type</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="open_mfgeodata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open_mfgeodata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open_mfgeodata-49"><a href="#open_mfgeodata-49"><span class="linenos">49</span></a><span class="k">def</span> <span class="nf">open_mfgeodata</span><span class="p">(</span><span class="n">fic</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">rename</span><span class="o">=</span><span class="p">{},</span><span class="n">nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">time_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="open_mfgeodata-50"><a href="#open_mfgeodata-50"><span class="linenos">50</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="open_mfgeodata-51"><a href="#open_mfgeodata-51"><span class="linenos">51</span></a><span class="sd">    Open a dataset base on xr.open_mfdataset method, while normalizing coordinates names and choosing NaN values</span>
</span><span id="open_mfgeodata-52"><a href="#open_mfgeodata-52"><span class="linenos">52</span></a><span class="sd">    </span>
</span><span id="open_mfgeodata-53"><a href="#open_mfgeodata-53"><span class="linenos">53</span></a><span class="sd">    Parameters</span>
</span><span id="open_mfgeodata-54"><a href="#open_mfgeodata-54"><span class="linenos">54</span></a><span class="sd">    ----------</span>
</span><span id="open_mfgeodata-55"><a href="#open_mfgeodata-55"><span class="linenos">55</span></a><span class="sd">    file : path</span>
</span><span id="open_mfgeodata-56"><a href="#open_mfgeodata-56"><span class="linenos">56</span></a><span class="sd">        pattern fitting the file to open</span>
</span><span id="open_mfgeodata-57"><a href="#open_mfgeodata-57"><span class="linenos">57</span></a><span class="sd">    *args : optional</span>
</span><span id="open_mfgeodata-58"><a href="#open_mfgeodata-58"><span class="linenos">58</span></a><span class="sd">        any arguments passed to open_dataset method</span>
</span><span id="open_mfgeodata-59"><a href="#open_mfgeodata-59"><span class="linenos">59</span></a><span class="sd">    rename : dict, optional</span>
</span><span id="open_mfgeodata-60"><a href="#open_mfgeodata-60"><span class="linenos">60</span></a><span class="sd">        dictionnary {old_name:new_name,...}</span>
</span><span id="open_mfgeodata-61"><a href="#open_mfgeodata-61"><span class="linenos">61</span></a><span class="sd">    nan : optional</span>
</span><span id="open_mfgeodata-62"><a href="#open_mfgeodata-62"><span class="linenos">62</span></a><span class="sd">        value to be replaced by NaN</span>
</span><span id="open_mfgeodata-63"><a href="#open_mfgeodata-63"><span class="linenos">63</span></a><span class="sd">    chunks : dict, optional</span>
</span><span id="open_mfgeodata-64"><a href="#open_mfgeodata-64"><span class="linenos">64</span></a><span class="sd">        dictionnaty to perform chunks on data</span>
</span><span id="open_mfgeodata-65"><a href="#open_mfgeodata-65"><span class="linenos">65</span></a><span class="sd">    time_type : str, optional</span>
</span><span id="open_mfgeodata-66"><a href="#open_mfgeodata-66"><span class="linenos">66</span></a><span class="sd">        type used for time coordinate, used to convert to datetime64</span>
</span><span id="open_mfgeodata-67"><a href="#open_mfgeodata-67"><span class="linenos">67</span></a><span class="sd">        possible values : &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="open_mfgeodata-68"><a href="#open_mfgeodata-68"><span class="linenos">68</span></a><span class="sd">    **kwargs : optional</span>
</span><span id="open_mfgeodata-69"><a href="#open_mfgeodata-69"><span class="linenos">69</span></a><span class="sd">        any keyword arguments passed to open_dataset method</span>
</span><span id="open_mfgeodata-70"><a href="#open_mfgeodata-70"><span class="linenos">70</span></a><span class="sd">        </span>
</span><span id="open_mfgeodata-71"><a href="#open_mfgeodata-71"><span class="linenos">71</span></a><span class="sd">    Returns</span>
</span><span id="open_mfgeodata-72"><a href="#open_mfgeodata-72"><span class="linenos">72</span></a><span class="sd">    -------</span>
</span><span id="open_mfgeodata-73"><a href="#open_mfgeodata-73"><span class="linenos">73</span></a><span class="sd">    data : Dataset</span>
</span><span id="open_mfgeodata-74"><a href="#open_mfgeodata-74"><span class="linenos">74</span></a><span class="sd">        Dataset loaded from file</span>
</span><span id="open_mfgeodata-75"><a href="#open_mfgeodata-75"><span class="linenos">75</span></a><span class="sd">    </span>
</span><span id="open_mfgeodata-76"><a href="#open_mfgeodata-76"><span class="linenos">76</span></a><span class="sd">    Example</span>
</span><span id="open_mfgeodata-77"><a href="#open_mfgeodata-77"><span class="linenos">77</span></a><span class="sd">    -------</span>
</span><span id="open_mfgeodata-78"><a href="#open_mfgeodata-78"><span class="linenos">78</span></a><span class="sd">    data = xgeo.open_mfgeodata(&#39;/home/user/lenapy/data/gohc_*.nc&#39;)</span>
</span><span id="open_mfgeodata-79"><a href="#open_mfgeodata-79"><span class="linenos">79</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="open_mfgeodata-80"><a href="#open_mfgeodata-80"><span class="linenos">80</span></a>    <span class="n">res</span><span class="o">=</span><span class="n">rename_data</span><span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">fic</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span><span class="o">**</span><span class="n">rename</span><span class="p">)</span>
</span><span id="open_mfgeodata-81"><a href="#open_mfgeodata-81"><span class="linenos">81</span></a>    <span class="k">if</span> <span class="n">time_type</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="open_mfgeodata-82"><a href="#open_mfgeodata-82"><span class="linenos">82</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">res</span><span class="p">,</span><span class="n">input_type</span><span class="o">=</span><span class="n">time_type</span><span class="p">)</span>
</span><span id="open_mfgeodata-83"><a href="#open_mfgeodata-83"><span class="linenos">83</span></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">res</span><span class="o">!=</span><span class="n">nan</span><span class="p">)</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Open a dataset base on xr.open_mfdataset method, while normalizing coordinates names and choosing NaN values</p>

<h2 id="parameters">Parameters</h2>

<p>file : path
    pattern fitting the file to open
<em>args : optional
    any arguments passed to open_dataset method
rename : dict, optional
    dictionnary {old_name:new_name,...}
nan : optional
    value to be replaced by NaN
chunks : dict, optional
    dictionnaty to perform chunks on data
time_type : str, optional
    type used for time coordinate, used to convert to datetime64
    possible values : 'frac_year' or '360_day'
*</em>kwargs : optional
    any keyword arguments passed to open_dataset method</p>

<h2 id="returns">Returns</h2>

<p>data : Dataset
    Dataset loaded from file</p>

<h2 id="example">Example</h2>

<p>data = xgeo.open_mfgeodata('/home/user/lenapy/data/gohc_*.nc')</p>
</div>


                </section>
                <section id="open_mask">
                            <input id="open_mask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_mask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file</span>, </span><span class="param"><span class="n">field</span>, </span><span class="param"><span class="n">grid</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="open_mask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#open_mask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="open_mask-85"><a href="#open_mask-85"><span class="linenos"> 85</span></a><span class="k">def</span> <span class="nf">open_mask</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">field</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="open_mask-86"><a href="#open_mask-86"><span class="linenos"> 86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="open_mask-87"><a href="#open_mask-87"><span class="linenos"> 87</span></a><span class="sd">    Open a mask in a dataset file, choose a given field, and regrid according to a given geometry. </span>
</span><span id="open_mask-88"><a href="#open_mask-88"><span class="linenos"> 88</span></a><span class="sd">    The returned mask contains an extra dimension named &#39;zone&#39;, corresponding to the different values</span>
</span><span id="open_mask-89"><a href="#open_mask-89"><span class="linenos"> 89</span></a><span class="sd">    of the mask contained in the opened dataset.</span>
</span><span id="open_mask-90"><a href="#open_mask-90"><span class="linenos"> 90</span></a><span class="sd">    Required format for the dataset to be opened :</span>
</span><span id="open_mask-91"><a href="#open_mask-91"><span class="linenos"> 91</span></a><span class="sd">     - contains several dataarrays, each one being a mask (identified as &#39;field&#39;)</span>
</span><span id="open_mask-92"><a href="#open_mask-92"><span class="linenos"> 92</span></a><span class="sd">     - each mask is defined by values, whose signification is given in the attributes of the dataarray : {&#39;value1&#39; : &#39;label1&#39;,...}</span>
</span><span id="open_mask-93"><a href="#open_mask-93"><span class="linenos"> 93</span></a><span class="sd">    </span>
</span><span id="open_mask-94"><a href="#open_mask-94"><span class="linenos"> 94</span></a><span class="sd">    Parameters</span>
</span><span id="open_mask-95"><a href="#open_mask-95"><span class="linenos"> 95</span></a><span class="sd">    ----------</span>
</span><span id="open_mask-96"><a href="#open_mask-96"><span class="linenos"> 96</span></a><span class="sd">    file : path</span>
</span><span id="open_mask-97"><a href="#open_mask-97"><span class="linenos"> 97</span></a><span class="sd">        path and filename of the mask file to be opened</span>
</span><span id="open_mask-98"><a href="#open_mask-98"><span class="linenos"> 98</span></a><span class="sd">    field : string</span>
</span><span id="open_mask-99"><a href="#open_mask-99"><span class="linenos"> 99</span></a><span class="sd">        name of the data to be used as a mask in the dataset</span>
</span><span id="open_mask-100"><a href="#open_mask-100"><span class="linenos">100</span></a><span class="sd">    grid : dataset, optional</span>
</span><span id="open_mask-101"><a href="#open_mask-101"><span class="linenos">101</span></a><span class="sd">        dataset to be regridded on. If None, no regridding is performed</span>
</span><span id="open_mask-102"><a href="#open_mask-102"><span class="linenos">102</span></a><span class="sd">        </span>
</span><span id="open_mask-103"><a href="#open_mask-103"><span class="linenos">103</span></a><span class="sd">    Returns</span>
</span><span id="open_mask-104"><a href="#open_mask-104"><span class="linenos">104</span></a><span class="sd">    -------</span>
</span><span id="open_mask-105"><a href="#open_mask-105"><span class="linenos">105</span></a><span class="sd">    mask : DataArray</span>
</span><span id="open_mask-106"><a href="#open_mask-106"><span class="linenos">106</span></a><span class="sd">        DataArray with regridded mask</span>
</span><span id="open_mask-107"><a href="#open_mask-107"><span class="linenos">107</span></a><span class="sd">    </span>
</span><span id="open_mask-108"><a href="#open_mask-108"><span class="linenos">108</span></a><span class="sd">    Example</span>
</span><span id="open_mask-109"><a href="#open_mask-109"><span class="linenos">109</span></a><span class="sd">    -------</span>
</span><span id="open_mask-110"><a href="#open_mask-110"><span class="linenos">110</span></a><span class="sd">    &gt;&gt;&gt; mask = xgeo.open_mask(&#39;/home/user/lenapy/data/mask/GEO_mask_1deg_20210406.nc&#39;,&#39;mask_continents&#39;)</span>
</span><span id="open_mask-111"><a href="#open_mask-111"><span class="linenos">111</span></a><span class="sd">    &gt;&gt;&gt; mask.zone</span>
</span><span id="open_mask-112"><a href="#open_mask-112"><span class="linenos">112</span></a><span class="sd">    &lt;xarray.DataArray (latitude: 360, longitude: 720, zone: 9)&gt;</span>
</span><span id="open_mask-113"><a href="#open_mask-113"><span class="linenos">113</span></a><span class="sd">        array([[[False,  True, False, ..., False, False, False],</span>
</span><span id="open_mask-114"><a href="#open_mask-114"><span class="linenos">114</span></a><span class="sd">        ...</span>
</span><span id="open_mask-115"><a href="#open_mask-115"><span class="linenos">115</span></a><span class="sd">                [False, False, False, ..., False, False, False]]])</span>
</span><span id="open_mask-116"><a href="#open_mask-116"><span class="linenos">116</span></a><span class="sd">        Coordinates:</span>
</span><span id="open_mask-117"><a href="#open_mask-117"><span class="linenos">117</span></a><span class="sd">          * longitude  (longitude) float64 -179.8 -179.2 -178.8 ... 178.8 179.2 179.8</span>
</span><span id="open_mask-118"><a href="#open_mask-118"><span class="linenos">118</span></a><span class="sd">          * latitude   (latitude) float64 -89.75 -89.25 -88.75 ... 88.75 89.25 89.75</span>
</span><span id="open_mask-119"><a href="#open_mask-119"><span class="linenos">119</span></a><span class="sd">          * zone       (zone) &lt;U18 &#39;Greenland&#39; &#39;Antarctica&#39; ... &#39;Maritime continent&#39;</span>
</span><span id="open_mask-120"><a href="#open_mask-120"><span class="linenos">120</span></a><span class="sd">    &quot;&quot;&quot;</span>    
</span><span id="open_mask-121"><a href="#open_mask-121"><span class="linenos">121</span></a>
</span><span id="open_mask-122"><a href="#open_mask-122"><span class="linenos">122</span></a>    <span class="n">mask</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)[</span><span class="n">field</span><span class="p">]</span>
</span><span id="open_mask-123"><a href="#open_mask-123"><span class="linenos">123</span></a>    <span class="n">labels</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span><span class="n">dims</span><span class="o">=</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">zone</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">values</span><span class="p">())))</span>
</span><span id="open_mask-124"><a href="#open_mask-124"><span class="linenos">124</span></a>    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="o">!=</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="open_mask-125"><a href="#open_mask-125"><span class="linenos">125</span></a>        <span class="n">reg</span><span class="o">=</span><span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">grid</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest_s2d&#39;</span><span class="p">)</span>
</span><span id="open_mask-126"><a href="#open_mask-126"><span class="linenos">126</span></a>        <span class="n">mask</span> <span class="o">=</span> <span class="n">reg</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="open_mask-127"><a href="#open_mask-127"><span class="linenos">127</span></a>    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="o">==</span><span class="n">labels</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Open a mask in a dataset file, choose a given field, and regrid according to a given geometry. 
The returned mask contains an extra dimension named 'zone', corresponding to the different values
of the mask contained in the opened dataset.
Required format for the dataset to be opened :</p>

<ul>
<li>contains several dataarrays, each one being a mask (identified as 'field')</li>
<li>each mask is defined by values, whose signification is given in the attributes of the dataarray : {'value1' : 'label1',...}</li>
</ul>

<h2 id="parameters">Parameters</h2>

<p>file : path
    path and filename of the mask file to be opened
field : string
    name of the data to be used as a mask in the dataset
grid : dataset, optional
    dataset to be regridded on. If None, no regridding is performed</p>

<h2 id="returns">Returns</h2>

<p>mask : DataArray
    DataArray with regridded mask</p>

<h2 id="example">Example</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">xgeo</span><span class="o">.</span><span class="n">open_mask</span><span class="p">(</span><span class="s1">&#39;/home/user/lenapy/data/mask/GEO_mask_1deg_20210406.nc&#39;</span><span class="p">,</span><span class="s1">&#39;mask_continents&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="o">.</span><span class="n">zone</span>
<span class="go">&lt;xarray.DataArray (latitude: 360, longitude: 720, zone: 9)&gt;</span>
<span class="go">    array([[[False,  True, False, ..., False, False, False],</span>
<span class="go">    ...</span>
<span class="go">            [False, False, False, ..., False, False, False]]])</span>
<span class="go">    Coordinates:</span>
<span class="go">      * longitude  (longitude) float64 -179.8 -179.2 -178.8 ... 178.8 179.2 179.8</span>
<span class="go">      * latitude   (latitude) float64 -89.75 -89.25 -88.75 ... 88.75 89.25 89.75</span>
<span class="go">      * zone       (zone) &lt;U18 &#39;Greenland&#39; &#39;Antarctica&#39; ... &#39;Maritime continent&#39;</span>
</code></pre>
</div>
</div>


                </section>
                <section id="GeoSet">
                            <input id="GeoSet-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@xr.register_dataset_accessor(&#39;xgeo&#39;)</div>

    <span class="def">class</span>
    <span class="name">GeoSet</span>:

                <label class="view-source-button" for="GeoSet-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet-130"><a href="#GeoSet-130"><span class="linenos">130</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataset_accessor</span><span class="p">(</span><span class="s2">&quot;xgeo&quot;</span><span class="p">)</span>
</span><span id="GeoSet-131"><a href="#GeoSet-131"><span class="linenos">131</span></a><span class="k">class</span> <span class="nc">GeoSet</span><span class="p">:</span>
</span><span id="GeoSet-132"><a href="#GeoSet-132"><span class="linenos">132</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-133"><a href="#GeoSet-133"><span class="linenos">133</span></a><span class="sd">    This class implements an extension of any dataset to add some usefull methods often used in earth science data handling</span>
</span><span id="GeoSet-134"><a href="#GeoSet-134"><span class="linenos">134</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GeoSet-135"><a href="#GeoSet-135"><span class="linenos">135</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="GeoSet-136"><a href="#GeoSet-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span><span id="GeoSet-137"><a href="#GeoSet-137"><span class="linenos">137</span></a>        
</span><span id="GeoSet-138"><a href="#GeoSet-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-139"><a href="#GeoSet-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-140"><a href="#GeoSet-140"><span class="linenos">140</span></a><span class="sd">        Perform climato analysis on all the variables in a dataset</span>
</span><span id="GeoSet-141"><a href="#GeoSet-141"><span class="linenos">141</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="GeoSet-142"><a href="#GeoSet-142"><span class="linenos">142</span></a><span class="sd">            annual cycle</span>
</span><span id="GeoSet-143"><a href="#GeoSet-143"><span class="linenos">143</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="GeoSet-144"><a href="#GeoSet-144"><span class="linenos">144</span></a><span class="sd">            trend</span>
</span><span id="GeoSet-145"><a href="#GeoSet-145"><span class="linenos">145</span></a><span class="sd">            mean</span>
</span><span id="GeoSet-146"><a href="#GeoSet-146"><span class="linenos">146</span></a><span class="sd">            residual signal</span>
</span><span id="GeoSet-147"><a href="#GeoSet-147"><span class="linenos">147</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="GeoSet-148"><a href="#GeoSet-148"><span class="linenos">148</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="GeoSet-149"><a href="#GeoSet-149"><span class="linenos">149</span></a><span class="sd">        </span>
</span><span id="GeoSet-150"><a href="#GeoSet-150"><span class="linenos">150</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-151"><a href="#GeoSet-151"><span class="linenos">151</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-152"><a href="#GeoSet-152"><span class="linenos">152</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="GeoSet-153"><a href="#GeoSet-153"><span class="linenos">153</span></a><span class="sd">            returns residual signal</span>
</span><span id="GeoSet-154"><a href="#GeoSet-154"><span class="linenos">154</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="GeoSet-155"><a href="#GeoSet-155"><span class="linenos">155</span></a><span class="sd">            returns mean signal</span>
</span><span id="GeoSet-156"><a href="#GeoSet-156"><span class="linenos">156</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="GeoSet-157"><a href="#GeoSet-157"><span class="linenos">157</span></a><span class="sd">            returns trend</span>
</span><span id="GeoSet-158"><a href="#GeoSet-158"><span class="linenos">158</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="GeoSet-159"><a href="#GeoSet-159"><span class="linenos">159</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="GeoSet-160"><a href="#GeoSet-160"><span class="linenos">160</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="GeoSet-161"><a href="#GeoSet-161"><span class="linenos">161</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="GeoSet-162"><a href="#GeoSet-162"><span class="linenos">162</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="GeoSet-163"><a href="#GeoSet-163"><span class="linenos">163</span></a><span class="sd">            </span>
</span><span id="GeoSet-164"><a href="#GeoSet-164"><span class="linenos">164</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-165"><a href="#GeoSet-165"><span class="linenos">165</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-166"><a href="#GeoSet-166"><span class="linenos">166</span></a><span class="sd">        climato : dataset</span>
</span><span id="GeoSet-167"><a href="#GeoSet-167"><span class="linenos">167</span></a><span class="sd">            a dataset with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="GeoSet-168"><a href="#GeoSet-168"><span class="linenos">168</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="GeoSet-169"><a href="#GeoSet-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="GeoSet-170"><a href="#GeoSet-170"><span class="linenos">170</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-171"><a href="#GeoSet-171"><span class="linenos">171</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-172"><a href="#GeoSet-172"><span class="linenos">172</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet-173"><a href="#GeoSet-173"><span class="linenos">173</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="GeoSet-174"><a href="#GeoSet-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-175"><a href="#GeoSet-175"><span class="linenos">175</span></a>
</span><span id="GeoSet-176"><a href="#GeoSet-176"><span class="linenos">176</span></a>        <span class="c1"># Pour toutes les donnes dpendant du temps, retourne l&#39;analyse de la climato</span>
</span><span id="GeoSet-177"><a href="#GeoSet-177"><span class="linenos">177</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet-178"><a href="#GeoSet-178"><span class="linenos">178</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-179"><a href="#GeoSet-179"><span class="linenos">179</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet-180"><a href="#GeoSet-180"><span class="linenos">180</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-181"><a href="#GeoSet-181"><span class="linenos">181</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet-182"><a href="#GeoSet-182"><span class="linenos">182</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet-183"><a href="#GeoSet-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="GeoSet-184"><a href="#GeoSet-184"><span class="linenos">184</span></a>
</span><span id="GeoSet-185"><a href="#GeoSet-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-186"><a href="#GeoSet-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-187"><a href="#GeoSet-187"><span class="linenos">187</span></a><span class="sd">        Returns the averaged value of all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="GeoSet-188"><a href="#GeoSet-188"><span class="linenos">188</span></a><span class="sd">        </span>
</span><span id="GeoSet-189"><a href="#GeoSet-189"><span class="linenos">189</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-190"><a href="#GeoSet-190"><span class="linenos">190</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-191"><a href="#GeoSet-191"><span class="linenos">191</span></a><span class="sd">        *args : list</span>
</span><span id="GeoSet-192"><a href="#GeoSet-192"><span class="linenos">192</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="GeoSet-193"><a href="#GeoSet-193"><span class="linenos">193</span></a><span class="sd">        </span>
</span><span id="GeoSet-194"><a href="#GeoSet-194"><span class="linenos">194</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoSet-195"><a href="#GeoSet-195"><span class="linenos">195</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoSet-196"><a href="#GeoSet-196"><span class="linenos">196</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoSet-197"><a href="#GeoSet-197"><span class="linenos">197</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoSet-198"><a href="#GeoSet-198"><span class="linenos">198</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoSet-199"><a href="#GeoSet-199"><span class="linenos">199</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="GeoSet-200"><a href="#GeoSet-200"><span class="linenos">200</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoSet-201"><a href="#GeoSet-201"><span class="linenos">201</span></a><span class="sd">            mask to be applyed befire averaging</span>
</span><span id="GeoSet-202"><a href="#GeoSet-202"><span class="linenos">202</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="GeoSet-203"><a href="#GeoSet-203"><span class="linenos">203</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="GeoSet-204"><a href="#GeoSet-204"><span class="linenos">204</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoSet-205"><a href="#GeoSet-205"><span class="linenos">205</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="GeoSet-206"><a href="#GeoSet-206"><span class="linenos">206</span></a><span class="sd">            </span>
</span><span id="GeoSet-207"><a href="#GeoSet-207"><span class="linenos">207</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-208"><a href="#GeoSet-208"><span class="linenos">208</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-209"><a href="#GeoSet-209"><span class="linenos">209</span></a><span class="sd">        averaged : dataset</span>
</span><span id="GeoSet-210"><a href="#GeoSet-210"><span class="linenos">210</span></a><span class="sd">            dataset with all variables averaged according to specified options</span>
</span><span id="GeoSet-211"><a href="#GeoSet-211"><span class="linenos">211</span></a><span class="sd">            </span>
</span><span id="GeoSet-212"><a href="#GeoSet-212"><span class="linenos">212</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-213"><a href="#GeoSet-213"><span class="linenos">213</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-214"><a href="#GeoSet-214"><span class="linenos">214</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet-215"><a href="#GeoSet-215"><span class="linenos">215</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="GeoSet-216"><a href="#GeoSet-216"><span class="linenos">216</span></a><span class="sd">            </span>
</span><span id="GeoSet-217"><a href="#GeoSet-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-218"><a href="#GeoSet-218"><span class="linenos">218</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet-219"><a href="#GeoSet-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-220"><a href="#GeoSet-220"><span class="linenos">220</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-221"><a href="#GeoSet-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="GeoSet-222"><a href="#GeoSet-222"><span class="linenos">222</span></a>
</span><span id="GeoSet-223"><a href="#GeoSet-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-224"><a href="#GeoSet-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-225"><a href="#GeoSet-225"><span class="linenos">225</span></a><span class="sd">        Returns the sum for all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="GeoSet-226"><a href="#GeoSet-226"><span class="linenos">226</span></a><span class="sd">        </span>
</span><span id="GeoSet-227"><a href="#GeoSet-227"><span class="linenos">227</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-228"><a href="#GeoSet-228"><span class="linenos">228</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-229"><a href="#GeoSet-229"><span class="linenos">229</span></a><span class="sd">        *args : list</span>
</span><span id="GeoSet-230"><a href="#GeoSet-230"><span class="linenos">230</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="GeoSet-231"><a href="#GeoSet-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="GeoSet-232"><a href="#GeoSet-232"><span class="linenos">232</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoSet-233"><a href="#GeoSet-233"><span class="linenos">233</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoSet-234"><a href="#GeoSet-234"><span class="linenos">234</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoSet-235"><a href="#GeoSet-235"><span class="linenos">235</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoSet-236"><a href="#GeoSet-236"><span class="linenos">236</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoSet-237"><a href="#GeoSet-237"><span class="linenos">237</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="GeoSet-238"><a href="#GeoSet-238"><span class="linenos">238</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoSet-239"><a href="#GeoSet-239"><span class="linenos">239</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="GeoSet-240"><a href="#GeoSet-240"><span class="linenos">240</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoSet-241"><a href="#GeoSet-241"><span class="linenos">241</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="GeoSet-242"><a href="#GeoSet-242"><span class="linenos">242</span></a><span class="sd">            </span>
</span><span id="GeoSet-243"><a href="#GeoSet-243"><span class="linenos">243</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-244"><a href="#GeoSet-244"><span class="linenos">244</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-245"><a href="#GeoSet-245"><span class="linenos">245</span></a><span class="sd">        averaged : dataset</span>
</span><span id="GeoSet-246"><a href="#GeoSet-246"><span class="linenos">246</span></a><span class="sd">            dataset with all variablessummed according to specified options</span>
</span><span id="GeoSet-247"><a href="#GeoSet-247"><span class="linenos">247</span></a><span class="sd">            </span>
</span><span id="GeoSet-248"><a href="#GeoSet-248"><span class="linenos">248</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-249"><a href="#GeoSet-249"><span class="linenos">249</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-250"><a href="#GeoSet-250"><span class="linenos">250</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet-251"><a href="#GeoSet-251"><span class="linenos">251</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="GeoSet-252"><a href="#GeoSet-252"><span class="linenos">252</span></a><span class="sd">            </span>
</span><span id="GeoSet-253"><a href="#GeoSet-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>             
</span><span id="GeoSet-254"><a href="#GeoSet-254"><span class="linenos">254</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet-255"><a href="#GeoSet-255"><span class="linenos">255</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-256"><a href="#GeoSet-256"><span class="linenos">256</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-257"><a href="#GeoSet-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="GeoSet-258"><a href="#GeoSet-258"><span class="linenos">258</span></a>    
</span><span id="GeoSet-259"><a href="#GeoSet-259"><span class="linenos">259</span></a>    
</span><span id="GeoSet-260"><a href="#GeoSet-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="GeoSet-261"><a href="#GeoSet-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-262"><a href="#GeoSet-262"><span class="linenos">262</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the kwarg field=value.</span>
</span><span id="GeoSet-263"><a href="#GeoSet-263"><span class="linenos">263</span></a><span class="sd">        For example, we want to compute the isosurface defined by a temperature of 10C along depth dimension.</span>
</span><span id="GeoSet-264"><a href="#GeoSet-264"><span class="linenos">264</span></a><span class="sd">        All data variables of the data set are interpolated on this iso surface</span>
</span><span id="GeoSet-265"><a href="#GeoSet-265"><span class="linenos">265</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="GeoSet-266"><a href="#GeoSet-266"><span class="linenos">266</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="GeoSet-267"><a href="#GeoSet-267"><span class="linenos">267</span></a><span class="sd">        </span>
</span><span id="GeoSet-268"><a href="#GeoSet-268"><span class="linenos">268</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-269"><a href="#GeoSet-269"><span class="linenos">269</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-270"><a href="#GeoSet-270"><span class="linenos">270</span></a><span class="sd">        criterion : dict</span>
</span><span id="GeoSet-271"><a href="#GeoSet-271"><span class="linenos">271</span></a><span class="sd">            one-entry dictionnary with the key equal to a variable of the dataset, and the value equal to the isosurface criterion</span>
</span><span id="GeoSet-272"><a href="#GeoSet-272"><span class="linenos">272</span></a><span class="sd">        dim : string</span>
</span><span id="GeoSet-273"><a href="#GeoSet-273"><span class="linenos">273</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="GeoSet-274"><a href="#GeoSet-274"><span class="linenos">274</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="GeoSet-275"><a href="#GeoSet-275"><span class="linenos">275</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="GeoSet-276"><a href="#GeoSet-276"><span class="linenos">276</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="GeoSet-277"><a href="#GeoSet-277"><span class="linenos">277</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="GeoSet-278"><a href="#GeoSet-278"><span class="linenos">278</span></a><span class="sd">            </span>
</span><span id="GeoSet-279"><a href="#GeoSet-279"><span class="linenos">279</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-280"><a href="#GeoSet-280"><span class="linenos">280</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-281"><a href="#GeoSet-281"><span class="linenos">281</span></a><span class="sd">        isosurface : dataset</span>
</span><span id="GeoSet-282"><a href="#GeoSet-282"><span class="linenos">282</span></a><span class="sd">            Dataset with all the variables interpolated at the criterion value along chosen dimension. The variables chosen for</span>
</span><span id="GeoSet-283"><a href="#GeoSet-283"><span class="linenos">283</span></a><span class="sd">                criterion should contain a constant value equal to the criterion. the dimension chosen for the isosurface computation</span>
</span><span id="GeoSet-284"><a href="#GeoSet-284"><span class="linenos">284</span></a><span class="sd">                is filled with the isosurface itself.</span>
</span><span id="GeoSet-285"><a href="#GeoSet-285"><span class="linenos">285</span></a><span class="sd">                </span>
</span><span id="GeoSet-286"><a href="#GeoSet-286"><span class="linenos">286</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-287"><a href="#GeoSet-287"><span class="linenos">287</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-288"><a href="#GeoSet-288"><span class="linenos">288</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet-289"><a href="#GeoSet-289"><span class="linenos">289</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(&#39;depth&#39;,dict(temp=3))</span>
</span><span id="GeoSet-290"><a href="#GeoSet-290"><span class="linenos">290</span></a><span class="sd">        &lt;xarray.Dataset&gt;</span>
</span><span id="GeoSet-291"><a href="#GeoSet-291"><span class="linenos">291</span></a><span class="sd">        Dimensions:    (latitude: 90, longitude: 180)</span>
</span><span id="GeoSet-292"><a href="#GeoSet-292"><span class="linenos">292</span></a><span class="sd">        Coordinates:</span>
</span><span id="GeoSet-293"><a href="#GeoSet-293"><span class="linenos">293</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="GeoSet-294"><a href="#GeoSet-294"><span class="linenos">294</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="GeoSet-295"><a href="#GeoSet-295"><span class="linenos">295</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="GeoSet-296"><a href="#GeoSet-296"><span class="linenos">296</span></a><span class="sd">            depth      (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="GeoSet-297"><a href="#GeoSet-297"><span class="linenos">297</span></a><span class="sd">        Data variables:</span>
</span><span id="GeoSet-298"><a href="#GeoSet-298"><span class="linenos">298</span></a><span class="sd">            depth_iso  (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="GeoSet-299"><a href="#GeoSet-299"><span class="linenos">299</span></a><span class="sd">            temp       (latitude, longitude) float64 3.0 3.0 3.0 3.0 ... 3.0 3.0 3.0 3.0</span>
</span><span id="GeoSet-300"><a href="#GeoSet-300"><span class="linenos">300</span></a><span class="sd">            SA         (latitude, longitude) float64 34.48 34.39 34.39 ... 34.53 34.52</span>
</span><span id="GeoSet-301"><a href="#GeoSet-301"><span class="linenos">301</span></a>
</span><span id="GeoSet-302"><a href="#GeoSet-302"><span class="linenos">302</span></a><span class="sd">        </span>
</span><span id="GeoSet-303"><a href="#GeoSet-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-304"><a href="#GeoSet-304"><span class="linenos">304</span></a>        <span class="c1"># Calcule l&#39;isosurface selon la coordonne &#39;dim&#39; pour le champ dfini par le dictionnaire **kwargs (ex : temp=10)</span>
</span><span id="GeoSet-305"><a href="#GeoSet-305"><span class="linenos">305</span></a>        <span class="c1"># Retourne tous les champs interpols sur cette isosurface (pour ceux ayant &quot;dim&quot; en coordonne), ainsi que l&#39;isosurface elle-mme</span>
</span><span id="GeoSet-306"><a href="#GeoSet-306"><span class="linenos">306</span></a>        <span class="k">if</span> <span class="n">coord</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="GeoSet-307"><a href="#GeoSet-307"><span class="linenos">307</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">dim</span>
</span><span id="GeoSet-308"><a href="#GeoSet-308"><span class="linenos">308</span></a>        <span class="n">k</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GeoSet-309"><a href="#GeoSet-309"><span class="linenos">309</span></a>        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
</span><span id="GeoSet-310"><a href="#GeoSet-310"><span class="linenos">310</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">list</span><span class="p">(</span><span class="n">data_vars</span><span class="p">)))</span>
</span><span id="GeoSet-311"><a href="#GeoSet-311"><span class="linenos">311</span></a>            
</span><span id="GeoSet-312"><a href="#GeoSet-312"><span class="linenos">312</span></a>        <span class="n">r</span><span class="o">=</span><span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">criterion</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span><span id="GeoSet-313"><a href="#GeoSet-313"><span class="linenos">313</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
</span><span id="GeoSet-314"><a href="#GeoSet-314"><span class="linenos">314</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-315"><a href="#GeoSet-315"><span class="linenos">315</span></a>            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet-316"><a href="#GeoSet-316"><span class="linenos">316</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="n">coord</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
</span><span id="GeoSet-317"><a href="#GeoSet-317"><span class="linenos">317</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet-318"><a href="#GeoSet-318"><span class="linenos">318</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet-319"><a href="#GeoSet-319"><span class="linenos">319</span></a>
</span><span id="GeoSet-320"><a href="#GeoSet-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="GeoSet-321"><a href="#GeoSet-321"><span class="linenos">321</span></a>
</span><span id="GeoSet-322"><a href="#GeoSet-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-323"><a href="#GeoSet-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-324"><a href="#GeoSet-324"><span class="linenos">324</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataset </span>
</span><span id="GeoSet-325"><a href="#GeoSet-325"><span class="linenos">325</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="GeoSet-326"><a href="#GeoSet-326"><span class="linenos">326</span></a>
</span><span id="GeoSet-327"><a href="#GeoSet-327"><span class="linenos">327</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-328"><a href="#GeoSet-328"><span class="linenos">328</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-329"><a href="#GeoSet-329"><span class="linenos">329</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="GeoSet-330"><a href="#GeoSet-330"><span class="linenos">330</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="GeoSet-331"><a href="#GeoSet-331"><span class="linenos">331</span></a><span class="sd">        *args : </span>
</span><span id="GeoSet-332"><a href="#GeoSet-332"><span class="linenos">332</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="GeoSet-333"><a href="#GeoSet-333"><span class="linenos">333</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="GeoSet-334"><a href="#GeoSet-334"><span class="linenos">334</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="GeoSet-335"><a href="#GeoSet-335"><span class="linenos">335</span></a><span class="sd">        method : str</span>
</span><span id="GeoSet-336"><a href="#GeoSet-336"><span class="linenos">336</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="GeoSet-337"><a href="#GeoSet-337"><span class="linenos">337</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoSet-338"><a href="#GeoSet-338"><span class="linenos">338</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="GeoSet-339"><a href="#GeoSet-339"><span class="linenos">339</span></a>
</span><span id="GeoSet-340"><a href="#GeoSet-340"><span class="linenos">340</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-341"><a href="#GeoSet-341"><span class="linenos">341</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-342"><a href="#GeoSet-342"><span class="linenos">342</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoSet-343"><a href="#GeoSet-343"><span class="linenos">343</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoSet-344"><a href="#GeoSet-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-345"><a href="#GeoSet-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The latitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="GeoSet-346"><a href="#GeoSet-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The longitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="GeoSet-347"><a href="#GeoSet-347"><span class="linenos">347</span></a>
</span><span id="GeoSet-348"><a href="#GeoSet-348"><span class="linenos">348</span></a>        <span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span><span id="GeoSet-349"><a href="#GeoSet-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mask_in</span><span class="p">)</span><span class="o">==</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
</span><span id="GeoSet-350"><a href="#GeoSet-350"><span class="linenos">350</span></a>            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mask_in</span>
</span><span id="GeoSet-351"><a href="#GeoSet-351"><span class="linenos">351</span></a>            
</span><span id="GeoSet-352"><a href="#GeoSet-352"><span class="linenos">352</span></a>        <span class="n">ds_out</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span>
</span><span id="GeoSet-353"><a href="#GeoSet-353"><span class="linenos">353</span></a>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
</span><span id="GeoSet-354"><a href="#GeoSet-354"><span class="linenos">354</span></a>        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">longitude</span>
</span><span id="GeoSet-355"><a href="#GeoSet-355"><span class="linenos">355</span></a>        <span class="p">})</span>
</span><span id="GeoSet-356"><a href="#GeoSet-356"><span class="linenos">356</span></a>
</span><span id="GeoSet-357"><a href="#GeoSet-357"><span class="linenos">357</span></a>        <span class="k">return</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">ds_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-358"><a href="#GeoSet-358"><span class="linenos">358</span></a>    
</span><span id="GeoSet-359"><a href="#GeoSet-359"><span class="linenos">359</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-360"><a href="#GeoSet-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-361"><a href="#GeoSet-361"><span class="linenos">361</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoSet-362"><a href="#GeoSet-362"><span class="linenos">362</span></a>
</span><span id="GeoSet-363"><a href="#GeoSet-363"><span class="linenos">363</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-364"><a href="#GeoSet-364"><span class="linenos">364</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-365"><a href="#GeoSet-365"><span class="linenos">365</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoSet-366"><a href="#GeoSet-366"><span class="linenos">366</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="GeoSet-367"><a href="#GeoSet-367"><span class="linenos">367</span></a><span class="sd">        *args : </span>
</span><span id="GeoSet-368"><a href="#GeoSet-368"><span class="linenos">368</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="GeoSet-369"><a href="#GeoSet-369"><span class="linenos">369</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoSet-370"><a href="#GeoSet-370"><span class="linenos">370</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="GeoSet-371"><a href="#GeoSet-371"><span class="linenos">371</span></a>
</span><span id="GeoSet-372"><a href="#GeoSet-372"><span class="linenos">372</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-373"><a href="#GeoSet-373"><span class="linenos">373</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-374"><a href="#GeoSet-374"><span class="linenos">374</span></a><span class="sd">        regrid : dataset</span>
</span><span id="GeoSet-375"><a href="#GeoSet-375"><span class="linenos">375</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="GeoSet-376"><a href="#GeoSet-376"><span class="linenos">376</span></a>
</span><span id="GeoSet-377"><a href="#GeoSet-377"><span class="linenos">377</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-378"><a href="#GeoSet-378"><span class="linenos">378</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-379"><a href="#GeoSet-379"><span class="linenos">379</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="GeoSet-380"><a href="#GeoSet-380"><span class="linenos">380</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="GeoSet-381"><a href="#GeoSet-381"><span class="linenos">381</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="GeoSet-382"><a href="#GeoSet-382"><span class="linenos">382</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="GeoSet-383"><a href="#GeoSet-383"><span class="linenos">383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-384"><a href="#GeoSet-384"><span class="linenos">384</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-385"><a href="#GeoSet-385"><span class="linenos">385</span></a>    
</span><span id="GeoSet-386"><a href="#GeoSet-386"><span class="linenos">386</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-387"><a href="#GeoSet-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-388"><a href="#GeoSet-388"><span class="linenos">388</span></a><span class="sd">        Apply a specified filter on all the time-dependent data in the dataset</span>
</span><span id="GeoSet-389"><a href="#GeoSet-389"><span class="linenos">389</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="GeoSet-390"><a href="#GeoSet-390"><span class="linenos">390</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="GeoSet-391"><a href="#GeoSet-391"><span class="linenos">391</span></a><span class="sd">        </span>
</span><span id="GeoSet-392"><a href="#GeoSet-392"><span class="linenos">392</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet-393"><a href="#GeoSet-393"><span class="linenos">393</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet-394"><a href="#GeoSet-394"><span class="linenos">394</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="GeoSet-395"><a href="#GeoSet-395"><span class="linenos">395</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="GeoSet-396"><a href="#GeoSet-396"><span class="linenos">396</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="GeoSet-397"><a href="#GeoSet-397"><span class="linenos">397</span></a><span class="sd">        q : int</span>
</span><span id="GeoSet-398"><a href="#GeoSet-398"><span class="linenos">398</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="GeoSet-399"><a href="#GeoSet-399"><span class="linenos">399</span></a><span class="sd">        **kwargs :</span>
</span><span id="GeoSet-400"><a href="#GeoSet-400"><span class="linenos">400</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="GeoSet-401"><a href="#GeoSet-401"><span class="linenos">401</span></a><span class="sd">            </span>
</span><span id="GeoSet-402"><a href="#GeoSet-402"><span class="linenos">402</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-403"><a href="#GeoSet-403"><span class="linenos">403</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-404"><a href="#GeoSet-404"><span class="linenos">404</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="GeoSet-405"><a href="#GeoSet-405"><span class="linenos">405</span></a><span class="sd">        </span>
</span><span id="GeoSet-406"><a href="#GeoSet-406"><span class="linenos">406</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-407"><a href="#GeoSet-407"><span class="linenos">407</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-408"><a href="#GeoSet-408"><span class="linenos">408</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet-409"><a href="#GeoSet-409"><span class="linenos">409</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="GeoSet-410"><a href="#GeoSet-410"><span class="linenos">410</span></a><span class="sd">        </span>
</span><span id="GeoSet-411"><a href="#GeoSet-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-412"><a href="#GeoSet-412"><span class="linenos">412</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet-413"><a href="#GeoSet-413"><span class="linenos">413</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-414"><a href="#GeoSet-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet-415"><a href="#GeoSet-415"><span class="linenos">415</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-416"><a href="#GeoSet-416"><span class="linenos">416</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet-417"><a href="#GeoSet-417"><span class="linenos">417</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet-418"><a href="#GeoSet-418"><span class="linenos">418</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="GeoSet-419"><a href="#GeoSet-419"><span class="linenos">419</span></a>
</span><span id="GeoSet-420"><a href="#GeoSet-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet-421"><a href="#GeoSet-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-422"><a href="#GeoSet-422"><span class="linenos">422</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="GeoSet-423"><a href="#GeoSet-423"><span class="linenos">423</span></a><span class="sd">        </span>
</span><span id="GeoSet-424"><a href="#GeoSet-424"><span class="linenos">424</span></a><span class="sd">        Parameter</span>
</span><span id="GeoSet-425"><a href="#GeoSet-425"><span class="linenos">425</span></a><span class="sd">        ---------</span>
</span><span id="GeoSet-426"><a href="#GeoSet-426"><span class="linenos">426</span></a><span class="sd">        other : dataarray</span>
</span><span id="GeoSet-427"><a href="#GeoSet-427"><span class="linenos">427</span></a><span class="sd">            must have a time dimension</span>
</span><span id="GeoSet-428"><a href="#GeoSet-428"><span class="linenos">428</span></a><span class="sd">            </span>
</span><span id="GeoSet-429"><a href="#GeoSet-429"><span class="linenos">429</span></a><span class="sd">        Return</span>
</span><span id="GeoSet-430"><a href="#GeoSet-430"><span class="linenos">430</span></a><span class="sd">        ------</span>
</span><span id="GeoSet-431"><a href="#GeoSet-431"><span class="linenos">431</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="GeoSet-432"><a href="#GeoSet-432"><span class="linenos">432</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="GeoSet-433"><a href="#GeoSet-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoSet-434"><a href="#GeoSet-434"><span class="linenos">434</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet-435"><a href="#GeoSet-435"><span class="linenos">435</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet-436"><a href="#GeoSet-436"><span class="linenos">436</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet-437"><a href="#GeoSet-437"><span class="linenos">437</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">interp_time</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet-438"><a href="#GeoSet-438"><span class="linenos">438</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet-439"><a href="#GeoSet-439"><span class="linenos">439</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet-440"><a href="#GeoSet-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="GeoSet-441"><a href="#GeoSet-441"><span class="linenos">441</span></a>
</span><span id="GeoSet-442"><a href="#GeoSet-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="GeoSet-443"><a href="#GeoSet-443"><span class="linenos">443</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-444"><a href="#GeoSet-444"><span class="linenos">444</span></a><span class="sd">        Convert dataset time format to standard pandas time format</span>
</span><span id="GeoSet-445"><a href="#GeoSet-445"><span class="linenos">445</span></a><span class="sd">        </span>
</span><span id="GeoSet-446"><a href="#GeoSet-446"><span class="linenos">446</span></a><span class="sd">        Parameter</span>
</span><span id="GeoSet-447"><a href="#GeoSet-447"><span class="linenos">447</span></a><span class="sd">        ---------</span>
</span><span id="GeoSet-448"><a href="#GeoSet-448"><span class="linenos">448</span></a><span class="sd">        input_type : string</span>
</span><span id="GeoSet-449"><a href="#GeoSet-449"><span class="linenos">449</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="GeoSet-450"><a href="#GeoSet-450"><span class="linenos">450</span></a><span class="sd">            </span>
</span><span id="GeoSet-451"><a href="#GeoSet-451"><span class="linenos">451</span></a><span class="sd">        Return</span>
</span><span id="GeoSet-452"><a href="#GeoSet-452"><span class="linenos">452</span></a><span class="sd">        ------</span>
</span><span id="GeoSet-453"><a href="#GeoSet-453"><span class="linenos">453</span></a><span class="sd">        converted : dataset</span>
</span><span id="GeoSet-454"><a href="#GeoSet-454"><span class="linenos">454</span></a><span class="sd">            new dataset with the time dimension in a standard pandas format</span>
</span><span id="GeoSet-455"><a href="#GeoSet-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-456"><a href="#GeoSet-456"><span class="linenos">456</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span><span id="GeoSet-457"><a href="#GeoSet-457"><span class="linenos">457</span></a>
</span><span id="GeoSet-458"><a href="#GeoSet-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoSet-459"><a href="#GeoSet-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-460"><a href="#GeoSet-460"><span class="linenos">460</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="GeoSet-461"><a href="#GeoSet-461"><span class="linenos">461</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="GeoSet-462"><a href="#GeoSet-462"><span class="linenos">462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-463"><a href="#GeoSet-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="GeoSet-464"><a href="#GeoSet-464"><span class="linenos">464</span></a>        
</span><span id="GeoSet-465"><a href="#GeoSet-465"><span class="linenos">465</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoSet-466"><a href="#GeoSet-466"><span class="linenos">466</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet-467"><a href="#GeoSet-467"><span class="linenos">467</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="GeoSet-468"><a href="#GeoSet-468"><span class="linenos">468</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="GeoSet-469"><a href="#GeoSet-469"><span class="linenos">469</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="GeoSet-470"><a href="#GeoSet-470"><span class="linenos">470</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="GeoSet-471"><a href="#GeoSet-471"><span class="linenos">471</span></a>
</span><span id="GeoSet-472"><a href="#GeoSet-472"><span class="linenos">472</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet-473"><a href="#GeoSet-473"><span class="linenos">473</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-474"><a href="#GeoSet-474"><span class="linenos">474</span></a><span class="sd">        surface : dataarray</span>
</span><span id="GeoSet-475"><a href="#GeoSet-475"><span class="linenos">475</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="GeoSet-476"><a href="#GeoSet-476"><span class="linenos">476</span></a>
</span><span id="GeoSet-477"><a href="#GeoSet-477"><span class="linenos">477</span></a><span class="sd">        Example</span>
</span><span id="GeoSet-478"><a href="#GeoSet-478"><span class="linenos">478</span></a><span class="sd">        -------</span>
</span><span id="GeoSet-479"><a href="#GeoSet-479"><span class="linenos">479</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet-480"><a href="#GeoSet-480"><span class="linenos">480</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="GeoSet-481"><a href="#GeoSet-481"><span class="linenos">481</span></a>
</span><span id="GeoSet-482"><a href="#GeoSet-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet-483"><a href="#GeoSet-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This class implements an extension of any dataset to add some usefull methods often used in earth science data handling</p>
</div>


                            <div id="GeoSet.__init__" class="classattr">
                                        <input id="GeoSet.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">GeoSet</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xarray_obj</span></span>)</span>

                <label class="view-source-button" for="GeoSet.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.__init__-135"><a href="#GeoSet.__init__-135"><span class="linenos">135</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="GeoSet.__init__-136"><a href="#GeoSet.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span></pre></div>


    

                            </div>
                            <div id="GeoSet.climato" class="classattr">
                                        <input id="GeoSet.climato-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">climato</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.climato-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.climato"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.climato-138"><a href="#GeoSet.climato-138"><span class="linenos">138</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.climato-139"><a href="#GeoSet.climato-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.climato-140"><a href="#GeoSet.climato-140"><span class="linenos">140</span></a><span class="sd">        Perform climato analysis on all the variables in a dataset</span>
</span><span id="GeoSet.climato-141"><a href="#GeoSet.climato-141"><span class="linenos">141</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="GeoSet.climato-142"><a href="#GeoSet.climato-142"><span class="linenos">142</span></a><span class="sd">            annual cycle</span>
</span><span id="GeoSet.climato-143"><a href="#GeoSet.climato-143"><span class="linenos">143</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="GeoSet.climato-144"><a href="#GeoSet.climato-144"><span class="linenos">144</span></a><span class="sd">            trend</span>
</span><span id="GeoSet.climato-145"><a href="#GeoSet.climato-145"><span class="linenos">145</span></a><span class="sd">            mean</span>
</span><span id="GeoSet.climato-146"><a href="#GeoSet.climato-146"><span class="linenos">146</span></a><span class="sd">            residual signal</span>
</span><span id="GeoSet.climato-147"><a href="#GeoSet.climato-147"><span class="linenos">147</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="GeoSet.climato-148"><a href="#GeoSet.climato-148"><span class="linenos">148</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="GeoSet.climato-149"><a href="#GeoSet.climato-149"><span class="linenos">149</span></a><span class="sd">        </span>
</span><span id="GeoSet.climato-150"><a href="#GeoSet.climato-150"><span class="linenos">150</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.climato-151"><a href="#GeoSet.climato-151"><span class="linenos">151</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.climato-152"><a href="#GeoSet.climato-152"><span class="linenos">152</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="GeoSet.climato-153"><a href="#GeoSet.climato-153"><span class="linenos">153</span></a><span class="sd">            returns residual signal</span>
</span><span id="GeoSet.climato-154"><a href="#GeoSet.climato-154"><span class="linenos">154</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="GeoSet.climato-155"><a href="#GeoSet.climato-155"><span class="linenos">155</span></a><span class="sd">            returns mean signal</span>
</span><span id="GeoSet.climato-156"><a href="#GeoSet.climato-156"><span class="linenos">156</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="GeoSet.climato-157"><a href="#GeoSet.climato-157"><span class="linenos">157</span></a><span class="sd">            returns trend</span>
</span><span id="GeoSet.climato-158"><a href="#GeoSet.climato-158"><span class="linenos">158</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="GeoSet.climato-159"><a href="#GeoSet.climato-159"><span class="linenos">159</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="GeoSet.climato-160"><a href="#GeoSet.climato-160"><span class="linenos">160</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="GeoSet.climato-161"><a href="#GeoSet.climato-161"><span class="linenos">161</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="GeoSet.climato-162"><a href="#GeoSet.climato-162"><span class="linenos">162</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="GeoSet.climato-163"><a href="#GeoSet.climato-163"><span class="linenos">163</span></a><span class="sd">            </span>
</span><span id="GeoSet.climato-164"><a href="#GeoSet.climato-164"><span class="linenos">164</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.climato-165"><a href="#GeoSet.climato-165"><span class="linenos">165</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.climato-166"><a href="#GeoSet.climato-166"><span class="linenos">166</span></a><span class="sd">        climato : dataset</span>
</span><span id="GeoSet.climato-167"><a href="#GeoSet.climato-167"><span class="linenos">167</span></a><span class="sd">            a dataset with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="GeoSet.climato-168"><a href="#GeoSet.climato-168"><span class="linenos">168</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="GeoSet.climato-169"><a href="#GeoSet.climato-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="GeoSet.climato-170"><a href="#GeoSet.climato-170"><span class="linenos">170</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.climato-171"><a href="#GeoSet.climato-171"><span class="linenos">171</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.climato-172"><a href="#GeoSet.climato-172"><span class="linenos">172</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet.climato-173"><a href="#GeoSet.climato-173"><span class="linenos">173</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="GeoSet.climato-174"><a href="#GeoSet.climato-174"><span class="linenos">174</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.climato-175"><a href="#GeoSet.climato-175"><span class="linenos">175</span></a>
</span><span id="GeoSet.climato-176"><a href="#GeoSet.climato-176"><span class="linenos">176</span></a>        <span class="c1"># Pour toutes les donnes dpendant du temps, retourne l&#39;analyse de la climato</span>
</span><span id="GeoSet.climato-177"><a href="#GeoSet.climato-177"><span class="linenos">177</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet.climato-178"><a href="#GeoSet.climato-178"><span class="linenos">178</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.climato-179"><a href="#GeoSet.climato-179"><span class="linenos">179</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet.climato-180"><a href="#GeoSet.climato-180"><span class="linenos">180</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet.climato-181"><a href="#GeoSet.climato-181"><span class="linenos">181</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet.climato-182"><a href="#GeoSet.climato-182"><span class="linenos">182</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet.climato-183"><a href="#GeoSet.climato-183"><span class="linenos">183</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform climato analysis on all the variables in a dataset
Input data are decomposed into :
    annual cycle
    semi-annual cycle
    trend
    mean
    residual signal
The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)
If return_coeffs=True, the coefficients of the decompositions are returned</p>

<h2 id="parameters">Parameters</h2>

<p>signal : Bool (default=True)
    returns residual signal
mean : Bool (default=True)
    returns mean signal
trend : Bool (default=True)
    returns trend
cycle : Bool (default=False)
    return annual and semi-annual cycles
return_coeffs : Bool (default=False)
    returns cycle coefficient, mean and trend
    retourne en plus les coefficients des cycles et de la tendance linaire</p>

<h2 id="returns">Returns</h2>

<p>climato : dataset
    a dataset with the same structure as the input, with modified data according to the chosen options
if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc')
      output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoSet.mean" class="classattr">
                                        <input id="GeoSet.mean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mean</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.mean-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.mean"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.mean-185"><a href="#GeoSet.mean-185"><span class="linenos">185</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.mean-186"><a href="#GeoSet.mean-186"><span class="linenos">186</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.mean-187"><a href="#GeoSet.mean-187"><span class="linenos">187</span></a><span class="sd">        Returns the averaged value of all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="GeoSet.mean-188"><a href="#GeoSet.mean-188"><span class="linenos">188</span></a><span class="sd">        </span>
</span><span id="GeoSet.mean-189"><a href="#GeoSet.mean-189"><span class="linenos">189</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.mean-190"><a href="#GeoSet.mean-190"><span class="linenos">190</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.mean-191"><a href="#GeoSet.mean-191"><span class="linenos">191</span></a><span class="sd">        *args : list</span>
</span><span id="GeoSet.mean-192"><a href="#GeoSet.mean-192"><span class="linenos">192</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="GeoSet.mean-193"><a href="#GeoSet.mean-193"><span class="linenos">193</span></a><span class="sd">        </span>
</span><span id="GeoSet.mean-194"><a href="#GeoSet.mean-194"><span class="linenos">194</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoSet.mean-195"><a href="#GeoSet.mean-195"><span class="linenos">195</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoSet.mean-196"><a href="#GeoSet.mean-196"><span class="linenos">196</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoSet.mean-197"><a href="#GeoSet.mean-197"><span class="linenos">197</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoSet.mean-198"><a href="#GeoSet.mean-198"><span class="linenos">198</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoSet.mean-199"><a href="#GeoSet.mean-199"><span class="linenos">199</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="GeoSet.mean-200"><a href="#GeoSet.mean-200"><span class="linenos">200</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoSet.mean-201"><a href="#GeoSet.mean-201"><span class="linenos">201</span></a><span class="sd">            mask to be applyed befire averaging</span>
</span><span id="GeoSet.mean-202"><a href="#GeoSet.mean-202"><span class="linenos">202</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="GeoSet.mean-203"><a href="#GeoSet.mean-203"><span class="linenos">203</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="GeoSet.mean-204"><a href="#GeoSet.mean-204"><span class="linenos">204</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoSet.mean-205"><a href="#GeoSet.mean-205"><span class="linenos">205</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="GeoSet.mean-206"><a href="#GeoSet.mean-206"><span class="linenos">206</span></a><span class="sd">            </span>
</span><span id="GeoSet.mean-207"><a href="#GeoSet.mean-207"><span class="linenos">207</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.mean-208"><a href="#GeoSet.mean-208"><span class="linenos">208</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.mean-209"><a href="#GeoSet.mean-209"><span class="linenos">209</span></a><span class="sd">        averaged : dataset</span>
</span><span id="GeoSet.mean-210"><a href="#GeoSet.mean-210"><span class="linenos">210</span></a><span class="sd">            dataset with all variables averaged according to specified options</span>
</span><span id="GeoSet.mean-211"><a href="#GeoSet.mean-211"><span class="linenos">211</span></a><span class="sd">            </span>
</span><span id="GeoSet.mean-212"><a href="#GeoSet.mean-212"><span class="linenos">212</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.mean-213"><a href="#GeoSet.mean-213"><span class="linenos">213</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.mean-214"><a href="#GeoSet.mean-214"><span class="linenos">214</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet.mean-215"><a href="#GeoSet.mean-215"><span class="linenos">215</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="GeoSet.mean-216"><a href="#GeoSet.mean-216"><span class="linenos">216</span></a><span class="sd">            </span>
</span><span id="GeoSet.mean-217"><a href="#GeoSet.mean-217"><span class="linenos">217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.mean-218"><a href="#GeoSet.mean-218"><span class="linenos">218</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet.mean-219"><a href="#GeoSet.mean-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.mean-220"><a href="#GeoSet.mean-220"><span class="linenos">220</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet.mean-221"><a href="#GeoSet.mean-221"><span class="linenos">221</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the averaged value of all variables in dataset along specified dimension, applying specified weights</p>

<h2 id="parameters">Parameters</h2>

<p>*args : list
    list of the dimensions along which to average</p>

<p>weights : None or list or dataarray
    if None, no weight is applyed
    if 'latitude' or 'depth', a weight is applyed as the cosine of the latitude or 
            the thickness of the layer
    if dataarray :
            input data are multiplied by this dataarray before averaging
mask : None or dataarray
    mask to be applyed befire averaging
na_eq_zero : boolean (default=False)
    replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones
**kwargs : keyword arguments
    any keyword arguments passe to the native xarray.mean function</p>

<h2 id="returns">Returns</h2>

<p>averaged : dataset
    dataset with all variables averaged according to specified options</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc')
      avg = data.xgeo.mean(['latitude','longitude'],weights=['latitude'],na_eq_zero=True)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoSet.sum" class="classattr">
                                        <input id="GeoSet.sum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sum</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.sum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.sum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.sum-223"><a href="#GeoSet.sum-223"><span class="linenos">223</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.sum-224"><a href="#GeoSet.sum-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.sum-225"><a href="#GeoSet.sum-225"><span class="linenos">225</span></a><span class="sd">        Returns the sum for all variables in dataset along specified dimension, applying specified weights</span>
</span><span id="GeoSet.sum-226"><a href="#GeoSet.sum-226"><span class="linenos">226</span></a><span class="sd">        </span>
</span><span id="GeoSet.sum-227"><a href="#GeoSet.sum-227"><span class="linenos">227</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.sum-228"><a href="#GeoSet.sum-228"><span class="linenos">228</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.sum-229"><a href="#GeoSet.sum-229"><span class="linenos">229</span></a><span class="sd">        *args : list</span>
</span><span id="GeoSet.sum-230"><a href="#GeoSet.sum-230"><span class="linenos">230</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="GeoSet.sum-231"><a href="#GeoSet.sum-231"><span class="linenos">231</span></a><span class="sd">        </span>
</span><span id="GeoSet.sum-232"><a href="#GeoSet.sum-232"><span class="linenos">232</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoSet.sum-233"><a href="#GeoSet.sum-233"><span class="linenos">233</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoSet.sum-234"><a href="#GeoSet.sum-234"><span class="linenos">234</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoSet.sum-235"><a href="#GeoSet.sum-235"><span class="linenos">235</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoSet.sum-236"><a href="#GeoSet.sum-236"><span class="linenos">236</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoSet.sum-237"><a href="#GeoSet.sum-237"><span class="linenos">237</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="GeoSet.sum-238"><a href="#GeoSet.sum-238"><span class="linenos">238</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoSet.sum-239"><a href="#GeoSet.sum-239"><span class="linenos">239</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="GeoSet.sum-240"><a href="#GeoSet.sum-240"><span class="linenos">240</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoSet.sum-241"><a href="#GeoSet.sum-241"><span class="linenos">241</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="GeoSet.sum-242"><a href="#GeoSet.sum-242"><span class="linenos">242</span></a><span class="sd">            </span>
</span><span id="GeoSet.sum-243"><a href="#GeoSet.sum-243"><span class="linenos">243</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.sum-244"><a href="#GeoSet.sum-244"><span class="linenos">244</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.sum-245"><a href="#GeoSet.sum-245"><span class="linenos">245</span></a><span class="sd">        averaged : dataset</span>
</span><span id="GeoSet.sum-246"><a href="#GeoSet.sum-246"><span class="linenos">246</span></a><span class="sd">            dataset with all variablessummed according to specified options</span>
</span><span id="GeoSet.sum-247"><a href="#GeoSet.sum-247"><span class="linenos">247</span></a><span class="sd">            </span>
</span><span id="GeoSet.sum-248"><a href="#GeoSet.sum-248"><span class="linenos">248</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.sum-249"><a href="#GeoSet.sum-249"><span class="linenos">249</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.sum-250"><a href="#GeoSet.sum-250"><span class="linenos">250</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet.sum-251"><a href="#GeoSet.sum-251"><span class="linenos">251</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="GeoSet.sum-252"><a href="#GeoSet.sum-252"><span class="linenos">252</span></a><span class="sd">            </span>
</span><span id="GeoSet.sum-253"><a href="#GeoSet.sum-253"><span class="linenos">253</span></a><span class="sd">        &quot;&quot;&quot;</span>             
</span><span id="GeoSet.sum-254"><a href="#GeoSet.sum-254"><span class="linenos">254</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet.sum-255"><a href="#GeoSet.sum-255"><span class="linenos">255</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.sum-256"><a href="#GeoSet.sum-256"><span class="linenos">256</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet.sum-257"><a href="#GeoSet.sum-257"><span class="linenos">257</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the sum for all variables in dataset along specified dimension, applying specified weights</p>

<h2 id="parameters">Parameters</h2>

<p>*args : list
    list of the dimensions along which to sum</p>

<p>weights : None or list or dataarray
    if None, no weight is applyed
    if 'latitude' or 'depth', a weight is applyed as the cosine of the latitude or 
            the thickness of the layer
    if dataarray :
            input data are multiplied by this dataarray before summing
mask : None or dataarray
    mask to be applyed before summing
**kwargs : keyword arguments
    any keyword arguments passe to the native xarray.sum function</p>

<h2 id="returns">Returns</h2>

<p>averaged : dataset
    dataset with all variablessummed according to specified options</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc')
      avg = data.xgeo.sum(['latitude','longitude'],weights=['latitude'])</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoSet.isosurface" class="classattr">
                                        <input id="GeoSet.isosurface-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isosurface</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">criterion</span>, </span><span class="param"><span class="n">dim</span>, </span><span class="param"><span class="n">coord</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">upper</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.isosurface-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.isosurface"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.isosurface-260"><a href="#GeoSet.isosurface-260"><span class="linenos">260</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">criterion</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="GeoSet.isosurface-261"><a href="#GeoSet.isosurface-261"><span class="linenos">261</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.isosurface-262"><a href="#GeoSet.isosurface-262"><span class="linenos">262</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the kwarg field=value.</span>
</span><span id="GeoSet.isosurface-263"><a href="#GeoSet.isosurface-263"><span class="linenos">263</span></a><span class="sd">        For example, we want to compute the isosurface defined by a temperature of 10C along depth dimension.</span>
</span><span id="GeoSet.isosurface-264"><a href="#GeoSet.isosurface-264"><span class="linenos">264</span></a><span class="sd">        All data variables of the data set are interpolated on this iso surface</span>
</span><span id="GeoSet.isosurface-265"><a href="#GeoSet.isosurface-265"><span class="linenos">265</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="GeoSet.isosurface-266"><a href="#GeoSet.isosurface-266"><span class="linenos">266</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="GeoSet.isosurface-267"><a href="#GeoSet.isosurface-267"><span class="linenos">267</span></a><span class="sd">        </span>
</span><span id="GeoSet.isosurface-268"><a href="#GeoSet.isosurface-268"><span class="linenos">268</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.isosurface-269"><a href="#GeoSet.isosurface-269"><span class="linenos">269</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.isosurface-270"><a href="#GeoSet.isosurface-270"><span class="linenos">270</span></a><span class="sd">        criterion : dict</span>
</span><span id="GeoSet.isosurface-271"><a href="#GeoSet.isosurface-271"><span class="linenos">271</span></a><span class="sd">            one-entry dictionnary with the key equal to a variable of the dataset, and the value equal to the isosurface criterion</span>
</span><span id="GeoSet.isosurface-272"><a href="#GeoSet.isosurface-272"><span class="linenos">272</span></a><span class="sd">        dim : string</span>
</span><span id="GeoSet.isosurface-273"><a href="#GeoSet.isosurface-273"><span class="linenos">273</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="GeoSet.isosurface-274"><a href="#GeoSet.isosurface-274"><span class="linenos">274</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="GeoSet.isosurface-275"><a href="#GeoSet.isosurface-275"><span class="linenos">275</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="GeoSet.isosurface-276"><a href="#GeoSet.isosurface-276"><span class="linenos">276</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="GeoSet.isosurface-277"><a href="#GeoSet.isosurface-277"><span class="linenos">277</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="GeoSet.isosurface-278"><a href="#GeoSet.isosurface-278"><span class="linenos">278</span></a><span class="sd">            </span>
</span><span id="GeoSet.isosurface-279"><a href="#GeoSet.isosurface-279"><span class="linenos">279</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.isosurface-280"><a href="#GeoSet.isosurface-280"><span class="linenos">280</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.isosurface-281"><a href="#GeoSet.isosurface-281"><span class="linenos">281</span></a><span class="sd">        isosurface : dataset</span>
</span><span id="GeoSet.isosurface-282"><a href="#GeoSet.isosurface-282"><span class="linenos">282</span></a><span class="sd">            Dataset with all the variables interpolated at the criterion value along chosen dimension. The variables chosen for</span>
</span><span id="GeoSet.isosurface-283"><a href="#GeoSet.isosurface-283"><span class="linenos">283</span></a><span class="sd">                criterion should contain a constant value equal to the criterion. the dimension chosen for the isosurface computation</span>
</span><span id="GeoSet.isosurface-284"><a href="#GeoSet.isosurface-284"><span class="linenos">284</span></a><span class="sd">                is filled with the isosurface itself.</span>
</span><span id="GeoSet.isosurface-285"><a href="#GeoSet.isosurface-285"><span class="linenos">285</span></a><span class="sd">                </span>
</span><span id="GeoSet.isosurface-286"><a href="#GeoSet.isosurface-286"><span class="linenos">286</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.isosurface-287"><a href="#GeoSet.isosurface-287"><span class="linenos">287</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.isosurface-288"><a href="#GeoSet.isosurface-288"><span class="linenos">288</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet.isosurface-289"><a href="#GeoSet.isosurface-289"><span class="linenos">289</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(&#39;depth&#39;,dict(temp=3))</span>
</span><span id="GeoSet.isosurface-290"><a href="#GeoSet.isosurface-290"><span class="linenos">290</span></a><span class="sd">        &lt;xarray.Dataset&gt;</span>
</span><span id="GeoSet.isosurface-291"><a href="#GeoSet.isosurface-291"><span class="linenos">291</span></a><span class="sd">        Dimensions:    (latitude: 90, longitude: 180)</span>
</span><span id="GeoSet.isosurface-292"><a href="#GeoSet.isosurface-292"><span class="linenos">292</span></a><span class="sd">        Coordinates:</span>
</span><span id="GeoSet.isosurface-293"><a href="#GeoSet.isosurface-293"><span class="linenos">293</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="GeoSet.isosurface-294"><a href="#GeoSet.isosurface-294"><span class="linenos">294</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="GeoSet.isosurface-295"><a href="#GeoSet.isosurface-295"><span class="linenos">295</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="GeoSet.isosurface-296"><a href="#GeoSet.isosurface-296"><span class="linenos">296</span></a><span class="sd">            depth      (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="GeoSet.isosurface-297"><a href="#GeoSet.isosurface-297"><span class="linenos">297</span></a><span class="sd">        Data variables:</span>
</span><span id="GeoSet.isosurface-298"><a href="#GeoSet.isosurface-298"><span class="linenos">298</span></a><span class="sd">            depth_iso  (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0</span>
</span><span id="GeoSet.isosurface-299"><a href="#GeoSet.isosurface-299"><span class="linenos">299</span></a><span class="sd">            temp       (latitude, longitude) float64 3.0 3.0 3.0 3.0 ... 3.0 3.0 3.0 3.0</span>
</span><span id="GeoSet.isosurface-300"><a href="#GeoSet.isosurface-300"><span class="linenos">300</span></a><span class="sd">            SA         (latitude, longitude) float64 34.48 34.39 34.39 ... 34.53 34.52</span>
</span><span id="GeoSet.isosurface-301"><a href="#GeoSet.isosurface-301"><span class="linenos">301</span></a>
</span><span id="GeoSet.isosurface-302"><a href="#GeoSet.isosurface-302"><span class="linenos">302</span></a><span class="sd">        </span>
</span><span id="GeoSet.isosurface-303"><a href="#GeoSet.isosurface-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.isosurface-304"><a href="#GeoSet.isosurface-304"><span class="linenos">304</span></a>        <span class="c1"># Calcule l&#39;isosurface selon la coordonne &#39;dim&#39; pour le champ dfini par le dictionnaire **kwargs (ex : temp=10)</span>
</span><span id="GeoSet.isosurface-305"><a href="#GeoSet.isosurface-305"><span class="linenos">305</span></a>        <span class="c1"># Retourne tous les champs interpols sur cette isosurface (pour ceux ayant &quot;dim&quot; en coordonne), ainsi que l&#39;isosurface elle-mme</span>
</span><span id="GeoSet.isosurface-306"><a href="#GeoSet.isosurface-306"><span class="linenos">306</span></a>        <span class="k">if</span> <span class="n">coord</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
</span><span id="GeoSet.isosurface-307"><a href="#GeoSet.isosurface-307"><span class="linenos">307</span></a>            <span class="n">coord</span><span class="o">=</span><span class="n">dim</span>
</span><span id="GeoSet.isosurface-308"><a href="#GeoSet.isosurface-308"><span class="linenos">308</span></a>        <span class="n">k</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">criterion</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="GeoSet.isosurface-309"><a href="#GeoSet.isosurface-309"><span class="linenos">309</span></a>        <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">):</span>
</span><span id="GeoSet.isosurface-310"><a href="#GeoSet.isosurface-310"><span class="linenos">310</span></a>            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not in </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">criterion</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">list</span><span class="p">(</span><span class="n">data_vars</span><span class="p">)))</span>
</span><span id="GeoSet.isosurface-311"><a href="#GeoSet.isosurface-311"><span class="linenos">311</span></a>            
</span><span id="GeoSet.isosurface-312"><a href="#GeoSet.isosurface-312"><span class="linenos">312</span></a>        <span class="n">r</span><span class="o">=</span><span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">criterion</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span><span id="GeoSet.isosurface-313"><a href="#GeoSet.isosurface-313"><span class="linenos">313</span></a>        <span class="n">res</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
</span><span id="GeoSet.isosurface-314"><a href="#GeoSet.isosurface-314"><span class="linenos">314</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.isosurface-315"><a href="#GeoSet.isosurface-315"><span class="linenos">315</span></a>            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet.isosurface-316"><a href="#GeoSet.isosurface-316"><span class="linenos">316</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">interp</span><span class="p">({</span><span class="n">coord</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
</span><span id="GeoSet.isosurface-317"><a href="#GeoSet.isosurface-317"><span class="linenos">317</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet.isosurface-318"><a href="#GeoSet.isosurface-318"><span class="linenos">318</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet.isosurface-319"><a href="#GeoSet.isosurface-319"><span class="linenos">319</span></a>
</span><span id="GeoSet.isosurface-320"><a href="#GeoSet.isosurface-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Compute the isosurface along the specified coordinate at the value defined  by the kwarg field=value.
For example, we want to compute the isosurface defined by a temperature of 10C along depth dimension.
All data variables of the data set are interpolated on this iso surface
Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,
starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</p>

<h2 id="parameters">Parameters</h2>

<p>criterion : dict
    one-entry dictionnary with the key equal to a variable of the dataset, and the value equal to the isosurface criterion
dim : string
    dimension along which to compute the isosurface
coord : str (optional)
    The field coordinate to interpolate. If absent, coordinate is supposed to be "dim"
upper : boolean (default=False)
    order to perform the research of the criterion value. If False, from the end, if True, form the beggining</p>

<h2 id="returns">Returns</h2>

<p>isosurface : dataset
    Dataset with all the variables interpolated at the criterion value along chosen dimension. The variables chosen for
        criterion should contain a constant value equal to the criterion. the dimension chosen for the isosurface computation
        is filled with the isosurface itself.</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc')
      data.isosurface('depth',dict(temp=3))
      <xarray.Dataset>
      Dimensions:    (latitude: 90, longitude: 180)
      Coordinates:</p>
      
      <ul>
      <li>latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0
      time       datetime64[ns] 2005-01-15
      depth      (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0
      Data variables:
      depth_iso  (latitude, longitude) float64 918.6 745.8 704.8 ... 912.2 920.0
      temp       (latitude, longitude) float64 3.0 3.0 3.0 3.0 ... 3.0 3.0 3.0 3.0
      SA         (latitude, longitude) float64 34.48 34.39 34.39 ... 34.53 34.52</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoSet.regridder" class="classattr">
                                        <input id="GeoSet.regridder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">regridder</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">gr_out</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.regridder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.regridder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.regridder-322"><a href="#GeoSet.regridder-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.regridder-323"><a href="#GeoSet.regridder-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.regridder-324"><a href="#GeoSet.regridder-324"><span class="linenos">324</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataset </span>
</span><span id="GeoSet.regridder-325"><a href="#GeoSet.regridder-325"><span class="linenos">325</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="GeoSet.regridder-326"><a href="#GeoSet.regridder-326"><span class="linenos">326</span></a>
</span><span id="GeoSet.regridder-327"><a href="#GeoSet.regridder-327"><span class="linenos">327</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.regridder-328"><a href="#GeoSet.regridder-328"><span class="linenos">328</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.regridder-329"><a href="#GeoSet.regridder-329"><span class="linenos">329</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="GeoSet.regridder-330"><a href="#GeoSet.regridder-330"><span class="linenos">330</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="GeoSet.regridder-331"><a href="#GeoSet.regridder-331"><span class="linenos">331</span></a><span class="sd">        *args : </span>
</span><span id="GeoSet.regridder-332"><a href="#GeoSet.regridder-332"><span class="linenos">332</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="GeoSet.regridder-333"><a href="#GeoSet.regridder-333"><span class="linenos">333</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="GeoSet.regridder-334"><a href="#GeoSet.regridder-334"><span class="linenos">334</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="GeoSet.regridder-335"><a href="#GeoSet.regridder-335"><span class="linenos">335</span></a><span class="sd">        method : str</span>
</span><span id="GeoSet.regridder-336"><a href="#GeoSet.regridder-336"><span class="linenos">336</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="GeoSet.regridder-337"><a href="#GeoSet.regridder-337"><span class="linenos">337</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoSet.regridder-338"><a href="#GeoSet.regridder-338"><span class="linenos">338</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="GeoSet.regridder-339"><a href="#GeoSet.regridder-339"><span class="linenos">339</span></a>
</span><span id="GeoSet.regridder-340"><a href="#GeoSet.regridder-340"><span class="linenos">340</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.regridder-341"><a href="#GeoSet.regridder-341"><span class="linenos">341</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.regridder-342"><a href="#GeoSet.regridder-342"><span class="linenos">342</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoSet.regridder-343"><a href="#GeoSet.regridder-343"><span class="linenos">343</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoSet.regridder-344"><a href="#GeoSet.regridder-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.regridder-345"><a href="#GeoSet.regridder-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The latitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="GeoSet.regridder-346"><a href="#GeoSet.regridder-346"><span class="linenos">346</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;longitude&#39;</span> <span class="ow">in</span> <span class="n">gr_out</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s1">&#39;The longitude coordinates does not exist&#39;</span><span class="p">)</span>
</span><span id="GeoSet.regridder-347"><a href="#GeoSet.regridder-347"><span class="linenos">347</span></a>
</span><span id="GeoSet.regridder-348"><a href="#GeoSet.regridder-348"><span class="linenos">348</span></a>        <span class="n">ds</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span>
</span><span id="GeoSet.regridder-349"><a href="#GeoSet.regridder-349"><span class="linenos">349</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">mask_in</span><span class="p">)</span><span class="o">==</span><span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">:</span>
</span><span id="GeoSet.regridder-350"><a href="#GeoSet.regridder-350"><span class="linenos">350</span></a>            <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;mask&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mask_in</span>
</span><span id="GeoSet.regridder-351"><a href="#GeoSet.regridder-351"><span class="linenos">351</span></a>            
</span><span id="GeoSet.regridder-352"><a href="#GeoSet.regridder-352"><span class="linenos">352</span></a>        <span class="n">ds_out</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span>
</span><span id="GeoSet.regridder-353"><a href="#GeoSet.regridder-353"><span class="linenos">353</span></a>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
</span><span id="GeoSet.regridder-354"><a href="#GeoSet.regridder-354"><span class="linenos">354</span></a>        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span><span class="n">gr_out</span><span class="o">.</span><span class="n">longitude</span>
</span><span id="GeoSet.regridder-355"><a href="#GeoSet.regridder-355"><span class="linenos">355</span></a>        <span class="p">})</span>
</span><span id="GeoSet.regridder-356"><a href="#GeoSet.regridder-356"><span class="linenos">356</span></a>
</span><span id="GeoSet.regridder-357"><a href="#GeoSet.regridder-357"><span class="linenos">357</span></a>        <span class="k">return</span> <span class="n">xe</span><span class="o">.</span><span class="n">Regridder</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="n">ds_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataset 
coordinates to gr_out coordinates</p>

<h2 id="parameters">Parameters</h2>

<p>gr_out : dataset
    dataset containing the coordinates to regrid on
*args : 
    any argument passed to xesmf.Regridder method
mask_in : None or dataarray
    mask to be applied on the data to regrid
method : str
    resampling method (see xesmf documentation) <br />
*kwargs : 
    any keyword argument passed to xesmf.Regridder method</p>

<h2 id="returns">Returns</h2>

<p>regridder : xesmf.Regridder instance
    regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</p>
</div>


                            </div>
                            <div id="GeoSet.regrid" class="classattr">
                                        <input id="GeoSet.regrid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">regrid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">regridder</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.regrid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.regrid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.regrid-359"><a href="#GeoSet.regrid-359"><span class="linenos">359</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.regrid-360"><a href="#GeoSet.regrid-360"><span class="linenos">360</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.regrid-361"><a href="#GeoSet.regrid-361"><span class="linenos">361</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoSet.regrid-362"><a href="#GeoSet.regrid-362"><span class="linenos">362</span></a>
</span><span id="GeoSet.regrid-363"><a href="#GeoSet.regrid-363"><span class="linenos">363</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.regrid-364"><a href="#GeoSet.regrid-364"><span class="linenos">364</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.regrid-365"><a href="#GeoSet.regrid-365"><span class="linenos">365</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoSet.regrid-366"><a href="#GeoSet.regrid-366"><span class="linenos">366</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="GeoSet.regrid-367"><a href="#GeoSet.regrid-367"><span class="linenos">367</span></a><span class="sd">        *args : </span>
</span><span id="GeoSet.regrid-368"><a href="#GeoSet.regrid-368"><span class="linenos">368</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="GeoSet.regrid-369"><a href="#GeoSet.regrid-369"><span class="linenos">369</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoSet.regrid-370"><a href="#GeoSet.regrid-370"><span class="linenos">370</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="GeoSet.regrid-371"><a href="#GeoSet.regrid-371"><span class="linenos">371</span></a>
</span><span id="GeoSet.regrid-372"><a href="#GeoSet.regrid-372"><span class="linenos">372</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.regrid-373"><a href="#GeoSet.regrid-373"><span class="linenos">373</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.regrid-374"><a href="#GeoSet.regrid-374"><span class="linenos">374</span></a><span class="sd">        regrid : dataset</span>
</span><span id="GeoSet.regrid-375"><a href="#GeoSet.regrid-375"><span class="linenos">375</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="GeoSet.regrid-376"><a href="#GeoSet.regrid-376"><span class="linenos">376</span></a>
</span><span id="GeoSet.regrid-377"><a href="#GeoSet.regrid-377"><span class="linenos">377</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.regrid-378"><a href="#GeoSet.regrid-378"><span class="linenos">378</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.regrid-379"><a href="#GeoSet.regrid-379"><span class="linenos">379</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="GeoSet.regrid-380"><a href="#GeoSet.regrid-380"><span class="linenos">380</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="GeoSet.regrid-381"><a href="#GeoSet.regrid-381"><span class="linenos">381</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="GeoSet.regrid-382"><a href="#GeoSet.regrid-382"><span class="linenos">382</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="GeoSet.regrid-383"><a href="#GeoSet.regrid-383"><span class="linenos">383</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.regrid-384"><a href="#GeoSet.regrid-384"><span class="linenos">384</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</p>

<h2 id="parameters">Parameters</h2>

<p>regridder : xesmf.Regridder instance
    regridder set with the xgeo.regridder method
*args : 
    any argument passed to xesmf regridder method
*kwargs : 
    any keyword argument passed to xesmf regridder method</p>

<h2 id="returns">Returns</h2>

<p>regrid : dataset
    dataset regridded to gr_out coordinates</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>ds_out = xr.Dataset({"latitude":(["latitude"],np.arange(-89.5,90,1.)),</p>
    </blockquote>
  </blockquote>
</blockquote>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span>                    <span class="s2">&quot;longitude&quot;</span><span class="p">:([</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">179.5</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mf">1.</span><span class="p">))})</span>
<span class="go">&gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
<span class="go">&gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="GeoSet.filter" class="classattr">
                                        <input id="GeoSet.filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span>, </span><span class="param"><span class="n">q</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.filter-386"><a href="#GeoSet.filter-386"><span class="linenos">386</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.filter-387"><a href="#GeoSet.filter-387"><span class="linenos">387</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.filter-388"><a href="#GeoSet.filter-388"><span class="linenos">388</span></a><span class="sd">        Apply a specified filter on all the time-dependent data in the dataset</span>
</span><span id="GeoSet.filter-389"><a href="#GeoSet.filter-389"><span class="linenos">389</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="GeoSet.filter-390"><a href="#GeoSet.filter-390"><span class="linenos">390</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="GeoSet.filter-391"><a href="#GeoSet.filter-391"><span class="linenos">391</span></a><span class="sd">        </span>
</span><span id="GeoSet.filter-392"><a href="#GeoSet.filter-392"><span class="linenos">392</span></a><span class="sd">        Parameters</span>
</span><span id="GeoSet.filter-393"><a href="#GeoSet.filter-393"><span class="linenos">393</span></a><span class="sd">        ----------</span>
</span><span id="GeoSet.filter-394"><a href="#GeoSet.filter-394"><span class="linenos">394</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="GeoSet.filter-395"><a href="#GeoSet.filter-395"><span class="linenos">395</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="GeoSet.filter-396"><a href="#GeoSet.filter-396"><span class="linenos">396</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="GeoSet.filter-397"><a href="#GeoSet.filter-397"><span class="linenos">397</span></a><span class="sd">        q : int</span>
</span><span id="GeoSet.filter-398"><a href="#GeoSet.filter-398"><span class="linenos">398</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="GeoSet.filter-399"><a href="#GeoSet.filter-399"><span class="linenos">399</span></a><span class="sd">        **kwargs :</span>
</span><span id="GeoSet.filter-400"><a href="#GeoSet.filter-400"><span class="linenos">400</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="GeoSet.filter-401"><a href="#GeoSet.filter-401"><span class="linenos">401</span></a><span class="sd">            </span>
</span><span id="GeoSet.filter-402"><a href="#GeoSet.filter-402"><span class="linenos">402</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.filter-403"><a href="#GeoSet.filter-403"><span class="linenos">403</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.filter-404"><a href="#GeoSet.filter-404"><span class="linenos">404</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="GeoSet.filter-405"><a href="#GeoSet.filter-405"><span class="linenos">405</span></a><span class="sd">        </span>
</span><span id="GeoSet.filter-406"><a href="#GeoSet.filter-406"><span class="linenos">406</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.filter-407"><a href="#GeoSet.filter-407"><span class="linenos">407</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.filter-408"><a href="#GeoSet.filter-408"><span class="linenos">408</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;)</span>
</span><span id="GeoSet.filter-409"><a href="#GeoSet.filter-409"><span class="linenos">409</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="GeoSet.filter-410"><a href="#GeoSet.filter-410"><span class="linenos">410</span></a><span class="sd">        </span>
</span><span id="GeoSet.filter-411"><a href="#GeoSet.filter-411"><span class="linenos">411</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.filter-412"><a href="#GeoSet.filter-412"><span class="linenos">412</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet.filter-413"><a href="#GeoSet.filter-413"><span class="linenos">413</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.filter-414"><a href="#GeoSet.filter-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet.filter-415"><a href="#GeoSet.filter-415"><span class="linenos">415</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet.filter-416"><a href="#GeoSet.filter-416"><span class="linenos">416</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet.filter-417"><a href="#GeoSet.filter-417"><span class="linenos">417</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet.filter-418"><a href="#GeoSet.filter-418"><span class="linenos">418</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply a specified filter on all the time-dependent data in the dataset
Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data
Available filters are in the <a href="utils.html">lenapy.utils</a> python file</p>

<h2 id="parameters">Parameters</h2>

<p>filter_name : function or string
    if string, filter function name, from the <a href="filters.html">lenapy.filters</a> file
    if function, external function defined by user, returning a kernel
q : int
    order of the polyfit to handle boundary effects
**kwargs :
    keyword arguments for the chosen filter</p>

<h2 id="returns">Returns</h2>

<p>filtered : filtered dataset</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc')
      data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoSet.interp_time" class="classattr">
                                        <input id="GeoSet.interp_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">interp_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.interp_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.interp_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.interp_time-420"><a href="#GeoSet.interp_time-420"><span class="linenos">420</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoSet.interp_time-421"><a href="#GeoSet.interp_time-421"><span class="linenos">421</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.interp_time-422"><a href="#GeoSet.interp_time-422"><span class="linenos">422</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="GeoSet.interp_time-423"><a href="#GeoSet.interp_time-423"><span class="linenos">423</span></a><span class="sd">        </span>
</span><span id="GeoSet.interp_time-424"><a href="#GeoSet.interp_time-424"><span class="linenos">424</span></a><span class="sd">        Parameter</span>
</span><span id="GeoSet.interp_time-425"><a href="#GeoSet.interp_time-425"><span class="linenos">425</span></a><span class="sd">        ---------</span>
</span><span id="GeoSet.interp_time-426"><a href="#GeoSet.interp_time-426"><span class="linenos">426</span></a><span class="sd">        other : dataarray</span>
</span><span id="GeoSet.interp_time-427"><a href="#GeoSet.interp_time-427"><span class="linenos">427</span></a><span class="sd">            must have a time dimension</span>
</span><span id="GeoSet.interp_time-428"><a href="#GeoSet.interp_time-428"><span class="linenos">428</span></a><span class="sd">            </span>
</span><span id="GeoSet.interp_time-429"><a href="#GeoSet.interp_time-429"><span class="linenos">429</span></a><span class="sd">        Return</span>
</span><span id="GeoSet.interp_time-430"><a href="#GeoSet.interp_time-430"><span class="linenos">430</span></a><span class="sd">        ------</span>
</span><span id="GeoSet.interp_time-431"><a href="#GeoSet.interp_time-431"><span class="linenos">431</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="GeoSet.interp_time-432"><a href="#GeoSet.interp_time-432"><span class="linenos">432</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="GeoSet.interp_time-433"><a href="#GeoSet.interp_time-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoSet.interp_time-434"><a href="#GeoSet.interp_time-434"><span class="linenos">434</span></a>        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
</span><span id="GeoSet.interp_time-435"><a href="#GeoSet.interp_time-435"><span class="linenos">435</span></a>        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
</span><span id="GeoSet.interp_time-436"><a href="#GeoSet.interp_time-436"><span class="linenos">436</span></a>            <span class="k">if</span> <span class="s1">&#39;time&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoSet.interp_time-437"><a href="#GeoSet.interp_time-437"><span class="linenos">437</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">interp_time</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoSet.interp_time-438"><a href="#GeoSet.interp_time-438"><span class="linenos">438</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="GeoSet.interp_time-439"><a href="#GeoSet.interp_time-439"><span class="linenos">439</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</span><span id="GeoSet.interp_time-440"><a href="#GeoSet.interp_time-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Interpolate dataarray at the same dates than other</p>

<h2 id="parameter">Parameter</h2>

<p>other : dataarray
    must have a time dimension</p>

<h2 id="return">Return</h2>

<p>interpolated : dataarray
    new dataarray interpolated</p>
</div>


                            </div>
                            <div id="GeoSet.to_datetime" class="classattr">
                                        <input id="GeoSet.to_datetime-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_datetime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">input_type</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.to_datetime-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.to_datetime"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.to_datetime-442"><a href="#GeoSet.to_datetime-442"><span class="linenos">442</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="GeoSet.to_datetime-443"><a href="#GeoSet.to_datetime-443"><span class="linenos">443</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.to_datetime-444"><a href="#GeoSet.to_datetime-444"><span class="linenos">444</span></a><span class="sd">        Convert dataset time format to standard pandas time format</span>
</span><span id="GeoSet.to_datetime-445"><a href="#GeoSet.to_datetime-445"><span class="linenos">445</span></a><span class="sd">        </span>
</span><span id="GeoSet.to_datetime-446"><a href="#GeoSet.to_datetime-446"><span class="linenos">446</span></a><span class="sd">        Parameter</span>
</span><span id="GeoSet.to_datetime-447"><a href="#GeoSet.to_datetime-447"><span class="linenos">447</span></a><span class="sd">        ---------</span>
</span><span id="GeoSet.to_datetime-448"><a href="#GeoSet.to_datetime-448"><span class="linenos">448</span></a><span class="sd">        input_type : string</span>
</span><span id="GeoSet.to_datetime-449"><a href="#GeoSet.to_datetime-449"><span class="linenos">449</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="GeoSet.to_datetime-450"><a href="#GeoSet.to_datetime-450"><span class="linenos">450</span></a><span class="sd">            </span>
</span><span id="GeoSet.to_datetime-451"><a href="#GeoSet.to_datetime-451"><span class="linenos">451</span></a><span class="sd">        Return</span>
</span><span id="GeoSet.to_datetime-452"><a href="#GeoSet.to_datetime-452"><span class="linenos">452</span></a><span class="sd">        ------</span>
</span><span id="GeoSet.to_datetime-453"><a href="#GeoSet.to_datetime-453"><span class="linenos">453</span></a><span class="sd">        converted : dataset</span>
</span><span id="GeoSet.to_datetime-454"><a href="#GeoSet.to_datetime-454"><span class="linenos">454</span></a><span class="sd">            new dataset with the time dimension in a standard pandas format</span>
</span><span id="GeoSet.to_datetime-455"><a href="#GeoSet.to_datetime-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.to_datetime-456"><a href="#GeoSet.to_datetime-456"><span class="linenos">456</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span></pre></div>


            <div class="docstring"><p>Convert dataset time format to standard pandas time format</p>

<h2 id="parameter">Parameter</h2>

<p>input_type : string
    Can be 'frac_year' or '360_day'</p>

<h2 id="return">Return</h2>

<p>converted : dataset
    new dataset with the time dimension in a standard pandas format</p>
</div>


                            </div>
                            <div id="GeoSet.fill_time" class="classattr">
                                        <input id="GeoSet.fill_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.fill_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.fill_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.fill_time-458"><a href="#GeoSet.fill_time-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoSet.fill_time-459"><a href="#GeoSet.fill_time-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.fill_time-460"><a href="#GeoSet.fill_time-460"><span class="linenos">460</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="GeoSet.fill_time-461"><a href="#GeoSet.fill_time-461"><span class="linenos">461</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="GeoSet.fill_time-462"><a href="#GeoSet.fill_time-462"><span class="linenos">462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.fill_time-463"><a href="#GeoSet.fill_time-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN
but real absent points in the timeseries. A linear interpolation is performed at the missing points.</p>
</div>


                            </div>
                            <div id="GeoSet.surface_cell" class="classattr">
                                        <input id="GeoSet.surface_cell-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">surface_cell</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoSet.surface_cell-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoSet.surface_cell"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoSet.surface_cell-465"><a href="#GeoSet.surface_cell-465"><span class="linenos">465</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoSet.surface_cell-466"><a href="#GeoSet.surface_cell-466"><span class="linenos">466</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoSet.surface_cell-467"><a href="#GeoSet.surface_cell-467"><span class="linenos">467</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="GeoSet.surface_cell-468"><a href="#GeoSet.surface_cell-468"><span class="linenos">468</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="GeoSet.surface_cell-469"><a href="#GeoSet.surface_cell-469"><span class="linenos">469</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="GeoSet.surface_cell-470"><a href="#GeoSet.surface_cell-470"><span class="linenos">470</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="GeoSet.surface_cell-471"><a href="#GeoSet.surface_cell-471"><span class="linenos">471</span></a>
</span><span id="GeoSet.surface_cell-472"><a href="#GeoSet.surface_cell-472"><span class="linenos">472</span></a><span class="sd">        Returns</span>
</span><span id="GeoSet.surface_cell-473"><a href="#GeoSet.surface_cell-473"><span class="linenos">473</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.surface_cell-474"><a href="#GeoSet.surface_cell-474"><span class="linenos">474</span></a><span class="sd">        surface : dataarray</span>
</span><span id="GeoSet.surface_cell-475"><a href="#GeoSet.surface_cell-475"><span class="linenos">475</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="GeoSet.surface_cell-476"><a href="#GeoSet.surface_cell-476"><span class="linenos">476</span></a>
</span><span id="GeoSet.surface_cell-477"><a href="#GeoSet.surface_cell-477"><span class="linenos">477</span></a><span class="sd">        Example</span>
</span><span id="GeoSet.surface_cell-478"><a href="#GeoSet.surface_cell-478"><span class="linenos">478</span></a><span class="sd">        -------</span>
</span><span id="GeoSet.surface_cell-479"><a href="#GeoSet.surface_cell-479"><span class="linenos">479</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoSet.surface_cell-480"><a href="#GeoSet.surface_cell-480"><span class="linenos">480</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="GeoSet.surface_cell-481"><a href="#GeoSet.surface_cell-481"><span class="linenos">481</span></a>
</span><span id="GeoSet.surface_cell-482"><a href="#GeoSet.surface_cell-482"><span class="linenos">482</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoSet.surface_cell-483"><a href="#GeoSet.surface_cell-483"><span class="linenos">483</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the earth surface of each cell defined by a longitude/latitude in a array
Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.
Border cells are supposed to have the same size on each side of the given coordinate.
Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</p>

<h2 id="returns">Returns</h2>

<p>surface : dataarray
    dataarray with cells surface</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc')
      surface = data.xgeo.surface_cell()</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                </section>
                <section id="GeoArray">
                            <input id="GeoArray-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@xr.register_dataarray_accessor(&#39;xgeo&#39;)</div>

    <span class="def">class</span>
    <span class="name">GeoArray</span>:

                <label class="view-source-button" for="GeoArray-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray-485"><a href="#GeoArray-485"><span class="linenos">485</span></a><span class="nd">@xr</span><span class="o">.</span><span class="n">register_dataarray_accessor</span><span class="p">(</span><span class="s2">&quot;xgeo&quot;</span><span class="p">)</span>
</span><span id="GeoArray-486"><a href="#GeoArray-486"><span class="linenos">486</span></a><span class="k">class</span> <span class="nc">GeoArray</span><span class="p">:</span>
</span><span id="GeoArray-487"><a href="#GeoArray-487"><span class="linenos">487</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="GeoArray-488"><a href="#GeoArray-488"><span class="linenos">488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span><span id="GeoArray-489"><a href="#GeoArray-489"><span class="linenos">489</span></a>        
</span><span id="GeoArray-490"><a href="#GeoArray-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-491"><a href="#GeoArray-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-492"><a href="#GeoArray-492"><span class="linenos">492</span></a><span class="sd">        Perform climato analysis on a dataarray</span>
</span><span id="GeoArray-493"><a href="#GeoArray-493"><span class="linenos">493</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="GeoArray-494"><a href="#GeoArray-494"><span class="linenos">494</span></a><span class="sd">            annual cycle</span>
</span><span id="GeoArray-495"><a href="#GeoArray-495"><span class="linenos">495</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="GeoArray-496"><a href="#GeoArray-496"><span class="linenos">496</span></a><span class="sd">            trend</span>
</span><span id="GeoArray-497"><a href="#GeoArray-497"><span class="linenos">497</span></a><span class="sd">            mean</span>
</span><span id="GeoArray-498"><a href="#GeoArray-498"><span class="linenos">498</span></a><span class="sd">            residual signal</span>
</span><span id="GeoArray-499"><a href="#GeoArray-499"><span class="linenos">499</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="GeoArray-500"><a href="#GeoArray-500"><span class="linenos">500</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="GeoArray-501"><a href="#GeoArray-501"><span class="linenos">501</span></a><span class="sd">        </span>
</span><span id="GeoArray-502"><a href="#GeoArray-502"><span class="linenos">502</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-503"><a href="#GeoArray-503"><span class="linenos">503</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-504"><a href="#GeoArray-504"><span class="linenos">504</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="GeoArray-505"><a href="#GeoArray-505"><span class="linenos">505</span></a><span class="sd">            returns residual signal</span>
</span><span id="GeoArray-506"><a href="#GeoArray-506"><span class="linenos">506</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="GeoArray-507"><a href="#GeoArray-507"><span class="linenos">507</span></a><span class="sd">            returns mean signal</span>
</span><span id="GeoArray-508"><a href="#GeoArray-508"><span class="linenos">508</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="GeoArray-509"><a href="#GeoArray-509"><span class="linenos">509</span></a><span class="sd">            returns trend</span>
</span><span id="GeoArray-510"><a href="#GeoArray-510"><span class="linenos">510</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="GeoArray-511"><a href="#GeoArray-511"><span class="linenos">511</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="GeoArray-512"><a href="#GeoArray-512"><span class="linenos">512</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="GeoArray-513"><a href="#GeoArray-513"><span class="linenos">513</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="GeoArray-514"><a href="#GeoArray-514"><span class="linenos">514</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="GeoArray-515"><a href="#GeoArray-515"><span class="linenos">515</span></a><span class="sd">            </span>
</span><span id="GeoArray-516"><a href="#GeoArray-516"><span class="linenos">516</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-517"><a href="#GeoArray-517"><span class="linenos">517</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-518"><a href="#GeoArray-518"><span class="linenos">518</span></a><span class="sd">        climato : dataarray</span>
</span><span id="GeoArray-519"><a href="#GeoArray-519"><span class="linenos">519</span></a><span class="sd">            a dataarray with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="GeoArray-520"><a href="#GeoArray-520"><span class="linenos">520</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="GeoArray-521"><a href="#GeoArray-521"><span class="linenos">521</span></a><span class="sd">        </span>
</span><span id="GeoArray-522"><a href="#GeoArray-522"><span class="linenos">522</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-523"><a href="#GeoArray-523"><span class="linenos">523</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-524"><a href="#GeoArray-524"><span class="linenos">524</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;).ohc</span>
</span><span id="GeoArray-525"><a href="#GeoArray-525"><span class="linenos">525</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="GeoArray-526"><a href="#GeoArray-526"><span class="linenos">526</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-527"><a href="#GeoArray-527"><span class="linenos">527</span></a>        <span class="k">return</span> <span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-528"><a href="#GeoArray-528"><span class="linenos">528</span></a>        
</span><span id="GeoArray-529"><a href="#GeoArray-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-530"><a href="#GeoArray-530"><span class="linenos">530</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-531"><a href="#GeoArray-531"><span class="linenos">531</span></a><span class="sd">        Returns the averaged value of dataarray along specified dimension, applying specified weights</span>
</span><span id="GeoArray-532"><a href="#GeoArray-532"><span class="linenos">532</span></a><span class="sd">        </span>
</span><span id="GeoArray-533"><a href="#GeoArray-533"><span class="linenos">533</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-534"><a href="#GeoArray-534"><span class="linenos">534</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-535"><a href="#GeoArray-535"><span class="linenos">535</span></a><span class="sd">        *args : list</span>
</span><span id="GeoArray-536"><a href="#GeoArray-536"><span class="linenos">536</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="GeoArray-537"><a href="#GeoArray-537"><span class="linenos">537</span></a><span class="sd">        </span>
</span><span id="GeoArray-538"><a href="#GeoArray-538"><span class="linenos">538</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoArray-539"><a href="#GeoArray-539"><span class="linenos">539</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoArray-540"><a href="#GeoArray-540"><span class="linenos">540</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoArray-541"><a href="#GeoArray-541"><span class="linenos">541</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoArray-542"><a href="#GeoArray-542"><span class="linenos">542</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoArray-543"><a href="#GeoArray-543"><span class="linenos">543</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="GeoArray-544"><a href="#GeoArray-544"><span class="linenos">544</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoArray-545"><a href="#GeoArray-545"><span class="linenos">545</span></a><span class="sd">            mask to be applyed before averaging</span>
</span><span id="GeoArray-546"><a href="#GeoArray-546"><span class="linenos">546</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="GeoArray-547"><a href="#GeoArray-547"><span class="linenos">547</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="GeoArray-548"><a href="#GeoArray-548"><span class="linenos">548</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoArray-549"><a href="#GeoArray-549"><span class="linenos">549</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="GeoArray-550"><a href="#GeoArray-550"><span class="linenos">550</span></a><span class="sd">            </span>
</span><span id="GeoArray-551"><a href="#GeoArray-551"><span class="linenos">551</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-552"><a href="#GeoArray-552"><span class="linenos">552</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-553"><a href="#GeoArray-553"><span class="linenos">553</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="GeoArray-554"><a href="#GeoArray-554"><span class="linenos">554</span></a><span class="sd">            dataarray averaged according to specified options</span>
</span><span id="GeoArray-555"><a href="#GeoArray-555"><span class="linenos">555</span></a><span class="sd">            </span>
</span><span id="GeoArray-556"><a href="#GeoArray-556"><span class="linenos">556</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-557"><a href="#GeoArray-557"><span class="linenos">557</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-558"><a href="#GeoArray-558"><span class="linenos">558</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray-559"><a href="#GeoArray-559"><span class="linenos">559</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="GeoArray-560"><a href="#GeoArray-560"><span class="linenos">560</span></a><span class="sd">            </span>
</span><span id="GeoArray-561"><a href="#GeoArray-561"><span class="linenos">561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-562"><a href="#GeoArray-562"><span class="linenos">562</span></a>        <span class="n">argmean</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="GeoArray-563"><a href="#GeoArray-563"><span class="linenos">563</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="GeoArray-564"><a href="#GeoArray-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="n">na_eq_zero</span><span class="p">:</span>
</span><span id="GeoArray-565"><a href="#GeoArray-565"><span class="linenos">565</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
</span><span id="GeoArray-566"><a href="#GeoArray-566"><span class="linenos">566</span></a>            
</span><span id="GeoArray-567"><a href="#GeoArray-567"><span class="linenos">567</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argmean</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="GeoArray-568"><a href="#GeoArray-568"><span class="linenos">568</span></a>            <span class="n">argmean</span><span class="o">=</span><span class="kc">None</span>
</span><span id="GeoArray-569"><a href="#GeoArray-569"><span class="linenos">569</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="GeoArray-570"><a href="#GeoArray-570"><span class="linenos">570</span></a>            <span class="c1"># Moyenne simple</span>
</span><span id="GeoArray-571"><a href="#GeoArray-571"><span class="linenos">571</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-572"><a href="#GeoArray-572"><span class="linenos">572</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="GeoArray-573"><a href="#GeoArray-573"><span class="linenos">573</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="GeoArray-574"><a href="#GeoArray-574"><span class="linenos">574</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray-575"><a href="#GeoArray-575"><span class="linenos">575</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="GeoArray-576"><a href="#GeoArray-576"><span class="linenos">576</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="GeoArray-577"><a href="#GeoArray-577"><span class="linenos">577</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray-578"><a href="#GeoArray-578"><span class="linenos">578</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="GeoArray-579"><a href="#GeoArray-579"><span class="linenos">579</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="GeoArray-580"><a href="#GeoArray-580"><span class="linenos">580</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-581"><a href="#GeoArray-581"><span class="linenos">581</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GeoArray-582"><a href="#GeoArray-582"><span class="linenos">582</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="GeoArray-583"><a href="#GeoArray-583"><span class="linenos">583</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-584"><a href="#GeoArray-584"><span class="linenos">584</span></a>    
</span><span id="GeoArray-585"><a href="#GeoArray-585"><span class="linenos">585</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-586"><a href="#GeoArray-586"><span class="linenos">586</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-587"><a href="#GeoArray-587"><span class="linenos">587</span></a><span class="sd">        Returns the sum of dataarray along specified dimension, applying specified weights</span>
</span><span id="GeoArray-588"><a href="#GeoArray-588"><span class="linenos">588</span></a><span class="sd">        </span>
</span><span id="GeoArray-589"><a href="#GeoArray-589"><span class="linenos">589</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-590"><a href="#GeoArray-590"><span class="linenos">590</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-591"><a href="#GeoArray-591"><span class="linenos">591</span></a><span class="sd">        *args : list</span>
</span><span id="GeoArray-592"><a href="#GeoArray-592"><span class="linenos">592</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="GeoArray-593"><a href="#GeoArray-593"><span class="linenos">593</span></a><span class="sd">        </span>
</span><span id="GeoArray-594"><a href="#GeoArray-594"><span class="linenos">594</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoArray-595"><a href="#GeoArray-595"><span class="linenos">595</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoArray-596"><a href="#GeoArray-596"><span class="linenos">596</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoArray-597"><a href="#GeoArray-597"><span class="linenos">597</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoArray-598"><a href="#GeoArray-598"><span class="linenos">598</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoArray-599"><a href="#GeoArray-599"><span class="linenos">599</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="GeoArray-600"><a href="#GeoArray-600"><span class="linenos">600</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoArray-601"><a href="#GeoArray-601"><span class="linenos">601</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="GeoArray-602"><a href="#GeoArray-602"><span class="linenos">602</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoArray-603"><a href="#GeoArray-603"><span class="linenos">603</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="GeoArray-604"><a href="#GeoArray-604"><span class="linenos">604</span></a><span class="sd">            </span>
</span><span id="GeoArray-605"><a href="#GeoArray-605"><span class="linenos">605</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-606"><a href="#GeoArray-606"><span class="linenos">606</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-607"><a href="#GeoArray-607"><span class="linenos">607</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="GeoArray-608"><a href="#GeoArray-608"><span class="linenos">608</span></a><span class="sd">            dataarray summed according to specified options</span>
</span><span id="GeoArray-609"><a href="#GeoArray-609"><span class="linenos">609</span></a><span class="sd">            </span>
</span><span id="GeoArray-610"><a href="#GeoArray-610"><span class="linenos">610</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-611"><a href="#GeoArray-611"><span class="linenos">611</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-612"><a href="#GeoArray-612"><span class="linenos">612</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).heat</span>
</span><span id="GeoArray-613"><a href="#GeoArray-613"><span class="linenos">613</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="GeoArray-614"><a href="#GeoArray-614"><span class="linenos">614</span></a><span class="sd">            </span>
</span><span id="GeoArray-615"><a href="#GeoArray-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>       
</span><span id="GeoArray-616"><a href="#GeoArray-616"><span class="linenos">616</span></a>        <span class="n">argsum</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="GeoArray-617"><a href="#GeoArray-617"><span class="linenos">617</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>        
</span><span id="GeoArray-618"><a href="#GeoArray-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="GeoArray-619"><a href="#GeoArray-619"><span class="linenos">619</span></a>            <span class="c1"># Somme simple</span>
</span><span id="GeoArray-620"><a href="#GeoArray-620"><span class="linenos">620</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-621"><a href="#GeoArray-621"><span class="linenos">621</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="GeoArray-622"><a href="#GeoArray-622"><span class="linenos">622</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="GeoArray-623"><a href="#GeoArray-623"><span class="linenos">623</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray-624"><a href="#GeoArray-624"><span class="linenos">624</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="GeoArray-625"><a href="#GeoArray-625"><span class="linenos">625</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="GeoArray-626"><a href="#GeoArray-626"><span class="linenos">626</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray-627"><a href="#GeoArray-627"><span class="linenos">627</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="GeoArray-628"><a href="#GeoArray-628"><span class="linenos">628</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="GeoArray-629"><a href="#GeoArray-629"><span class="linenos">629</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-630"><a href="#GeoArray-630"><span class="linenos">630</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GeoArray-631"><a href="#GeoArray-631"><span class="linenos">631</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="GeoArray-632"><a href="#GeoArray-632"><span class="linenos">632</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-633"><a href="#GeoArray-633"><span class="linenos">633</span></a>    
</span><span id="GeoArray-634"><a href="#GeoArray-634"><span class="linenos">634</span></a>
</span><span id="GeoArray-635"><a href="#GeoArray-635"><span class="linenos">635</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>   
</span><span id="GeoArray-636"><a href="#GeoArray-636"><span class="linenos">636</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-637"><a href="#GeoArray-637"><span class="linenos">637</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the target.</span>
</span><span id="GeoArray-638"><a href="#GeoArray-638"><span class="linenos">638</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="GeoArray-639"><a href="#GeoArray-639"><span class="linenos">639</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="GeoArray-640"><a href="#GeoArray-640"><span class="linenos">640</span></a><span class="sd">        </span>
</span><span id="GeoArray-641"><a href="#GeoArray-641"><span class="linenos">641</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-642"><a href="#GeoArray-642"><span class="linenos">642</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-643"><a href="#GeoArray-643"><span class="linenos">643</span></a><span class="sd">        target : float</span>
</span><span id="GeoArray-644"><a href="#GeoArray-644"><span class="linenos">644</span></a><span class="sd">            criterion value to be satisfied at the iso surface</span>
</span><span id="GeoArray-645"><a href="#GeoArray-645"><span class="linenos">645</span></a><span class="sd">        dim : string</span>
</span><span id="GeoArray-646"><a href="#GeoArray-646"><span class="linenos">646</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="GeoArray-647"><a href="#GeoArray-647"><span class="linenos">647</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="GeoArray-648"><a href="#GeoArray-648"><span class="linenos">648</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="GeoArray-649"><a href="#GeoArray-649"><span class="linenos">649</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="GeoArray-650"><a href="#GeoArray-650"><span class="linenos">650</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="GeoArray-651"><a href="#GeoArray-651"><span class="linenos">651</span></a><span class="sd">            </span>
</span><span id="GeoArray-652"><a href="#GeoArray-652"><span class="linenos">652</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-653"><a href="#GeoArray-653"><span class="linenos">653</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-654"><a href="#GeoArray-654"><span class="linenos">654</span></a><span class="sd">        isosurface : dataarray</span>
</span><span id="GeoArray-655"><a href="#GeoArray-655"><span class="linenos">655</span></a><span class="sd">            Dataarray containing the isosurface along the dimension dim on which data=target.</span>
</span><span id="GeoArray-656"><a href="#GeoArray-656"><span class="linenos">656</span></a><span class="sd">                </span>
</span><span id="GeoArray-657"><a href="#GeoArray-657"><span class="linenos">657</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-658"><a href="#GeoArray-658"><span class="linenos">658</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-659"><a href="#GeoArray-659"><span class="linenos">659</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray-660"><a href="#GeoArray-660"><span class="linenos">660</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(3,&#39;depth&#39;)</span>
</span><span id="GeoArray-661"><a href="#GeoArray-661"><span class="linenos">661</span></a><span class="sd">        &lt;xarray.DataArray (latitude: 90, longitude: 180)&gt;</span>
</span><span id="GeoArray-662"><a href="#GeoArray-662"><span class="linenos">662</span></a><span class="sd">        dask.array&lt;_nanmax_skip-aggregate, shape=(90, 180), dtype=float64, chunksize=(90, 180), chunktype=numpy.ndarray&gt;</span>
</span><span id="GeoArray-663"><a href="#GeoArray-663"><span class="linenos">663</span></a><span class="sd">        Coordinates:</span>
</span><span id="GeoArray-664"><a href="#GeoArray-664"><span class="linenos">664</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="GeoArray-665"><a href="#GeoArray-665"><span class="linenos">665</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="GeoArray-666"><a href="#GeoArray-666"><span class="linenos">666</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="GeoArray-667"><a href="#GeoArray-667"><span class="linenos">667</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray-668"><a href="#GeoArray-668"><span class="linenos">668</span></a>        <span class="k">return</span> <span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span><span id="GeoArray-669"><a href="#GeoArray-669"><span class="linenos">669</span></a>
</span><span id="GeoArray-670"><a href="#GeoArray-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-671"><a href="#GeoArray-671"><span class="linenos">671</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-672"><a href="#GeoArray-672"><span class="linenos">672</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataarray </span>
</span><span id="GeoArray-673"><a href="#GeoArray-673"><span class="linenos">673</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="GeoArray-674"><a href="#GeoArray-674"><span class="linenos">674</span></a>
</span><span id="GeoArray-675"><a href="#GeoArray-675"><span class="linenos">675</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-676"><a href="#GeoArray-676"><span class="linenos">676</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-677"><a href="#GeoArray-677"><span class="linenos">677</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="GeoArray-678"><a href="#GeoArray-678"><span class="linenos">678</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="GeoArray-679"><a href="#GeoArray-679"><span class="linenos">679</span></a><span class="sd">        *args : </span>
</span><span id="GeoArray-680"><a href="#GeoArray-680"><span class="linenos">680</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="GeoArray-681"><a href="#GeoArray-681"><span class="linenos">681</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="GeoArray-682"><a href="#GeoArray-682"><span class="linenos">682</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="GeoArray-683"><a href="#GeoArray-683"><span class="linenos">683</span></a><span class="sd">        method : str</span>
</span><span id="GeoArray-684"><a href="#GeoArray-684"><span class="linenos">684</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="GeoArray-685"><a href="#GeoArray-685"><span class="linenos">685</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoArray-686"><a href="#GeoArray-686"><span class="linenos">686</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="GeoArray-687"><a href="#GeoArray-687"><span class="linenos">687</span></a>
</span><span id="GeoArray-688"><a href="#GeoArray-688"><span class="linenos">688</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-689"><a href="#GeoArray-689"><span class="linenos">689</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-690"><a href="#GeoArray-690"><span class="linenos">690</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoArray-691"><a href="#GeoArray-691"><span class="linenos">691</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoArray-692"><a href="#GeoArray-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-693"><a href="#GeoArray-693"><span class="linenos">693</span></a>
</span><span id="GeoArray-694"><a href="#GeoArray-694"><span class="linenos">694</span></a>        <span class="n">ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">})</span>
</span><span id="GeoArray-695"><a href="#GeoArray-695"><span class="linenos">695</span></a>        <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">regridder</span><span class="p">(</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="n">mask_in</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-696"><a href="#GeoArray-696"><span class="linenos">696</span></a>    
</span><span id="GeoArray-697"><a href="#GeoArray-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-698"><a href="#GeoArray-698"><span class="linenos">698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-699"><a href="#GeoArray-699"><span class="linenos">699</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoArray-700"><a href="#GeoArray-700"><span class="linenos">700</span></a>
</span><span id="GeoArray-701"><a href="#GeoArray-701"><span class="linenos">701</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-702"><a href="#GeoArray-702"><span class="linenos">702</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-703"><a href="#GeoArray-703"><span class="linenos">703</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoArray-704"><a href="#GeoArray-704"><span class="linenos">704</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="GeoArray-705"><a href="#GeoArray-705"><span class="linenos">705</span></a>
</span><span id="GeoArray-706"><a href="#GeoArray-706"><span class="linenos">706</span></a><span class="sd">        *args : </span>
</span><span id="GeoArray-707"><a href="#GeoArray-707"><span class="linenos">707</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="GeoArray-708"><a href="#GeoArray-708"><span class="linenos">708</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoArray-709"><a href="#GeoArray-709"><span class="linenos">709</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="GeoArray-710"><a href="#GeoArray-710"><span class="linenos">710</span></a>
</span><span id="GeoArray-711"><a href="#GeoArray-711"><span class="linenos">711</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-712"><a href="#GeoArray-712"><span class="linenos">712</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-713"><a href="#GeoArray-713"><span class="linenos">713</span></a><span class="sd">        regrid : dataset</span>
</span><span id="GeoArray-714"><a href="#GeoArray-714"><span class="linenos">714</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="GeoArray-715"><a href="#GeoArray-715"><span class="linenos">715</span></a>
</span><span id="GeoArray-716"><a href="#GeoArray-716"><span class="linenos">716</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-717"><a href="#GeoArray-717"><span class="linenos">717</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-718"><a href="#GeoArray-718"><span class="linenos">718</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="GeoArray-719"><a href="#GeoArray-719"><span class="linenos">719</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="GeoArray-720"><a href="#GeoArray-720"><span class="linenos">720</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="GeoArray-721"><a href="#GeoArray-721"><span class="linenos">721</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="GeoArray-722"><a href="#GeoArray-722"><span class="linenos">722</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray-723"><a href="#GeoArray-723"><span class="linenos">723</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-724"><a href="#GeoArray-724"><span class="linenos">724</span></a>
</span><span id="GeoArray-725"><a href="#GeoArray-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-726"><a href="#GeoArray-726"><span class="linenos">726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-727"><a href="#GeoArray-727"><span class="linenos">727</span></a><span class="sd">        Apply a specified filter on all the time-dependent datarray</span>
</span><span id="GeoArray-728"><a href="#GeoArray-728"><span class="linenos">728</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="GeoArray-729"><a href="#GeoArray-729"><span class="linenos">729</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="GeoArray-730"><a href="#GeoArray-730"><span class="linenos">730</span></a><span class="sd">        </span>
</span><span id="GeoArray-731"><a href="#GeoArray-731"><span class="linenos">731</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray-732"><a href="#GeoArray-732"><span class="linenos">732</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray-733"><a href="#GeoArray-733"><span class="linenos">733</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="GeoArray-734"><a href="#GeoArray-734"><span class="linenos">734</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="GeoArray-735"><a href="#GeoArray-735"><span class="linenos">735</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="GeoArray-736"><a href="#GeoArray-736"><span class="linenos">736</span></a><span class="sd">        q : int</span>
</span><span id="GeoArray-737"><a href="#GeoArray-737"><span class="linenos">737</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="GeoArray-738"><a href="#GeoArray-738"><span class="linenos">738</span></a><span class="sd">        **kwargs :</span>
</span><span id="GeoArray-739"><a href="#GeoArray-739"><span class="linenos">739</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="GeoArray-740"><a href="#GeoArray-740"><span class="linenos">740</span></a><span class="sd">            </span>
</span><span id="GeoArray-741"><a href="#GeoArray-741"><span class="linenos">741</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-742"><a href="#GeoArray-742"><span class="linenos">742</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-743"><a href="#GeoArray-743"><span class="linenos">743</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="GeoArray-744"><a href="#GeoArray-744"><span class="linenos">744</span></a><span class="sd">        </span>
</span><span id="GeoArray-745"><a href="#GeoArray-745"><span class="linenos">745</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-746"><a href="#GeoArray-746"><span class="linenos">746</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-747"><a href="#GeoArray-747"><span class="linenos">747</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray-748"><a href="#GeoArray-748"><span class="linenos">748</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="GeoArray-749"><a href="#GeoArray-749"><span class="linenos">749</span></a><span class="sd">        </span>
</span><span id="GeoArray-750"><a href="#GeoArray-750"><span class="linenos">750</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray-751"><a href="#GeoArray-751"><span class="linenos">751</span></a>        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-752"><a href="#GeoArray-752"><span class="linenos">752</span></a>    
</span><span id="GeoArray-753"><a href="#GeoArray-753"><span class="linenos">753</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-754"><a href="#GeoArray-754"><span class="linenos">754</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-755"><a href="#GeoArray-755"><span class="linenos">755</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="GeoArray-756"><a href="#GeoArray-756"><span class="linenos">756</span></a><span class="sd">        </span>
</span><span id="GeoArray-757"><a href="#GeoArray-757"><span class="linenos">757</span></a><span class="sd">        Parameter</span>
</span><span id="GeoArray-758"><a href="#GeoArray-758"><span class="linenos">758</span></a><span class="sd">        ---------</span>
</span><span id="GeoArray-759"><a href="#GeoArray-759"><span class="linenos">759</span></a><span class="sd">        other : dataarray</span>
</span><span id="GeoArray-760"><a href="#GeoArray-760"><span class="linenos">760</span></a><span class="sd">            must have a time dimension</span>
</span><span id="GeoArray-761"><a href="#GeoArray-761"><span class="linenos">761</span></a><span class="sd">            </span>
</span><span id="GeoArray-762"><a href="#GeoArray-762"><span class="linenos">762</span></a><span class="sd">        Return</span>
</span><span id="GeoArray-763"><a href="#GeoArray-763"><span class="linenos">763</span></a><span class="sd">        ------</span>
</span><span id="GeoArray-764"><a href="#GeoArray-764"><span class="linenos">764</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="GeoArray-765"><a href="#GeoArray-765"><span class="linenos">765</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="GeoArray-766"><a href="#GeoArray-766"><span class="linenos">766</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray-767"><a href="#GeoArray-767"><span class="linenos">767</span></a>        <span class="k">return</span> <span class="n">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-768"><a href="#GeoArray-768"><span class="linenos">768</span></a>    
</span><span id="GeoArray-769"><a href="#GeoArray-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="nf">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray-770"><a href="#GeoArray-770"><span class="linenos">770</span></a>        <span class="n">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray-771"><a href="#GeoArray-771"><span class="linenos">771</span></a>        
</span><span id="GeoArray-772"><a href="#GeoArray-772"><span class="linenos">772</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="GeoArray-773"><a href="#GeoArray-773"><span class="linenos">773</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-774"><a href="#GeoArray-774"><span class="linenos">774</span></a><span class="sd">        Convert dataarray time format to standard pandas time format</span>
</span><span id="GeoArray-775"><a href="#GeoArray-775"><span class="linenos">775</span></a><span class="sd">        </span>
</span><span id="GeoArray-776"><a href="#GeoArray-776"><span class="linenos">776</span></a><span class="sd">        Parameter</span>
</span><span id="GeoArray-777"><a href="#GeoArray-777"><span class="linenos">777</span></a><span class="sd">        ---------</span>
</span><span id="GeoArray-778"><a href="#GeoArray-778"><span class="linenos">778</span></a><span class="sd">        input_type : string</span>
</span><span id="GeoArray-779"><a href="#GeoArray-779"><span class="linenos">779</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="GeoArray-780"><a href="#GeoArray-780"><span class="linenos">780</span></a><span class="sd">            </span>
</span><span id="GeoArray-781"><a href="#GeoArray-781"><span class="linenos">781</span></a><span class="sd">        Return</span>
</span><span id="GeoArray-782"><a href="#GeoArray-782"><span class="linenos">782</span></a><span class="sd">        ------</span>
</span><span id="GeoArray-783"><a href="#GeoArray-783"><span class="linenos">783</span></a><span class="sd">        converted : dataarray</span>
</span><span id="GeoArray-784"><a href="#GeoArray-784"><span class="linenos">784</span></a><span class="sd">            new dataarray with the time dimension in a standard pandas format</span>
</span><span id="GeoArray-785"><a href="#GeoArray-785"><span class="linenos">785</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-786"><a href="#GeoArray-786"><span class="linenos">786</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span><span id="GeoArray-787"><a href="#GeoArray-787"><span class="linenos">787</span></a>
</span><span id="GeoArray-788"><a href="#GeoArray-788"><span class="linenos">788</span></a>    <span class="k">def</span> <span class="nf">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
</span><span id="GeoArray-789"><a href="#GeoArray-789"><span class="linenos">789</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-790"><a href="#GeoArray-790"><span class="linenos">790</span></a><span class="sd">        Derivative formula along the selected dimension, returning on each point the linear regression on the three points</span>
</span><span id="GeoArray-791"><a href="#GeoArray-791"><span class="linenos">791</span></a><span class="sd">        defined by the selected point and its two neighbours</span>
</span><span id="GeoArray-792"><a href="#GeoArray-792"><span class="linenos">792</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-793"><a href="#GeoArray-793"><span class="linenos">793</span></a>        <span class="k">return</span> <span class="n">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dim</span><span class="p">)</span>
</span><span id="GeoArray-794"><a href="#GeoArray-794"><span class="linenos">794</span></a>
</span><span id="GeoArray-795"><a href="#GeoArray-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">):</span>
</span><span id="GeoArray-796"><a href="#GeoArray-796"><span class="linenos">796</span></a>        <span class="n">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">)</span>
</span><span id="GeoArray-797"><a href="#GeoArray-797"><span class="linenos">797</span></a>
</span><span id="GeoArray-798"><a href="#GeoArray-798"><span class="linenos">798</span></a>    <span class="k">def</span> <span class="nf">trend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray-799"><a href="#GeoArray-799"><span class="linenos">799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-800"><a href="#GeoArray-800"><span class="linenos">800</span></a><span class="sd">        Perform a linear regression on the data, and returns the slope coefficient</span>
</span><span id="GeoArray-801"><a href="#GeoArray-801"><span class="linenos">801</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-802"><a href="#GeoArray-802"><span class="linenos">802</span></a>        <span class="k">return</span> <span class="n">trend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="GeoArray-803"><a href="#GeoArray-803"><span class="linenos">803</span></a>    
</span><span id="GeoArray-804"><a href="#GeoArray-804"><span class="linenos">804</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray-805"><a href="#GeoArray-805"><span class="linenos">805</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-806"><a href="#GeoArray-806"><span class="linenos">806</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="GeoArray-807"><a href="#GeoArray-807"><span class="linenos">807</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="GeoArray-808"><a href="#GeoArray-808"><span class="linenos">808</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-809"><a href="#GeoArray-809"><span class="linenos">809</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span><span id="GeoArray-810"><a href="#GeoArray-810"><span class="linenos">810</span></a>    
</span><span id="GeoArray-811"><a href="#GeoArray-811"><span class="linenos">811</span></a>
</span><span id="GeoArray-812"><a href="#GeoArray-812"><span class="linenos">812</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray-813"><a href="#GeoArray-813"><span class="linenos">813</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray-814"><a href="#GeoArray-814"><span class="linenos">814</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="GeoArray-815"><a href="#GeoArray-815"><span class="linenos">815</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="GeoArray-816"><a href="#GeoArray-816"><span class="linenos">816</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="GeoArray-817"><a href="#GeoArray-817"><span class="linenos">817</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="GeoArray-818"><a href="#GeoArray-818"><span class="linenos">818</span></a>
</span><span id="GeoArray-819"><a href="#GeoArray-819"><span class="linenos">819</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray-820"><a href="#GeoArray-820"><span class="linenos">820</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-821"><a href="#GeoArray-821"><span class="linenos">821</span></a><span class="sd">        surface : dataarray</span>
</span><span id="GeoArray-822"><a href="#GeoArray-822"><span class="linenos">822</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="GeoArray-823"><a href="#GeoArray-823"><span class="linenos">823</span></a>
</span><span id="GeoArray-824"><a href="#GeoArray-824"><span class="linenos">824</span></a><span class="sd">        Example</span>
</span><span id="GeoArray-825"><a href="#GeoArray-825"><span class="linenos">825</span></a><span class="sd">        -------</span>
</span><span id="GeoArray-826"><a href="#GeoArray-826"><span class="linenos">826</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoArray-827"><a href="#GeoArray-827"><span class="linenos">827</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="GeoArray-828"><a href="#GeoArray-828"><span class="linenos">828</span></a>
</span><span id="GeoArray-829"><a href="#GeoArray-829"><span class="linenos">829</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray-830"><a href="#GeoArray-830"><span class="linenos">830</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


    

                            <div id="GeoArray.__init__" class="classattr">
                                        <input id="GeoArray.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">GeoArray</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">xarray_obj</span></span>)</span>

                <label class="view-source-button" for="GeoArray.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.__init__-487"><a href="#GeoArray.__init__-487"><span class="linenos">487</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xarray_obj</span><span class="p">):</span>
</span><span id="GeoArray.__init__-488"><a href="#GeoArray.__init__-488"><span class="linenos">488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">xarray_obj</span>
</span></pre></div>


    

                            </div>
                            <div id="GeoArray.climato" class="classattr">
                                        <input id="GeoArray.climato-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">climato</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.climato-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.climato"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.climato-490"><a href="#GeoArray.climato-490"><span class="linenos">490</span></a>    <span class="k">def</span> <span class="nf">climato</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.climato-491"><a href="#GeoArray.climato-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.climato-492"><a href="#GeoArray.climato-492"><span class="linenos">492</span></a><span class="sd">        Perform climato analysis on a dataarray</span>
</span><span id="GeoArray.climato-493"><a href="#GeoArray.climato-493"><span class="linenos">493</span></a><span class="sd">        Input data are decomposed into :</span>
</span><span id="GeoArray.climato-494"><a href="#GeoArray.climato-494"><span class="linenos">494</span></a><span class="sd">            annual cycle</span>
</span><span id="GeoArray.climato-495"><a href="#GeoArray.climato-495"><span class="linenos">495</span></a><span class="sd">            semi-annual cycle</span>
</span><span id="GeoArray.climato-496"><a href="#GeoArray.climato-496"><span class="linenos">496</span></a><span class="sd">            trend</span>
</span><span id="GeoArray.climato-497"><a href="#GeoArray.climato-497"><span class="linenos">497</span></a><span class="sd">            mean</span>
</span><span id="GeoArray.climato-498"><a href="#GeoArray.climato-498"><span class="linenos">498</span></a><span class="sd">            residual signal</span>
</span><span id="GeoArray.climato-499"><a href="#GeoArray.climato-499"><span class="linenos">499</span></a><span class="sd">        The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)</span>
</span><span id="GeoArray.climato-500"><a href="#GeoArray.climato-500"><span class="linenos">500</span></a><span class="sd">        If return_coeffs=True, the coefficients of the decompositions are returned</span>
</span><span id="GeoArray.climato-501"><a href="#GeoArray.climato-501"><span class="linenos">501</span></a><span class="sd">        </span>
</span><span id="GeoArray.climato-502"><a href="#GeoArray.climato-502"><span class="linenos">502</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.climato-503"><a href="#GeoArray.climato-503"><span class="linenos">503</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.climato-504"><a href="#GeoArray.climato-504"><span class="linenos">504</span></a><span class="sd">        signal : Bool (default=True)</span>
</span><span id="GeoArray.climato-505"><a href="#GeoArray.climato-505"><span class="linenos">505</span></a><span class="sd">            returns residual signal</span>
</span><span id="GeoArray.climato-506"><a href="#GeoArray.climato-506"><span class="linenos">506</span></a><span class="sd">        mean : Bool (default=True)</span>
</span><span id="GeoArray.climato-507"><a href="#GeoArray.climato-507"><span class="linenos">507</span></a><span class="sd">            returns mean signal</span>
</span><span id="GeoArray.climato-508"><a href="#GeoArray.climato-508"><span class="linenos">508</span></a><span class="sd">        trend : Bool (default=True)</span>
</span><span id="GeoArray.climato-509"><a href="#GeoArray.climato-509"><span class="linenos">509</span></a><span class="sd">            returns trend</span>
</span><span id="GeoArray.climato-510"><a href="#GeoArray.climato-510"><span class="linenos">510</span></a><span class="sd">        cycle : Bool (default=False)</span>
</span><span id="GeoArray.climato-511"><a href="#GeoArray.climato-511"><span class="linenos">511</span></a><span class="sd">            return annual and semi-annual cycles</span>
</span><span id="GeoArray.climato-512"><a href="#GeoArray.climato-512"><span class="linenos">512</span></a><span class="sd">        return_coeffs : Bool (default=False)</span>
</span><span id="GeoArray.climato-513"><a href="#GeoArray.climato-513"><span class="linenos">513</span></a><span class="sd">            returns cycle coefficient, mean and trend</span>
</span><span id="GeoArray.climato-514"><a href="#GeoArray.climato-514"><span class="linenos">514</span></a><span class="sd">            retourne en plus les coefficients des cycles et de la tendance linaire</span>
</span><span id="GeoArray.climato-515"><a href="#GeoArray.climato-515"><span class="linenos">515</span></a><span class="sd">            </span>
</span><span id="GeoArray.climato-516"><a href="#GeoArray.climato-516"><span class="linenos">516</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.climato-517"><a href="#GeoArray.climato-517"><span class="linenos">517</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.climato-518"><a href="#GeoArray.climato-518"><span class="linenos">518</span></a><span class="sd">        climato : dataarray</span>
</span><span id="GeoArray.climato-519"><a href="#GeoArray.climato-519"><span class="linenos">519</span></a><span class="sd">            a dataarray with the same structure as the input, with modified data according to the chosen options</span>
</span><span id="GeoArray.climato-520"><a href="#GeoArray.climato-520"><span class="linenos">520</span></a><span class="sd">        if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</span>
</span><span id="GeoArray.climato-521"><a href="#GeoArray.climato-521"><span class="linenos">521</span></a><span class="sd">        </span>
</span><span id="GeoArray.climato-522"><a href="#GeoArray.climato-522"><span class="linenos">522</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.climato-523"><a href="#GeoArray.climato-523"><span class="linenos">523</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.climato-524"><a href="#GeoArray.climato-524"><span class="linenos">524</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;).ohc</span>
</span><span id="GeoArray.climato-525"><a href="#GeoArray.climato-525"><span class="linenos">525</span></a><span class="sd">        &gt;&gt;&gt;output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</span>
</span><span id="GeoArray.climato-526"><a href="#GeoArray.climato-526"><span class="linenos">526</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.climato-527"><a href="#GeoArray.climato-527"><span class="linenos">527</span></a>        <span class="k">return</span> <span class="n">climato</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform climato analysis on a dataarray
Input data are decomposed into :
    annual cycle
    semi-annual cycle
    trend
    mean
    residual signal
The returned data are a combination of these elements depending on passed arguments (signal, mean, trend, cycle)
If return_coeffs=True, the coefficients of the decompositions are returned</p>

<h2 id="parameters">Parameters</h2>

<p>signal : Bool (default=True)
    returns residual signal
mean : Bool (default=True)
    returns mean signal
trend : Bool (default=True)
    returns trend
cycle : Bool (default=False)
    return annual and semi-annual cycles
return_coeffs : Bool (default=False)
    returns cycle coefficient, mean and trend
    retourne en plus les coefficients des cycles et de la tendance linaire</p>

<h2 id="returns">Returns</h2>

<p>climato : dataarray
    a dataarray with the same structure as the input, with modified data according to the chosen options
if return_coeffs=True, an extra dataset is provided with the coefficients of the decomposition</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc').ohc
      output,coeffs = data.xgeo.climato(mean=True, trend=True, signal=True,return_coeffs=True)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoArray.mean" class="classattr">
                                        <input id="GeoArray.mean-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mean</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">weights</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">mask</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.mean-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.mean"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.mean-529"><a href="#GeoArray.mean-529"><span class="linenos">529</span></a>    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">na_eq_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.mean-530"><a href="#GeoArray.mean-530"><span class="linenos">530</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.mean-531"><a href="#GeoArray.mean-531"><span class="linenos">531</span></a><span class="sd">        Returns the averaged value of dataarray along specified dimension, applying specified weights</span>
</span><span id="GeoArray.mean-532"><a href="#GeoArray.mean-532"><span class="linenos">532</span></a><span class="sd">        </span>
</span><span id="GeoArray.mean-533"><a href="#GeoArray.mean-533"><span class="linenos">533</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.mean-534"><a href="#GeoArray.mean-534"><span class="linenos">534</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.mean-535"><a href="#GeoArray.mean-535"><span class="linenos">535</span></a><span class="sd">        *args : list</span>
</span><span id="GeoArray.mean-536"><a href="#GeoArray.mean-536"><span class="linenos">536</span></a><span class="sd">            list of the dimensions along which to average</span>
</span><span id="GeoArray.mean-537"><a href="#GeoArray.mean-537"><span class="linenos">537</span></a><span class="sd">        </span>
</span><span id="GeoArray.mean-538"><a href="#GeoArray.mean-538"><span class="linenos">538</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoArray.mean-539"><a href="#GeoArray.mean-539"><span class="linenos">539</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoArray.mean-540"><a href="#GeoArray.mean-540"><span class="linenos">540</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoArray.mean-541"><a href="#GeoArray.mean-541"><span class="linenos">541</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoArray.mean-542"><a href="#GeoArray.mean-542"><span class="linenos">542</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoArray.mean-543"><a href="#GeoArray.mean-543"><span class="linenos">543</span></a><span class="sd">                    input data are multiplied by this dataarray before averaging</span>
</span><span id="GeoArray.mean-544"><a href="#GeoArray.mean-544"><span class="linenos">544</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoArray.mean-545"><a href="#GeoArray.mean-545"><span class="linenos">545</span></a><span class="sd">            mask to be applyed before averaging</span>
</span><span id="GeoArray.mean-546"><a href="#GeoArray.mean-546"><span class="linenos">546</span></a><span class="sd">        na_eq_zero : boolean (default=False)</span>
</span><span id="GeoArray.mean-547"><a href="#GeoArray.mean-547"><span class="linenos">547</span></a><span class="sd">            replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones</span>
</span><span id="GeoArray.mean-548"><a href="#GeoArray.mean-548"><span class="linenos">548</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoArray.mean-549"><a href="#GeoArray.mean-549"><span class="linenos">549</span></a><span class="sd">            any keyword arguments passe to the native xarray.mean function</span>
</span><span id="GeoArray.mean-550"><a href="#GeoArray.mean-550"><span class="linenos">550</span></a><span class="sd">            </span>
</span><span id="GeoArray.mean-551"><a href="#GeoArray.mean-551"><span class="linenos">551</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.mean-552"><a href="#GeoArray.mean-552"><span class="linenos">552</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.mean-553"><a href="#GeoArray.mean-553"><span class="linenos">553</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="GeoArray.mean-554"><a href="#GeoArray.mean-554"><span class="linenos">554</span></a><span class="sd">            dataarray averaged according to specified options</span>
</span><span id="GeoArray.mean-555"><a href="#GeoArray.mean-555"><span class="linenos">555</span></a><span class="sd">            </span>
</span><span id="GeoArray.mean-556"><a href="#GeoArray.mean-556"><span class="linenos">556</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.mean-557"><a href="#GeoArray.mean-557"><span class="linenos">557</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.mean-558"><a href="#GeoArray.mean-558"><span class="linenos">558</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray.mean-559"><a href="#GeoArray.mean-559"><span class="linenos">559</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.mean([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;],na_eq_zero=True)</span>
</span><span id="GeoArray.mean-560"><a href="#GeoArray.mean-560"><span class="linenos">560</span></a><span class="sd">            </span>
</span><span id="GeoArray.mean-561"><a href="#GeoArray.mean-561"><span class="linenos">561</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.mean-562"><a href="#GeoArray.mean-562"><span class="linenos">562</span></a>        <span class="n">argmean</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="GeoArray.mean-563"><a href="#GeoArray.mean-563"><span class="linenos">563</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</span><span id="GeoArray.mean-564"><a href="#GeoArray.mean-564"><span class="linenos">564</span></a>        <span class="k">if</span> <span class="n">na_eq_zero</span><span class="p">:</span>
</span><span id="GeoArray.mean-565"><a href="#GeoArray.mean-565"><span class="linenos">565</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
</span><span id="GeoArray.mean-566"><a href="#GeoArray.mean-566"><span class="linenos">566</span></a>            
</span><span id="GeoArray.mean-567"><a href="#GeoArray.mean-567"><span class="linenos">567</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argmean</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span><span id="GeoArray.mean-568"><a href="#GeoArray.mean-568"><span class="linenos">568</span></a>            <span class="n">argmean</span><span class="o">=</span><span class="kc">None</span>
</span><span id="GeoArray.mean-569"><a href="#GeoArray.mean-569"><span class="linenos">569</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="GeoArray.mean-570"><a href="#GeoArray.mean-570"><span class="linenos">570</span></a>            <span class="c1"># Moyenne simple</span>
</span><span id="GeoArray.mean-571"><a href="#GeoArray.mean-571"><span class="linenos">571</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray.mean-572"><a href="#GeoArray.mean-572"><span class="linenos">572</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="GeoArray.mean-573"><a href="#GeoArray.mean-573"><span class="linenos">573</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="GeoArray.mean-574"><a href="#GeoArray.mean-574"><span class="linenos">574</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray.mean-575"><a href="#GeoArray.mean-575"><span class="linenos">575</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="GeoArray.mean-576"><a href="#GeoArray.mean-576"><span class="linenos">576</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="GeoArray.mean-577"><a href="#GeoArray.mean-577"><span class="linenos">577</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray.mean-578"><a href="#GeoArray.mean-578"><span class="linenos">578</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="GeoArray.mean-579"><a href="#GeoArray.mean-579"><span class="linenos">579</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="GeoArray.mean-580"><a href="#GeoArray.mean-580"><span class="linenos">580</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray.mean-581"><a href="#GeoArray.mean-581"><span class="linenos">581</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GeoArray.mean-582"><a href="#GeoArray.mean-582"><span class="linenos">582</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="GeoArray.mean-583"><a href="#GeoArray.mean-583"><span class="linenos">583</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">argmean</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the averaged value of dataarray along specified dimension, applying specified weights</p>

<h2 id="parameters">Parameters</h2>

<p>*args : list
    list of the dimensions along which to average</p>

<p>weights : None or list or dataarray
    if None, no weight is applyed
    if 'latitude' or 'depth', a weight is applyed as the cosine of the latitude or 
            the thickness of the layer
    if dataarray :
            input data are multiplied by this dataarray before averaging
mask : None or dataarray
    mask to be applyed before averaging
na_eq_zero : boolean (default=False)
    replace NaN values by zeros. The averaging is then applyed on all data, and not only valid ones
**kwargs : keyword arguments
    any keyword arguments passe to the native xarray.mean function</p>

<h2 id="returns">Returns</h2>

<p>averaged : dataarray
    dataarray averaged according to specified options</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc').temp
      avg = data.xgeo.mean(['latitude','longitude'],weights=['latitude'],na_eq_zero=True)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoArray.sum" class="classattr">
                                        <input id="GeoArray.sum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sum</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">weights</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">mask</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.sum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.sum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.sum-585"><a href="#GeoArray.sum-585"><span class="linenos">585</span></a>    <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.sum-586"><a href="#GeoArray.sum-586"><span class="linenos">586</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.sum-587"><a href="#GeoArray.sum-587"><span class="linenos">587</span></a><span class="sd">        Returns the sum of dataarray along specified dimension, applying specified weights</span>
</span><span id="GeoArray.sum-588"><a href="#GeoArray.sum-588"><span class="linenos">588</span></a><span class="sd">        </span>
</span><span id="GeoArray.sum-589"><a href="#GeoArray.sum-589"><span class="linenos">589</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.sum-590"><a href="#GeoArray.sum-590"><span class="linenos">590</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.sum-591"><a href="#GeoArray.sum-591"><span class="linenos">591</span></a><span class="sd">        *args : list</span>
</span><span id="GeoArray.sum-592"><a href="#GeoArray.sum-592"><span class="linenos">592</span></a><span class="sd">            list of the dimensions along which to sum</span>
</span><span id="GeoArray.sum-593"><a href="#GeoArray.sum-593"><span class="linenos">593</span></a><span class="sd">        </span>
</span><span id="GeoArray.sum-594"><a href="#GeoArray.sum-594"><span class="linenos">594</span></a><span class="sd">        weights : None or list or dataarray</span>
</span><span id="GeoArray.sum-595"><a href="#GeoArray.sum-595"><span class="linenos">595</span></a><span class="sd">            if None, no weight is applyed</span>
</span><span id="GeoArray.sum-596"><a href="#GeoArray.sum-596"><span class="linenos">596</span></a><span class="sd">            if &#39;latitude&#39; or &#39;depth&#39;, a weight is applyed as the cosine of the latitude or </span>
</span><span id="GeoArray.sum-597"><a href="#GeoArray.sum-597"><span class="linenos">597</span></a><span class="sd">                    the thickness of the layer</span>
</span><span id="GeoArray.sum-598"><a href="#GeoArray.sum-598"><span class="linenos">598</span></a><span class="sd">            if dataarray :</span>
</span><span id="GeoArray.sum-599"><a href="#GeoArray.sum-599"><span class="linenos">599</span></a><span class="sd">                    input data are multiplied by this dataarray before summing</span>
</span><span id="GeoArray.sum-600"><a href="#GeoArray.sum-600"><span class="linenos">600</span></a><span class="sd">        mask : None or dataarray</span>
</span><span id="GeoArray.sum-601"><a href="#GeoArray.sum-601"><span class="linenos">601</span></a><span class="sd">            mask to be applyed before summing</span>
</span><span id="GeoArray.sum-602"><a href="#GeoArray.sum-602"><span class="linenos">602</span></a><span class="sd">        **kwargs : keyword arguments</span>
</span><span id="GeoArray.sum-603"><a href="#GeoArray.sum-603"><span class="linenos">603</span></a><span class="sd">            any keyword arguments passe to the native xarray.sum function</span>
</span><span id="GeoArray.sum-604"><a href="#GeoArray.sum-604"><span class="linenos">604</span></a><span class="sd">            </span>
</span><span id="GeoArray.sum-605"><a href="#GeoArray.sum-605"><span class="linenos">605</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.sum-606"><a href="#GeoArray.sum-606"><span class="linenos">606</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.sum-607"><a href="#GeoArray.sum-607"><span class="linenos">607</span></a><span class="sd">        averaged : dataarray</span>
</span><span id="GeoArray.sum-608"><a href="#GeoArray.sum-608"><span class="linenos">608</span></a><span class="sd">            dataarray summed according to specified options</span>
</span><span id="GeoArray.sum-609"><a href="#GeoArray.sum-609"><span class="linenos">609</span></a><span class="sd">            </span>
</span><span id="GeoArray.sum-610"><a href="#GeoArray.sum-610"><span class="linenos">610</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.sum-611"><a href="#GeoArray.sum-611"><span class="linenos">611</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.sum-612"><a href="#GeoArray.sum-612"><span class="linenos">612</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).heat</span>
</span><span id="GeoArray.sum-613"><a href="#GeoArray.sum-613"><span class="linenos">613</span></a><span class="sd">        &gt;&gt;&gt;avg = data.xgeo.sum([&#39;latitude&#39;,&#39;longitude&#39;],weights=[&#39;latitude&#39;])</span>
</span><span id="GeoArray.sum-614"><a href="#GeoArray.sum-614"><span class="linenos">614</span></a><span class="sd">            </span>
</span><span id="GeoArray.sum-615"><a href="#GeoArray.sum-615"><span class="linenos">615</span></a><span class="sd">        &quot;&quot;&quot;</span>       
</span><span id="GeoArray.sum-616"><a href="#GeoArray.sum-616"><span class="linenos">616</span></a>        <span class="n">argsum</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">))</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">))</span>
</span><span id="GeoArray.sum-617"><a href="#GeoArray.sum-617"><span class="linenos">617</span></a>        <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>        
</span><span id="GeoArray.sum-618"><a href="#GeoArray.sum-618"><span class="linenos">618</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">):</span>
</span><span id="GeoArray.sum-619"><a href="#GeoArray.sum-619"><span class="linenos">619</span></a>            <span class="c1"># Somme simple</span>
</span><span id="GeoArray.sum-620"><a href="#GeoArray.sum-620"><span class="linenos">620</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray.sum-621"><a href="#GeoArray.sum-621"><span class="linenos">621</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
</span><span id="GeoArray.sum-622"><a href="#GeoArray.sum-622"><span class="linenos">622</span></a>            <span class="n">w</span><span class="o">=</span><span class="mi">1</span>
</span><span id="GeoArray.sum-623"><a href="#GeoArray.sum-623"><span class="linenos">623</span></a>            <span class="k">if</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;latitude&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray.sum-624"><a href="#GeoArray.sum-624"><span class="linenos">624</span></a>                <span class="c1"># poids = cos(latitude)*earth oblatness factor</span>
</span><span id="GeoArray.sum-625"><a href="#GeoArray.sum-625"><span class="linenos">625</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">LNPY_f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">latitude</span> <span class="p">)))</span><span class="o">**</span><span class="mi">2</span>
</span><span id="GeoArray.sum-626"><a href="#GeoArray.sum-626"><span class="linenos">626</span></a>            <span class="k">if</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="n">weights</span> <span class="ow">and</span> <span class="s1">&#39;depth&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
</span><span id="GeoArray.sum-627"><a href="#GeoArray.sum-627"><span class="linenos">627</span></a>                <span class="c1"># poids *= paisseur des couches (l&#39;paisseur de la premire couche est la premire profondeur)</span>
</span><span id="GeoArray.sum-628"><a href="#GeoArray.sum-628"><span class="linenos">628</span></a>                <span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="o">*</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="o">.</span><span class="n">depth</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)),</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;depth&#39;</span><span class="p">)</span>
</span><span id="GeoArray.sum-629"><a href="#GeoArray.sum-629"><span class="linenos">629</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="GeoArray.sum-630"><a href="#GeoArray.sum-630"><span class="linenos">630</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="GeoArray.sum-631"><a href="#GeoArray.sum-631"><span class="linenos">631</span></a>            <span class="c1"># matrice de poids dfinie par l&#39;utilisateur</span>
</span><span id="GeoArray.sum-632"><a href="#GeoArray.sum-632"><span class="linenos">632</span></a>            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">argsum</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the sum of dataarray along specified dimension, applying specified weights</p>

<h2 id="parameters">Parameters</h2>

<p>*args : list
    list of the dimensions along which to sum</p>

<p>weights : None or list or dataarray
    if None, no weight is applyed
    if 'latitude' or 'depth', a weight is applyed as the cosine of the latitude or 
            the thickness of the layer
    if dataarray :
            input data are multiplied by this dataarray before summing
mask : None or dataarray
    mask to be applyed before summing
**kwargs : keyword arguments
    any keyword arguments passe to the native xarray.sum function</p>

<h2 id="returns">Returns</h2>

<p>averaged : dataarray
    dataarray summed according to specified options</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc').heat
      avg = data.xgeo.sum(['latitude','longitude'],weights=['latitude'])</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoArray.isosurface" class="classattr">
                                        <input id="GeoArray.isosurface-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isosurface</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span>, </span><span class="param"><span class="n">dim</span>, </span><span class="param"><span class="n">coord</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">upper</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.isosurface-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.isosurface"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.isosurface-635"><a href="#GeoArray.isosurface-635"><span class="linenos">635</span></a>    <span class="k">def</span> <span class="nf">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">dim</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>   
</span><span id="GeoArray.isosurface-636"><a href="#GeoArray.isosurface-636"><span class="linenos">636</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.isosurface-637"><a href="#GeoArray.isosurface-637"><span class="linenos">637</span></a><span class="sd">        Compute the isosurface along the specified coordinate at the value defined  by the target.</span>
</span><span id="GeoArray.isosurface-638"><a href="#GeoArray.isosurface-638"><span class="linenos">638</span></a><span class="sd">        Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,</span>
</span><span id="GeoArray.isosurface-639"><a href="#GeoArray.isosurface-639"><span class="linenos">639</span></a><span class="sd">        starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</span>
</span><span id="GeoArray.isosurface-640"><a href="#GeoArray.isosurface-640"><span class="linenos">640</span></a><span class="sd">        </span>
</span><span id="GeoArray.isosurface-641"><a href="#GeoArray.isosurface-641"><span class="linenos">641</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.isosurface-642"><a href="#GeoArray.isosurface-642"><span class="linenos">642</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.isosurface-643"><a href="#GeoArray.isosurface-643"><span class="linenos">643</span></a><span class="sd">        target : float</span>
</span><span id="GeoArray.isosurface-644"><a href="#GeoArray.isosurface-644"><span class="linenos">644</span></a><span class="sd">            criterion value to be satisfied at the iso surface</span>
</span><span id="GeoArray.isosurface-645"><a href="#GeoArray.isosurface-645"><span class="linenos">645</span></a><span class="sd">        dim : string</span>
</span><span id="GeoArray.isosurface-646"><a href="#GeoArray.isosurface-646"><span class="linenos">646</span></a><span class="sd">            dimension along which to compute the isosurface</span>
</span><span id="GeoArray.isosurface-647"><a href="#GeoArray.isosurface-647"><span class="linenos">647</span></a><span class="sd">        coord : str (optional)</span>
</span><span id="GeoArray.isosurface-648"><a href="#GeoArray.isosurface-648"><span class="linenos">648</span></a><span class="sd">            The field coordinate to interpolate. If absent, coordinate is supposed to be &quot;dim&quot;</span>
</span><span id="GeoArray.isosurface-649"><a href="#GeoArray.isosurface-649"><span class="linenos">649</span></a><span class="sd">        upper : boolean (default=False)</span>
</span><span id="GeoArray.isosurface-650"><a href="#GeoArray.isosurface-650"><span class="linenos">650</span></a><span class="sd">            order to perform the research of the criterion value. If False, from the end, if True, form the beggining</span>
</span><span id="GeoArray.isosurface-651"><a href="#GeoArray.isosurface-651"><span class="linenos">651</span></a><span class="sd">            </span>
</span><span id="GeoArray.isosurface-652"><a href="#GeoArray.isosurface-652"><span class="linenos">652</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.isosurface-653"><a href="#GeoArray.isosurface-653"><span class="linenos">653</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.isosurface-654"><a href="#GeoArray.isosurface-654"><span class="linenos">654</span></a><span class="sd">        isosurface : dataarray</span>
</span><span id="GeoArray.isosurface-655"><a href="#GeoArray.isosurface-655"><span class="linenos">655</span></a><span class="sd">            Dataarray containing the isosurface along the dimension dim on which data=target.</span>
</span><span id="GeoArray.isosurface-656"><a href="#GeoArray.isosurface-656"><span class="linenos">656</span></a><span class="sd">                </span>
</span><span id="GeoArray.isosurface-657"><a href="#GeoArray.isosurface-657"><span class="linenos">657</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.isosurface-658"><a href="#GeoArray.isosurface-658"><span class="linenos">658</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.isosurface-659"><a href="#GeoArray.isosurface-659"><span class="linenos">659</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray.isosurface-660"><a href="#GeoArray.isosurface-660"><span class="linenos">660</span></a><span class="sd">        &gt;&gt;&gt;data.isosurface(3,&#39;depth&#39;)</span>
</span><span id="GeoArray.isosurface-661"><a href="#GeoArray.isosurface-661"><span class="linenos">661</span></a><span class="sd">        &lt;xarray.DataArray (latitude: 90, longitude: 180)&gt;</span>
</span><span id="GeoArray.isosurface-662"><a href="#GeoArray.isosurface-662"><span class="linenos">662</span></a><span class="sd">        dask.array&lt;_nanmax_skip-aggregate, shape=(90, 180), dtype=float64, chunksize=(90, 180), chunktype=numpy.ndarray&gt;</span>
</span><span id="GeoArray.isosurface-663"><a href="#GeoArray.isosurface-663"><span class="linenos">663</span></a><span class="sd">        Coordinates:</span>
</span><span id="GeoArray.isosurface-664"><a href="#GeoArray.isosurface-664"><span class="linenos">664</span></a><span class="sd">          * latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</span>
</span><span id="GeoArray.isosurface-665"><a href="#GeoArray.isosurface-665"><span class="linenos">665</span></a><span class="sd">          * longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0</span>
</span><span id="GeoArray.isosurface-666"><a href="#GeoArray.isosurface-666"><span class="linenos">666</span></a><span class="sd">            time       datetime64[ns] 2005-01-15</span>
</span><span id="GeoArray.isosurface-667"><a href="#GeoArray.isosurface-667"><span class="linenos">667</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray.isosurface-668"><a href="#GeoArray.isosurface-668"><span class="linenos">668</span></a>        <span class="k">return</span> <span class="n">isosurface</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">dim</span><span class="p">,</span><span class="n">coord</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the isosurface along the specified coordinate at the value defined  by the target.
Data is supposed to be monotonic along the chosen dimension. If not, the first fitting value encountered is retained,
starting from the end (bottom) if upper=False, or from the beggining (top) if upper=True</p>

<h2 id="parameters">Parameters</h2>

<p>target : float
    criterion value to be satisfied at the iso surface
dim : string
    dimension along which to compute the isosurface
coord : str (optional)
    The field coordinate to interpolate. If absent, coordinate is supposed to be "dim"
upper : boolean (default=False)
    order to perform the research of the criterion value. If False, from the end, if True, form the beggining</p>

<h2 id="returns">Returns</h2>

<p>isosurface : dataarray
    Dataarray containing the isosurface along the dimension dim on which data=target.</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc').temp
      data.isosurface(3,'depth')
      <xarray.DataArray (latitude: 90, longitude: 180)&gt;
      dask.array&lt;_nanmax_skip-aggregate, shape=(90, 180), dtype=float64, chunksize=(90, 180), chunktype=numpy.ndarray>
      Coordinates:</p>
      
      <ul>
      <li>latitude   (latitude) float32 -44.5 -43.5 -42.5 -41.5 ... 42.5 43.5 44.5</li>
      <li>longitude  (longitude) float32 1.0 2.0 3.0 4.0 ... 177.0 178.0 179.0 180.0
      time       datetime64[ns] 2005-01-15</li>
      </ul>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoArray.regridder" class="classattr">
                                        <input id="GeoArray.regridder-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">regridder</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">gr_out</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.regridder-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.regridder"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.regridder-670"><a href="#GeoArray.regridder-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="nf">regridder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.regridder-671"><a href="#GeoArray.regridder-671"><span class="linenos">671</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.regridder-672"><a href="#GeoArray.regridder-672"><span class="linenos">672</span></a><span class="sd">        Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataarray </span>
</span><span id="GeoArray.regridder-673"><a href="#GeoArray.regridder-673"><span class="linenos">673</span></a><span class="sd">        coordinates to gr_out coordinates</span>
</span><span id="GeoArray.regridder-674"><a href="#GeoArray.regridder-674"><span class="linenos">674</span></a>
</span><span id="GeoArray.regridder-675"><a href="#GeoArray.regridder-675"><span class="linenos">675</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.regridder-676"><a href="#GeoArray.regridder-676"><span class="linenos">676</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.regridder-677"><a href="#GeoArray.regridder-677"><span class="linenos">677</span></a><span class="sd">        gr_out : dataset</span>
</span><span id="GeoArray.regridder-678"><a href="#GeoArray.regridder-678"><span class="linenos">678</span></a><span class="sd">            dataset containing the coordinates to regrid on</span>
</span><span id="GeoArray.regridder-679"><a href="#GeoArray.regridder-679"><span class="linenos">679</span></a><span class="sd">        *args : </span>
</span><span id="GeoArray.regridder-680"><a href="#GeoArray.regridder-680"><span class="linenos">680</span></a><span class="sd">            any argument passed to xesmf.Regridder method</span>
</span><span id="GeoArray.regridder-681"><a href="#GeoArray.regridder-681"><span class="linenos">681</span></a><span class="sd">        mask_in : None or dataarray</span>
</span><span id="GeoArray.regridder-682"><a href="#GeoArray.regridder-682"><span class="linenos">682</span></a><span class="sd">            mask to be applied on the data to regrid</span>
</span><span id="GeoArray.regridder-683"><a href="#GeoArray.regridder-683"><span class="linenos">683</span></a><span class="sd">        method : str</span>
</span><span id="GeoArray.regridder-684"><a href="#GeoArray.regridder-684"><span class="linenos">684</span></a><span class="sd">            resampling method (see xesmf documentation)            </span>
</span><span id="GeoArray.regridder-685"><a href="#GeoArray.regridder-685"><span class="linenos">685</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoArray.regridder-686"><a href="#GeoArray.regridder-686"><span class="linenos">686</span></a><span class="sd">            any keyword argument passed to xesmf.Regridder method</span>
</span><span id="GeoArray.regridder-687"><a href="#GeoArray.regridder-687"><span class="linenos">687</span></a>
</span><span id="GeoArray.regridder-688"><a href="#GeoArray.regridder-688"><span class="linenos">688</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.regridder-689"><a href="#GeoArray.regridder-689"><span class="linenos">689</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.regridder-690"><a href="#GeoArray.regridder-690"><span class="linenos">690</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoArray.regridder-691"><a href="#GeoArray.regridder-691"><span class="linenos">691</span></a><span class="sd">            regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoArray.regridder-692"><a href="#GeoArray.regridder-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.regridder-693"><a href="#GeoArray.regridder-693"><span class="linenos">693</span></a>
</span><span id="GeoArray.regridder-694"><a href="#GeoArray.regridder-694"><span class="linenos">694</span></a>        <span class="n">ds</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">({</span><span class="s1">&#39;data&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">})</span>
</span><span id="GeoArray.regridder-695"><a href="#GeoArray.regridder-695"><span class="linenos">695</span></a>        <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">xgeo</span><span class="o">.</span><span class="n">regridder</span><span class="p">(</span><span class="n">gr_out</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">mask_in</span><span class="o">=</span><span class="n">mask_in</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Implement a xesmf regridder instance to be used with regrid method to perform regridding from dataarray 
coordinates to gr_out coordinates</p>

<h2 id="parameters">Parameters</h2>

<p>gr_out : dataset
    dataset containing the coordinates to regrid on
*args : 
    any argument passed to xesmf.Regridder method
mask_in : None or dataarray
    mask to be applied on the data to regrid
method : str
    resampling method (see xesmf documentation) <br />
*kwargs : 
    any keyword argument passed to xesmf.Regridder method</p>

<h2 id="returns">Returns</h2>

<p>regridder : xesmf.Regridder instance
    regridder to be used with regrid method to perform regridding from dataset coordinates to gr_out coordinates</p>
</div>


                            </div>
                            <div id="GeoArray.regrid" class="classattr">
                                        <input id="GeoArray.regrid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">regrid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">regridder</span>, </span><span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.regrid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.regrid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.regrid-697"><a href="#GeoArray.regrid-697"><span class="linenos">697</span></a>    <span class="k">def</span> <span class="nf">regrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regridder</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.regrid-698"><a href="#GeoArray.regrid-698"><span class="linenos">698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.regrid-699"><a href="#GeoArray.regrid-699"><span class="linenos">699</span></a><span class="sd">        Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</span>
</span><span id="GeoArray.regrid-700"><a href="#GeoArray.regrid-700"><span class="linenos">700</span></a>
</span><span id="GeoArray.regrid-701"><a href="#GeoArray.regrid-701"><span class="linenos">701</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.regrid-702"><a href="#GeoArray.regrid-702"><span class="linenos">702</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.regrid-703"><a href="#GeoArray.regrid-703"><span class="linenos">703</span></a><span class="sd">        regridder : xesmf.Regridder instance</span>
</span><span id="GeoArray.regrid-704"><a href="#GeoArray.regrid-704"><span class="linenos">704</span></a><span class="sd">            regridder set with the xgeo.regridder method</span>
</span><span id="GeoArray.regrid-705"><a href="#GeoArray.regrid-705"><span class="linenos">705</span></a>
</span><span id="GeoArray.regrid-706"><a href="#GeoArray.regrid-706"><span class="linenos">706</span></a><span class="sd">        *args : </span>
</span><span id="GeoArray.regrid-707"><a href="#GeoArray.regrid-707"><span class="linenos">707</span></a><span class="sd">            any argument passed to xesmf regridder method</span>
</span><span id="GeoArray.regrid-708"><a href="#GeoArray.regrid-708"><span class="linenos">708</span></a><span class="sd">        *kwargs : </span>
</span><span id="GeoArray.regrid-709"><a href="#GeoArray.regrid-709"><span class="linenos">709</span></a><span class="sd">            any keyword argument passed to xesmf regridder method</span>
</span><span id="GeoArray.regrid-710"><a href="#GeoArray.regrid-710"><span class="linenos">710</span></a>
</span><span id="GeoArray.regrid-711"><a href="#GeoArray.regrid-711"><span class="linenos">711</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.regrid-712"><a href="#GeoArray.regrid-712"><span class="linenos">712</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.regrid-713"><a href="#GeoArray.regrid-713"><span class="linenos">713</span></a><span class="sd">        regrid : dataset</span>
</span><span id="GeoArray.regrid-714"><a href="#GeoArray.regrid-714"><span class="linenos">714</span></a><span class="sd">            dataset regridded to gr_out coordinates</span>
</span><span id="GeoArray.regrid-715"><a href="#GeoArray.regrid-715"><span class="linenos">715</span></a>
</span><span id="GeoArray.regrid-716"><a href="#GeoArray.regrid-716"><span class="linenos">716</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.regrid-717"><a href="#GeoArray.regrid-717"><span class="linenos">717</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.regrid-718"><a href="#GeoArray.regrid-718"><span class="linenos">718</span></a><span class="sd">        &gt;&gt;&gt;ds_out = xr.Dataset({&quot;latitude&quot;:([&quot;latitude&quot;],np.arange(-89.5,90,1.)),</span>
</span><span id="GeoArray.regrid-719"><a href="#GeoArray.regrid-719"><span class="linenos">719</span></a><span class="sd">        &gt;&gt;&gt;                     &quot;longitude&quot;:([&quot;longitude&quot;],np.arange(-179.5,180,1.))})</span>
</span><span id="GeoArray.regrid-720"><a href="#GeoArray.regrid-720"><span class="linenos">720</span></a><span class="sd">        &gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
</span><span id="GeoArray.regrid-721"><a href="#GeoArray.regrid-721"><span class="linenos">721</span></a><span class="sd">        &gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</span><span id="GeoArray.regrid-722"><a href="#GeoArray.regrid-722"><span class="linenos">722</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray.regrid-723"><a href="#GeoArray.regrid-723"><span class="linenos">723</span></a>        <span class="k">return</span> <span class="n">regridder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Implement the xesmf regrid method to perform regridding from dataset coordinates to gr_out coordinates</p>

<h2 id="parameters">Parameters</h2>

<p>regridder : xesmf.Regridder instance
    regridder set with the xgeo.regridder method</p>

<p>*args : 
    any argument passed to xesmf regridder method
*kwargs : 
    any keyword argument passed to xesmf regridder method</p>

<h2 id="returns">Returns</h2>

<p>regrid : dataset
    dataset regridded to gr_out coordinates</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>ds_out = xr.Dataset({"latitude":(["latitude"],np.arange(-89.5,90,1.)),</p>
    </blockquote>
  </blockquote>
</blockquote>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span>                    <span class="s2">&quot;longitude&quot;</span><span class="p">:([</span><span class="s2">&quot;longitude&quot;</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">179.5</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mf">1.</span><span class="p">))})</span>
<span class="go">&gt;&gt;&gt;regridder = data.xgeo.regridder(ds_out,&quot;conservative_normed&quot;,periodic=True)</span>
<span class="go">&gt;&gt;&gt;out = data.xgeo.regrid(regridder)</span>
</code></pre>
</div>
</div>


                            </div>
                            <div id="GeoArray.filter" class="classattr">
                                        <input id="GeoArray.filter-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span>, </span><span class="param"><span class="n">q</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.filter-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.filter"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.filter-725"><a href="#GeoArray.filter-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;lanczos&#39;</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.filter-726"><a href="#GeoArray.filter-726"><span class="linenos">726</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.filter-727"><a href="#GeoArray.filter-727"><span class="linenos">727</span></a><span class="sd">        Apply a specified filter on all the time-dependent datarray</span>
</span><span id="GeoArray.filter-728"><a href="#GeoArray.filter-728"><span class="linenos">728</span></a><span class="sd">        Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data</span>
</span><span id="GeoArray.filter-729"><a href="#GeoArray.filter-729"><span class="linenos">729</span></a><span class="sd">        Available filters are in the .utils python file</span>
</span><span id="GeoArray.filter-730"><a href="#GeoArray.filter-730"><span class="linenos">730</span></a><span class="sd">        </span>
</span><span id="GeoArray.filter-731"><a href="#GeoArray.filter-731"><span class="linenos">731</span></a><span class="sd">        Parameters</span>
</span><span id="GeoArray.filter-732"><a href="#GeoArray.filter-732"><span class="linenos">732</span></a><span class="sd">        ----------</span>
</span><span id="GeoArray.filter-733"><a href="#GeoArray.filter-733"><span class="linenos">733</span></a><span class="sd">        filter_name : function or string</span>
</span><span id="GeoArray.filter-734"><a href="#GeoArray.filter-734"><span class="linenos">734</span></a><span class="sd">            if string, filter function name, from the .filters file</span>
</span><span id="GeoArray.filter-735"><a href="#GeoArray.filter-735"><span class="linenos">735</span></a><span class="sd">            if function, external function defined by user, returning a kernel</span>
</span><span id="GeoArray.filter-736"><a href="#GeoArray.filter-736"><span class="linenos">736</span></a><span class="sd">        q : int</span>
</span><span id="GeoArray.filter-737"><a href="#GeoArray.filter-737"><span class="linenos">737</span></a><span class="sd">            order of the polyfit to handle boundary effects</span>
</span><span id="GeoArray.filter-738"><a href="#GeoArray.filter-738"><span class="linenos">738</span></a><span class="sd">        **kwargs :</span>
</span><span id="GeoArray.filter-739"><a href="#GeoArray.filter-739"><span class="linenos">739</span></a><span class="sd">            keyword arguments for the chosen filter</span>
</span><span id="GeoArray.filter-740"><a href="#GeoArray.filter-740"><span class="linenos">740</span></a><span class="sd">            </span>
</span><span id="GeoArray.filter-741"><a href="#GeoArray.filter-741"><span class="linenos">741</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.filter-742"><a href="#GeoArray.filter-742"><span class="linenos">742</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.filter-743"><a href="#GeoArray.filter-743"><span class="linenos">743</span></a><span class="sd">        filtered : filtered dataset</span>
</span><span id="GeoArray.filter-744"><a href="#GeoArray.filter-744"><span class="linenos">744</span></a><span class="sd">        </span>
</span><span id="GeoArray.filter-745"><a href="#GeoArray.filter-745"><span class="linenos">745</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.filter-746"><a href="#GeoArray.filter-746"><span class="linenos">746</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.filter-747"><a href="#GeoArray.filter-747"><span class="linenos">747</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/isas.nc&#39;).temp</span>
</span><span id="GeoArray.filter-748"><a href="#GeoArray.filter-748"><span class="linenos">748</span></a><span class="sd">        &gt;&gt;&gt;data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</span>
</span><span id="GeoArray.filter-749"><a href="#GeoArray.filter-749"><span class="linenos">749</span></a><span class="sd">        </span>
</span><span id="GeoArray.filter-750"><a href="#GeoArray.filter-750"><span class="linenos">750</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray.filter-751"><a href="#GeoArray.filter-751"><span class="linenos">751</span></a>        <span class="k">return</span> <span class="nb">filter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">filter_name</span><span class="o">=</span><span class="n">filter_name</span><span class="p">,</span><span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply a specified filter on all the time-dependent datarray
Boundaries are handled by operating a mirror operation on the residual data after removing a q-order polyfit from the data
Available filters are in the <a href="utils.html">lenapy.utils</a> python file</p>

<h2 id="parameters">Parameters</h2>

<p>filter_name : function or string
    if string, filter function name, from the <a href="filters.html">lenapy.filters</a> file
    if function, external function defined by user, returning a kernel
q : int
    order of the polyfit to handle boundary effects
**kwargs :
    keyword arguments for the chosen filter</p>

<h2 id="returns">Returns</h2>

<p>filtered : filtered dataset</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/isas.nc').temp
      data.xgeo.filter(lanczos,q=3,coupure=12,order=2)</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                            <div id="GeoArray.interp_time" class="classattr">
                                        <input id="GeoArray.interp_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">interp_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.interp_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.interp_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.interp_time-753"><a href="#GeoArray.interp_time-753"><span class="linenos">753</span></a>    <span class="k">def</span> <span class="nf">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.interp_time-754"><a href="#GeoArray.interp_time-754"><span class="linenos">754</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.interp_time-755"><a href="#GeoArray.interp_time-755"><span class="linenos">755</span></a><span class="sd">        Interpolate dataarray at the same dates than other</span>
</span><span id="GeoArray.interp_time-756"><a href="#GeoArray.interp_time-756"><span class="linenos">756</span></a><span class="sd">        </span>
</span><span id="GeoArray.interp_time-757"><a href="#GeoArray.interp_time-757"><span class="linenos">757</span></a><span class="sd">        Parameter</span>
</span><span id="GeoArray.interp_time-758"><a href="#GeoArray.interp_time-758"><span class="linenos">758</span></a><span class="sd">        ---------</span>
</span><span id="GeoArray.interp_time-759"><a href="#GeoArray.interp_time-759"><span class="linenos">759</span></a><span class="sd">        other : dataarray</span>
</span><span id="GeoArray.interp_time-760"><a href="#GeoArray.interp_time-760"><span class="linenos">760</span></a><span class="sd">            must have a time dimension</span>
</span><span id="GeoArray.interp_time-761"><a href="#GeoArray.interp_time-761"><span class="linenos">761</span></a><span class="sd">            </span>
</span><span id="GeoArray.interp_time-762"><a href="#GeoArray.interp_time-762"><span class="linenos">762</span></a><span class="sd">        Return</span>
</span><span id="GeoArray.interp_time-763"><a href="#GeoArray.interp_time-763"><span class="linenos">763</span></a><span class="sd">        ------</span>
</span><span id="GeoArray.interp_time-764"><a href="#GeoArray.interp_time-764"><span class="linenos">764</span></a><span class="sd">        interpolated : dataarray</span>
</span><span id="GeoArray.interp_time-765"><a href="#GeoArray.interp_time-765"><span class="linenos">765</span></a><span class="sd">            new dataarray interpolated</span>
</span><span id="GeoArray.interp_time-766"><a href="#GeoArray.interp_time-766"><span class="linenos">766</span></a><span class="sd">        &quot;&quot;&quot;</span>        
</span><span id="GeoArray.interp_time-767"><a href="#GeoArray.interp_time-767"><span class="linenos">767</span></a>        <span class="k">return</span> <span class="n">interp_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">other</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Interpolate dataarray at the same dates than other</p>

<h2 id="parameter">Parameter</h2>

<p>other : dataarray
    must have a time dimension</p>

<h2 id="return">Return</h2>

<p>interpolated : dataarray
    new dataarray interpolated</p>
</div>


                            </div>
                            <div id="GeoArray.plot_timeseries_uncertainty" class="classattr">
                                        <input id="GeoArray.plot_timeseries_uncertainty-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_timeseries_uncertainty</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.plot_timeseries_uncertainty-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.plot_timeseries_uncertainty"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.plot_timeseries_uncertainty-769"><a href="#GeoArray.plot_timeseries_uncertainty-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="nf">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="GeoArray.plot_timeseries_uncertainty-770"><a href="#GeoArray.plot_timeseries_uncertainty-770"><span class="linenos">770</span></a>        <span class="n">plot_timeseries_uncertainty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="GeoArray.to_datetime" class="classattr">
                                        <input id="GeoArray.to_datetime-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_datetime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">input_type</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.to_datetime-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.to_datetime"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.to_datetime-772"><a href="#GeoArray.to_datetime-772"><span class="linenos">772</span></a>    <span class="k">def</span> <span class="nf">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">input_type</span><span class="p">):</span>
</span><span id="GeoArray.to_datetime-773"><a href="#GeoArray.to_datetime-773"><span class="linenos">773</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.to_datetime-774"><a href="#GeoArray.to_datetime-774"><span class="linenos">774</span></a><span class="sd">        Convert dataarray time format to standard pandas time format</span>
</span><span id="GeoArray.to_datetime-775"><a href="#GeoArray.to_datetime-775"><span class="linenos">775</span></a><span class="sd">        </span>
</span><span id="GeoArray.to_datetime-776"><a href="#GeoArray.to_datetime-776"><span class="linenos">776</span></a><span class="sd">        Parameter</span>
</span><span id="GeoArray.to_datetime-777"><a href="#GeoArray.to_datetime-777"><span class="linenos">777</span></a><span class="sd">        ---------</span>
</span><span id="GeoArray.to_datetime-778"><a href="#GeoArray.to_datetime-778"><span class="linenos">778</span></a><span class="sd">        input_type : string</span>
</span><span id="GeoArray.to_datetime-779"><a href="#GeoArray.to_datetime-779"><span class="linenos">779</span></a><span class="sd">            Can be &#39;frac_year&#39; or &#39;360_day&#39;</span>
</span><span id="GeoArray.to_datetime-780"><a href="#GeoArray.to_datetime-780"><span class="linenos">780</span></a><span class="sd">            </span>
</span><span id="GeoArray.to_datetime-781"><a href="#GeoArray.to_datetime-781"><span class="linenos">781</span></a><span class="sd">        Return</span>
</span><span id="GeoArray.to_datetime-782"><a href="#GeoArray.to_datetime-782"><span class="linenos">782</span></a><span class="sd">        ------</span>
</span><span id="GeoArray.to_datetime-783"><a href="#GeoArray.to_datetime-783"><span class="linenos">783</span></a><span class="sd">        converted : dataarray</span>
</span><span id="GeoArray.to_datetime-784"><a href="#GeoArray.to_datetime-784"><span class="linenos">784</span></a><span class="sd">            new dataarray with the time dimension in a standard pandas format</span>
</span><span id="GeoArray.to_datetime-785"><a href="#GeoArray.to_datetime-785"><span class="linenos">785</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.to_datetime-786"><a href="#GeoArray.to_datetime-786"><span class="linenos">786</span></a>        <span class="k">return</span> <span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">input_type</span><span class="p">)</span>        
</span></pre></div>


            <div class="docstring"><p>Convert dataarray time format to standard pandas time format</p>

<h2 id="parameter">Parameter</h2>

<p>input_type : string
    Can be 'frac_year' or '360_day'</p>

<h2 id="return">Return</h2>

<p>converted : dataarray
    new dataarray with the time dimension in a standard pandas format</p>
</div>


                            </div>
                            <div id="GeoArray.diff_3pts" class="classattr">
                                        <input id="GeoArray.diff_3pts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diff_3pts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dim</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.diff_3pts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.diff_3pts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.diff_3pts-788"><a href="#GeoArray.diff_3pts-788"><span class="linenos">788</span></a>    <span class="k">def</span> <span class="nf">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dim</span><span class="p">):</span>
</span><span id="GeoArray.diff_3pts-789"><a href="#GeoArray.diff_3pts-789"><span class="linenos">789</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.diff_3pts-790"><a href="#GeoArray.diff_3pts-790"><span class="linenos">790</span></a><span class="sd">        Derivative formula along the selected dimension, returning on each point the linear regression on the three points</span>
</span><span id="GeoArray.diff_3pts-791"><a href="#GeoArray.diff_3pts-791"><span class="linenos">791</span></a><span class="sd">        defined by the selected point and its two neighbours</span>
</span><span id="GeoArray.diff_3pts-792"><a href="#GeoArray.diff_3pts-792"><span class="linenos">792</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.diff_3pts-793"><a href="#GeoArray.diff_3pts-793"><span class="linenos">793</span></a>        <span class="k">return</span> <span class="n">diff_3pts</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dim</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Derivative formula along the selected dimension, returning on each point the linear regression on the three points
defined by the selected point and its two neighbours</p>
</div>


                            </div>
                            <div id="GeoArray.to_difgri" class="classattr">
                                        <input id="GeoArray.to_difgri-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_difgri</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dir_out</span>, </span><span class="param"><span class="n">prefix</span>, </span><span class="param"><span class="n">suffix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.to_difgri-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.to_difgri"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.to_difgri-795"><a href="#GeoArray.to_difgri-795"><span class="linenos">795</span></a>    <span class="k">def</span> <span class="nf">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">):</span>
</span><span id="GeoArray.to_difgri-796"><a href="#GeoArray.to_difgri-796"><span class="linenos">796</span></a>        <span class="n">to_difgri</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span><span class="n">dir_out</span><span class="p">,</span><span class="n">prefix</span><span class="p">,</span><span class="n">suffix</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="GeoArray.trend" class="classattr">
                                        <input id="GeoArray.trend-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trend</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.trend-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.trend"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.trend-798"><a href="#GeoArray.trend-798"><span class="linenos">798</span></a>    <span class="k">def</span> <span class="nf">trend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray.trend-799"><a href="#GeoArray.trend-799"><span class="linenos">799</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.trend-800"><a href="#GeoArray.trend-800"><span class="linenos">800</span></a><span class="sd">        Perform a linear regression on the data, and returns the slope coefficient</span>
</span><span id="GeoArray.trend-801"><a href="#GeoArray.trend-801"><span class="linenos">801</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.trend-802"><a href="#GeoArray.trend-802"><span class="linenos">802</span></a>        <span class="k">return</span> <span class="n">trend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Perform a linear regression on the data, and returns the slope coefficient</p>
</div>


                            </div>
                            <div id="GeoArray.fill_time" class="classattr">
                                        <input id="GeoArray.fill_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.fill_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.fill_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.fill_time-804"><a href="#GeoArray.fill_time-804"><span class="linenos">804</span></a>    <span class="k">def</span> <span class="nf">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray.fill_time-805"><a href="#GeoArray.fill_time-805"><span class="linenos">805</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.fill_time-806"><a href="#GeoArray.fill_time-806"><span class="linenos">806</span></a><span class="sd">        Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN</span>
</span><span id="GeoArray.fill_time-807"><a href="#GeoArray.fill_time-807"><span class="linenos">807</span></a><span class="sd">        but real absent points in the timeseries. A linear interpolation is performed at the missing points.</span>
</span><span id="GeoArray.fill_time-808"><a href="#GeoArray.fill_time-808"><span class="linenos">808</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.fill_time-809"><a href="#GeoArray.fill_time-809"><span class="linenos">809</span></a>        <span class="k">return</span> <span class="n">fill_time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fill missing values in a timeseries in adding some new points, by respecting the time sampling. Missing values are not NaN
but real absent points in the timeseries. A linear interpolation is performed at the missing points.</p>
</div>


                            </div>
                            <div id="GeoArray.surface_cell" class="classattr">
                                        <input id="GeoArray.surface_cell-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">surface_cell</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="GeoArray.surface_cell-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GeoArray.surface_cell"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GeoArray.surface_cell-812"><a href="#GeoArray.surface_cell-812"><span class="linenos">812</span></a>    <span class="k">def</span> <span class="nf">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="GeoArray.surface_cell-813"><a href="#GeoArray.surface_cell-813"><span class="linenos">813</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GeoArray.surface_cell-814"><a href="#GeoArray.surface_cell-814"><span class="linenos">814</span></a><span class="sd">        Returns the earth surface of each cell defined by a longitude/latitude in a array</span>
</span><span id="GeoArray.surface_cell-815"><a href="#GeoArray.surface_cell-815"><span class="linenos">815</span></a><span class="sd">        Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.</span>
</span><span id="GeoArray.surface_cell-816"><a href="#GeoArray.surface_cell-816"><span class="linenos">816</span></a><span class="sd">        Border cells are supposed to have the same size on each side of the given coordinate.</span>
</span><span id="GeoArray.surface_cell-817"><a href="#GeoArray.surface_cell-817"><span class="linenos">817</span></a><span class="sd">        Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</span>
</span><span id="GeoArray.surface_cell-818"><a href="#GeoArray.surface_cell-818"><span class="linenos">818</span></a>
</span><span id="GeoArray.surface_cell-819"><a href="#GeoArray.surface_cell-819"><span class="linenos">819</span></a><span class="sd">        Returns</span>
</span><span id="GeoArray.surface_cell-820"><a href="#GeoArray.surface_cell-820"><span class="linenos">820</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.surface_cell-821"><a href="#GeoArray.surface_cell-821"><span class="linenos">821</span></a><span class="sd">        surface : dataarray</span>
</span><span id="GeoArray.surface_cell-822"><a href="#GeoArray.surface_cell-822"><span class="linenos">822</span></a><span class="sd">            dataarray with cells surface</span>
</span><span id="GeoArray.surface_cell-823"><a href="#GeoArray.surface_cell-823"><span class="linenos">823</span></a>
</span><span id="GeoArray.surface_cell-824"><a href="#GeoArray.surface_cell-824"><span class="linenos">824</span></a><span class="sd">        Example</span>
</span><span id="GeoArray.surface_cell-825"><a href="#GeoArray.surface_cell-825"><span class="linenos">825</span></a><span class="sd">        -------</span>
</span><span id="GeoArray.surface_cell-826"><a href="#GeoArray.surface_cell-826"><span class="linenos">826</span></a><span class="sd">        &gt;&gt;&gt;data = xgeo.open_geodata(&#39;/home/user/lenapy/data/gohc_2020.nc&#39;)</span>
</span><span id="GeoArray.surface_cell-827"><a href="#GeoArray.surface_cell-827"><span class="linenos">827</span></a><span class="sd">        &gt;&gt;&gt;surface = data.xgeo.surface_cell()</span>
</span><span id="GeoArray.surface_cell-828"><a href="#GeoArray.surface_cell-828"><span class="linenos">828</span></a>
</span><span id="GeoArray.surface_cell-829"><a href="#GeoArray.surface_cell-829"><span class="linenos">829</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GeoArray.surface_cell-830"><a href="#GeoArray.surface_cell-830"><span class="linenos">830</span></a>        <span class="k">return</span> <span class="n">surface_cell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Returns the earth surface of each cell defined by a longitude/latitude in a array
Cells limits are half distance between each given coordinate. That means that given coordinates are not necessary the center of each cell.
Border cells are supposed to have the same size on each side of the given coordinate.
Ex : coords=[1,2,4,7,9] ==&gt; cells size are [1,1.5,2.5,2.5,2]</p>

<h2 id="returns">Returns</h2>

<p>surface : dataarray
    dataarray with cells surface</p>

<h2 id="example">Example</h2>

<blockquote>
  <blockquote>
    <blockquote>
      <p>data = xgeo.open_geodata('/home/user/lenapy/data/gohc_2020.nc')
      surface = data.xgeo.surface_cell()</p>
    </blockquote>
  </blockquote>
</blockquote>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>